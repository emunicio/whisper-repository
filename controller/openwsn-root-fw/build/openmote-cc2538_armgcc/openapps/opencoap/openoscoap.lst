   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.syntax unified
  15              		.file	"openoscoap.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.rodata
  20              		.align	2
  23              	rreg_uriquery:
  24 0000 683D7563 		.ascii	"h=ucb\000"
  24      6200
  25 0006 0000     		.align	2
  28              	infoBoardname:
  29 0008 43433235 		.ascii	"CC2538\000"
  29      333800
  30 000f 00       		.align	2
  33              	infouCName:
  34 0010 43433235 		.ascii	"CC2538\000"
  34      333800
  35 0017 00       		.align	2
  38              	infoRadioName:
  39 0018 43433235 		.ascii	"CC2538 SoC\000"
  39      33382053 
  39      6F4300
  40 0023 00       		.align	2
  43              	infoStackName:
  44 0024 4F70656E 		.ascii	"OpenWSN \000"
  44      57534E20 
  44      00
  45 002d 000000   		.align	2
  48              	ipAddr_ipsoRD:
  49 0030 26       		.byte	38
  50 0031 07       		.byte	7
  51 0032 F7       		.byte	-9
  52 0033 40       		.byte	64
  53 0034 00       		.byte	0
  54 0035 00       		.byte	0
  55 0036 00       		.byte	0
  56 0037 3F       		.byte	63
  57 0038 00       		.byte	0
  58 0039 00       		.byte	0
  59 003a 00       		.byte	0
  60 003b 00       		.byte	0
  61 003c 00       		.byte	0
  62 003d 00       		.byte	0
  63 003e 0E       		.byte	14
  64 003f 29       		.byte	41
  65              		.align	2
  68              	ipAddr_motesEecs:
  69 0040 20       		.byte	32
  70 0041 01       		.byte	1
  71 0042 04       		.byte	4
  72 0043 70       		.byte	112
  73 0044 00       		.byte	0
  74 0045 66       		.byte	102
  75 0046 00       		.byte	0
  76 0047 19       		.byte	25
  77 0048 00       		.byte	0
  78 0049 00       		.byte	0
  79 004a 00       		.byte	0
  80 004b 00       		.byte	0
  81 004c 00       		.byte	0
  82 004d 00       		.byte	0
  83 004e 00       		.byte	0
  84 004f 02       		.byte	2
  85              		.align	2
  88              	ipAddr_local:
  89 0050 26       		.byte	38
  90 0051 07       		.byte	7
  91 0052 F1       		.byte	-15
  92 0053 40       		.byte	64
  93 0054 04       		.byte	4
  94 0055 00       		.byte	0
  95 0056 10       		.byte	16
  96 0057 36       		.byte	54
  97 0058 4D       		.byte	77
  98 0059 CD       		.byte	-51
  99 005a AB       		.byte	-85
 100 005b 54       		.byte	84
 101 005c 81       		.byte	-127
 102 005d 99       		.byte	-103
 103 005e C1       		.byte	-63
 104 005f F7       		.byte	-9
 105              		.align	2
 108              	ipAddr_motedata:
 109 0060 20       		.byte	32
 110 0061 01       		.byte	1
 111 0062 04       		.byte	4
 112 0063 70       		.byte	112
 113 0064 00       		.byte	0
 114 0065 66       		.byte	102
 115 0066 00       		.byte	0
 116 0067 17       		.byte	23
 117 0068 00       		.byte	0
 118 0069 00       		.byte	0
 119 006a 00       		.byte	0
 120 006b 00       		.byte	0
 121 006c 00       		.byte	0
 122 006d 00       		.byte	0
 123 006e 00       		.byte	0
 124 006f 02       		.byte	2
 125              		.align	2
 128              	ipAddr_ringmaster:
 129 0070 BB       		.byte	-69
 130 0071 BB       		.byte	-69
 131 0072 00       		.byte	0
 132 0073 00       		.byte	0
 133 0074 00       		.byte	0
 134 0075 00       		.byte	0
 135 0076 00       		.byte	0
 136 0077 00       		.byte	0
 137 0078 00       		.byte	0
 138 0079 00       		.byte	0
 139 007a 00       		.byte	0
 140 007b 00       		.byte	0
 141 007c 00       		.byte	0
 142 007d 00       		.byte	0
 143 007e 00       		.byte	0
 144 007f 01       		.byte	1
 145              		.comm	openoscoap_vars,1,4
 146              		.text
 147              		.align	2
 148              		.global	openoscoap_init_security_context
 149              		.thumb
 150              		.thumb_func
 152              	openoscoap_init_security_context:
 153              	.LFB0:
 154              		.file 1 "build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c"
   1:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** #include "opendefs.h"
   2:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** #include "openserial.h"
   3:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** #include "packetfunctions.h"
   4:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** #include "openoscoap.h"
   5:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** #include "cborencoder.h"
   6:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** #include "cryptoengine.h"
   7:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** #include "sha.h"
   8:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
   9:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  10:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** //=========================== defines =========================================
  11:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  12:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** #define EAAD_MAX_LEN            9 + OSCOAP_MAX_ID_LEN // assumes no Class I options
  13:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** #define AAD_MAX_LEN            12 + EAAD_MAX_LEN
  14:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  15:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** //=========================== variables =======================================
  16:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  17:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** openoscoap_vars_t openoscoap_vars;
  18:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  19:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** //=========================== prototype =======================================
  20:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** owerror_t hkdf_derive_parameter(uint8_t* buffer,
  21:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* masterSecret, 
  22:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t masterSecretLen, 
  23:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* masterSalt,
  24:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t masterSaltLen,
  25:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* identifier,
  26:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t identifierLen,
  27:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t algorithm,
  28:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         oscoap_derivation_t type,
  29:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t length
  30:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         );
  31:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  32:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** bool is_request(uint8_t code);
  33:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  34:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** uint8_t openoscoap_construct_aad(uint8_t* buffer, 
  35:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t version, 
  36:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t code,
  37:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* optionsSerialized,
  38:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t optionsSerializedLen,
  39:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t aeadAlgorithm,
  40:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* requestKid,
  41:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t requestKidLen,
  42:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* requestSeq,
  43:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t requestSeqLen
  44:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         );
  45:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  46:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** void openoscoap_encode_compressed_COSE(OpenQueueEntry_t* msg, 
  47:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* requestSeq, uint8_t requestSeqLen, 
  48:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* requestKid, 
  49:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t requestKidLen);
  50:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  51:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** void xor_arrays(uint8_t* s1, uint8_t* s2, uint8_t* dst, uint8_t len);
  52:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  53:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** void flip_first_bit(uint8_t* source, uint8_t* dst, uint8_t len);
  54:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  55:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** bool replay_window_check(oscoap_security_context_t *context, uint16_t sequenceNumber);
  56:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** void replay_window_update(oscoap_security_context_t *context, uint16_t sequenceNumber);
  57:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  58:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** uint8_t openoscoap_convert_sequence_number(uint16_t sequenceNumber, uint8_t** buffer); 
  59:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** //=========================== public ==========================================
  60:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  61:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  62:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** /**
  63:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** \brief Initialize OSCOAP security context.
  64:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  65:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** This function will derive the parameters needed to initialize OSCOAP
  66:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** security context.
  67:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  68:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** \param[out] ctx OSCOAP security context structure.
  69:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** \param[in] senderID Pointer to the Byte array containing Sender ID.
  70:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** \param[in] senderIDLen Length of the Sender ID byte array in bytes.
  71:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** \param[in] recipientID Pointer to the Byte array contaning Recipient ID.
  72:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** \param[in] recipientIDLen Length of the Recipient ID byte array in bytes.
  73:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** \param[in] Pointer to the byte array contaning the Master Secret.
  74:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** \param[in] Length of the Master Secret byte array in bytes.
  75:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** \param[in] Pointer to the byte array contaning Master Salt.
  76:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** \param[in] Length of the Master Salt byte array in bytes.
  77:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** */
  78:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  79:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** void openoscoap_init_security_context(oscoap_security_context_t *ctx, 
  80:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                 uint8_t* senderID, 
  81:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                 uint8_t senderIDLen,
  82:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                 uint8_t* recipientID,
  83:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                 uint8_t recipientIDLen,
  84:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                 uint8_t* masterSecret,
  85:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                 uint8_t masterSecretLen,
  86:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                 uint8_t* masterSalt,
  87:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                 uint8_t masterSaltLen) {
 155              		.loc 1 87 0
 156              		.cfi_startproc
 157              		@ args = 20, pretend = 0, frame = 16
 158              		@ frame_needed = 1, uses_anonymous_args = 0
 159 0000 80B5     		push	{r7, lr}
 160              		.cfi_def_cfa_offset 8
 161              		.cfi_offset 7, -8
 162              		.cfi_offset 14, -4
 163 0002 8AB0     		sub	sp, sp, #40
 164              		.cfi_def_cfa_offset 48
 165 0004 06AF     		add	r7, sp, #24
 166              		.cfi_def_cfa 7, 24
 167 0006 F860     		str	r0, [r7, #12]
 168 0008 B960     		str	r1, [r7, #8]
 169 000a 3B60     		str	r3, [r7]
 170 000c 1346     		mov	r3, r2
 171 000e FB71     		strb	r3, [r7, #7]
  88:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     
  89:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (senderIDLen > OSCOAP_MAX_ID_LEN || 
 172              		.loc 1 89 0
 173 0010 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 174 0012 0A2B     		cmp	r3, #10
 175 0014 7DD8     		bhi	.L5
 176              		.loc 1 89 0 is_stmt 0 discriminator 1
 177 0016 3B7E     		ldrb	r3, [r7, #24]	@ zero_extendqisi2
 178 0018 0A2B     		cmp	r3, #10
 179 001a 7AD8     		bhi	.L5
  90:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             recipientIDLen > OSCOAP_MAX_ID_LEN) {
  91:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return;
  92:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
  93:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  94:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // common context
  95:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ctx->aeadAlgorithm = AES_CCM_16_64_128; 
 180              		.loc 1 95 0 is_stmt 1
 181 001c FB68     		ldr	r3, [r7, #12]
 182 001e 0A22     		movs	r2, #10
 183 0020 1A70     		strb	r2, [r3]
  96:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
  97:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // sender context
  98:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     memcpy(ctx->senderID, senderID, senderIDLen);
 184              		.loc 1 98 0
 185 0022 FB68     		ldr	r3, [r7, #12]
 186 0024 0133     		adds	r3, r3, #1
 187 0026 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 188 0028 B968     		ldr	r1, [r7, #8]
 189 002a 1846     		mov	r0, r3
 190 002c FFF7FEFF 		bl	memcpy
  99:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ctx->senderIDLen = senderIDLen;
 191              		.loc 1 99 0
 192 0030 FB68     		ldr	r3, [r7, #12]
 193 0032 FA79     		ldrb	r2, [r7, #7]
 194 0034 DA72     		strb	r2, [r3, #11]
 100:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // invoke HKDF to get sender Key
 101:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     hkdf_derive_parameter(ctx->senderKey,
 195              		.loc 1 101 0
 196 0036 FB68     		ldr	r3, [r7, #12]
 197 0038 03F10C00 		add	r0, r3, #12
 198 003c 97F82020 		ldrb	r2, [r7, #32]	@ zero_extendqisi2
 199 0040 1023     		movs	r3, #16
 200 0042 0593     		str	r3, [sp, #20]
 201 0044 0023     		movs	r3, #0
 202 0046 0493     		str	r3, [sp, #16]
 203 0048 0A23     		movs	r3, #10
 204 004a 0393     		str	r3, [sp, #12]
 205 004c FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 206 004e 0293     		str	r3, [sp, #8]
 207 0050 BB68     		ldr	r3, [r7, #8]
 208 0052 0193     		str	r3, [sp, #4]
 209 0054 97F82830 		ldrb	r3, [r7, #40]	@ zero_extendqisi2
 210 0058 0093     		str	r3, [sp]
 211 005a 7B6A     		ldr	r3, [r7, #36]
 212 005c F969     		ldr	r1, [r7, #28]
 213 005e FFF7FEFF 		bl	hkdf_derive_parameter
 102:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSecret, 
 103:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSecretLen,
 104:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSalt, 
 105:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSaltLen,
 106:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             senderID,
 107:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             senderIDLen,
 108:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 109:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             OSCOAP_DERIVATION_TYPE_KEY,
 110:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             AES_CCM_16_64_128_KEY_LEN);
 111:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // invoke HKDF to get sender IV
 112:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     hkdf_derive_parameter(ctx->senderIV,
 214              		.loc 1 112 0
 215 0062 FB68     		ldr	r3, [r7, #12]
 216 0064 03F11C00 		add	r0, r3, #28
 217 0068 97F82020 		ldrb	r2, [r7, #32]	@ zero_extendqisi2
 218 006c 0D23     		movs	r3, #13
 219 006e 0593     		str	r3, [sp, #20]
 220 0070 0123     		movs	r3, #1
 221 0072 0493     		str	r3, [sp, #16]
 222 0074 0A23     		movs	r3, #10
 223 0076 0393     		str	r3, [sp, #12]
 224 0078 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 225 007a 0293     		str	r3, [sp, #8]
 226 007c BB68     		ldr	r3, [r7, #8]
 227 007e 0193     		str	r3, [sp, #4]
 228 0080 97F82830 		ldrb	r3, [r7, #40]	@ zero_extendqisi2
 229 0084 0093     		str	r3, [sp]
 230 0086 7B6A     		ldr	r3, [r7, #36]
 231 0088 F969     		ldr	r1, [r7, #28]
 232 008a FFF7FEFF 		bl	hkdf_derive_parameter
 113:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSecret, 
 114:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSecretLen,
 115:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSalt, 
 116:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSaltLen,
 117:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             senderID,
 118:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             senderIDLen,
 119:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 120:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             OSCOAP_DERIVATION_TYPE_IV,
 121:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             AES_CCM_16_64_128_IV_LEN);
 122:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****    
 123:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ctx->sequenceNumber = 0;
 233              		.loc 1 123 0
 234 008e FB68     		ldr	r3, [r7, #12]
 235 0090 0022     		movs	r2, #0
 236 0092 5A85     		strh	r2, [r3, #42]	@ movhi
 124:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 125:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // recipient context
 126:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     memcpy(ctx->recipientID, recipientID, recipientIDLen);
 237              		.loc 1 126 0
 238 0094 FB68     		ldr	r3, [r7, #12]
 239 0096 2C33     		adds	r3, r3, #44
 240 0098 3A7E     		ldrb	r2, [r7, #24]	@ zero_extendqisi2
 241 009a 3968     		ldr	r1, [r7]
 242 009c 1846     		mov	r0, r3
 243 009e FFF7FEFF 		bl	memcpy
 127:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ctx->recipientIDLen = recipientIDLen;
 244              		.loc 1 127 0
 245 00a2 FB68     		ldr	r3, [r7, #12]
 246 00a4 3A7E     		ldrb	r2, [r7, #24]
 247 00a6 83F83620 		strb	r2, [r3, #54]
 128:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // invoke HKDF to get recipient Key
 129:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     hkdf_derive_parameter(ctx->recipientKey,
 248              		.loc 1 129 0
 249 00aa FB68     		ldr	r3, [r7, #12]
 250 00ac 03F13700 		add	r0, r3, #55
 251 00b0 97F82020 		ldrb	r2, [r7, #32]	@ zero_extendqisi2
 252 00b4 1023     		movs	r3, #16
 253 00b6 0593     		str	r3, [sp, #20]
 254 00b8 0023     		movs	r3, #0
 255 00ba 0493     		str	r3, [sp, #16]
 256 00bc 0A23     		movs	r3, #10
 257 00be 0393     		str	r3, [sp, #12]
 258 00c0 3B7E     		ldrb	r3, [r7, #24]	@ zero_extendqisi2
 259 00c2 0293     		str	r3, [sp, #8]
 260 00c4 3B68     		ldr	r3, [r7]
 261 00c6 0193     		str	r3, [sp, #4]
 262 00c8 97F82830 		ldrb	r3, [r7, #40]	@ zero_extendqisi2
 263 00cc 0093     		str	r3, [sp]
 264 00ce 7B6A     		ldr	r3, [r7, #36]
 265 00d0 F969     		ldr	r1, [r7, #28]
 266 00d2 FFF7FEFF 		bl	hkdf_derive_parameter
 130:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSecret, 
 131:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSecretLen,
 132:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSalt, 
 133:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSaltLen,
 134:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             recipientID,
 135:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             recipientIDLen,
 136:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 137:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             OSCOAP_DERIVATION_TYPE_KEY,
 138:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             AES_CCM_16_64_128_KEY_LEN);
 139:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 140:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // invoke HKDF to get recipient IV
 141:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     hkdf_derive_parameter(ctx->recipientIV,
 267              		.loc 1 141 0
 268 00d6 FB68     		ldr	r3, [r7, #12]
 269 00d8 03F14700 		add	r0, r3, #71
 270 00dc 97F82020 		ldrb	r2, [r7, #32]	@ zero_extendqisi2
 271 00e0 0D23     		movs	r3, #13
 272 00e2 0593     		str	r3, [sp, #20]
 273 00e4 0123     		movs	r3, #1
 274 00e6 0493     		str	r3, [sp, #16]
 275 00e8 0A23     		movs	r3, #10
 276 00ea 0393     		str	r3, [sp, #12]
 277 00ec 3B7E     		ldrb	r3, [r7, #24]	@ zero_extendqisi2
 278 00ee 0293     		str	r3, [sp, #8]
 279 00f0 3B68     		ldr	r3, [r7]
 280 00f2 0193     		str	r3, [sp, #4]
 281 00f4 97F82830 		ldrb	r3, [r7, #40]	@ zero_extendqisi2
 282 00f8 0093     		str	r3, [sp]
 283 00fa 7B6A     		ldr	r3, [r7, #36]
 284 00fc F969     		ldr	r1, [r7, #28]
 285 00fe FFF7FEFF 		bl	hkdf_derive_parameter
 142:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSecret, 
 143:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSecretLen,
 144:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSalt, 
 145:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             masterSaltLen,
 146:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             recipientID,
 147:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             recipientIDLen,
 148:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 149:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             OSCOAP_DERIVATION_TYPE_IV,
 150:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             AES_CCM_16_64_128_IV_LEN);
 151:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****  
 152:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ctx->window.bitArray = 0x01; // LSB set
 286              		.loc 1 152 0
 287 0102 FB68     		ldr	r3, [r7, #12]
 288 0104 0122     		movs	r2, #1
 289 0106 5A65     		str	r2, [r3, #84]
 153:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ctx->window.rightEdge = 0;
 290              		.loc 1 153 0
 291 0108 FB68     		ldr	r3, [r7, #12]
 292 010a 0022     		movs	r2, #0
 293 010c A3F85820 		strh	r2, [r3, #88]	@ movhi
 294 0110 00E0     		b	.L1
 295              	.L5:
  91:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 296              		.loc 1 91 0
 297 0112 00BF     		nop
 298              	.L1:
 154:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 155:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 299              		.loc 1 155 0
 300 0114 1037     		adds	r7, r7, #16
 301              		.cfi_def_cfa_offset 8
 302 0116 BD46     		mov	sp, r7
 303              		.cfi_def_cfa_register 13
 304              		@ sp needed
 305 0118 80BD     		pop	{r7, pc}
 306              		.cfi_endproc
 307              	.LFE0:
 309 011a 00BF     		.align	2
 310              		.global	openoscoap_protect_message
 311              		.thumb
 312              		.thumb_func
 314              	openoscoap_protect_message:
 315              	.LFB1:
 156:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 157:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** owerror_t openoscoap_protect_message(
 158:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         oscoap_security_context_t *context, 
 159:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t version, 
 160:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t code,
 161:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         coap_option_iht* incomingOptions,
 162:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t incomingOptionsLen,
 163:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         OpenQueueEntry_t* msg,
 164:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint16_t sequenceNumber) {
 316              		.loc 1 164 0
 317              		.cfi_startproc
 318              		@ args = 12, pretend = 0, frame = 120
 319              		@ frame_needed = 1, uses_anonymous_args = 0
 320 011c 90B5     		push	{r4, r7, lr}
 321              		.cfi_def_cfa_offset 12
 322              		.cfi_offset 4, -12
 323              		.cfi_offset 7, -8
 324              		.cfi_offset 14, -4
 325 011e A5B0     		sub	sp, sp, #148
 326              		.cfi_def_cfa_offset 160
 327 0120 06AF     		add	r7, sp, #24
 328              		.cfi_def_cfa 7, 136
 329 0122 F860     		str	r0, [r7, #12]
 330 0124 7B60     		str	r3, [r7, #4]
 331 0126 0B46     		mov	r3, r1
 332 0128 FB72     		strb	r3, [r7, #11]
 333 012a 1346     		mov	r3, r2
 334 012c BB72     		strb	r3, [r7, #10]
 165:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 166:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t* payload;
 167:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t payloadLen;
 168:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t aad[AAD_MAX_LEN];
 169:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t aadLen;
 170:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t nonce[AES_CCM_16_64_128_IV_LEN];
 171:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t partialIV[AES_CCM_16_64_128_IV_LEN];
 172:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t* requestSeq;
 173:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t requestSeqLen;
 174:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t *requestKid;
 175:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t requestKidLen;
 176:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     owerror_t encStatus;
 177:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     coap_option_iht* objectSecurity;
 178:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     bool payloadPresent;
 179:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t                   option_count;
 180:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t                   option_index;
 181:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 182:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // find object security option in the list of passed options
 183:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     option_count = opencoap_find_option(incomingOptions, incomingOptionsLen, COAP_OPTION_NUM_OBJECT
 335              		.loc 1 183 0
 336 012e 07F11703 		add	r3, r7, #23
 337 0132 97F88810 		ldrb	r1, [r7, #136]	@ zero_extendqisi2
 338 0136 1522     		movs	r2, #21
 339 0138 7868     		ldr	r0, [r7, #4]
 340 013a FFF7FEFF 		bl	opencoap_find_option
 341 013e 0346     		mov	r3, r0
 342 0140 87F86630 		strb	r3, [r7, #102]
 184:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if(option_count >= 1) {
 343              		.loc 1 184 0
 344 0144 97F86630 		ldrb	r3, [r7, #102]	@ zero_extendqisi2
 345 0148 002B     		cmp	r3, #0
 346 014a 05D0     		beq	.L7
 185:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****       objectSecurity = &incomingOptions[option_index];
 347              		.loc 1 185 0
 348 014c FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 349 014e DB00     		lsls	r3, r3, #3
 350 0150 7A68     		ldr	r2, [r7, #4]
 351 0152 1344     		add	r3, r3, r2
 352 0154 BB66     		str	r3, [r7, #104]
 353 0156 01E0     		b	.L8
 354              	.L7:
 186:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     } else {
 187:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****       objectSecurity = NULL;
 355              		.loc 1 187 0
 356 0158 0023     		movs	r3, #0
 357 015a BB66     		str	r3, [r7, #104]
 358              	.L8:
 188:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 189:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (objectSecurity == NULL) { // objectSecurity option should be set by the application
 359              		.loc 1 189 0
 360 015c BB6E     		ldr	r3, [r7, #104]
 361 015e 002B     		cmp	r3, #0
 362 0160 01D1     		bne	.L9
 190:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return E_FAIL;
 363              		.loc 1 190 0
 364 0162 0123     		movs	r3, #1
 365 0164 0BE1     		b	.L21
 366              	.L9:
 191:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 192:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 193:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // convert sequence number to array and strip leading zeros
 194:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     memset(partialIV, 0x00, AES_CCM_16_64_128_IV_LEN);
 367              		.loc 1 194 0
 368 0166 07F11C03 		add	r3, r7, #28
 369 016a 0D22     		movs	r2, #13
 370 016c 0021     		movs	r1, #0
 371 016e 1846     		mov	r0, r3
 372 0170 FFF7FEFF 		bl	memset
 195:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     requestSeq = &partialIV[AES_CCM_16_64_128_IV_LEN - 2];
 373              		.loc 1 195 0
 374 0174 07F11C03 		add	r3, r7, #28
 375 0178 0B33     		adds	r3, r3, #11
 376 017a BB61     		str	r3, [r7, #24]
 196:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     requestSeqLen = openoscoap_convert_sequence_number(sequenceNumber, &requestSeq);
 377              		.loc 1 196 0
 378 017c 07F11802 		add	r2, r7, #24
 379 0180 B7F89030 		ldrh	r3, [r7, #144]
 380 0184 1146     		mov	r1, r2
 381 0186 1846     		mov	r0, r3
 382 0188 FFF7FEFF 		bl	openoscoap_convert_sequence_number
 383 018c 0346     		mov	r3, r0
 384 018e 87F87730 		strb	r3, [r7, #119]
 197:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 198:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (is_request(code)) {
 385              		.loc 1 198 0
 386 0192 BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 387 0194 1846     		mov	r0, r3
 388 0196 FFF7FEFF 		bl	is_request
 389 019a 0346     		mov	r3, r0
 390 019c 002B     		cmp	r3, #0
 391 019e 07D0     		beq	.L11
 199:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestKid = context->senderID;
 392              		.loc 1 199 0
 393 01a0 FB68     		ldr	r3, [r7, #12]
 394 01a2 0133     		adds	r3, r3, #1
 395 01a4 3B67     		str	r3, [r7, #112]
 200:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestKidLen = context->senderIDLen;
 396              		.loc 1 200 0
 397 01a6 FB68     		ldr	r3, [r7, #12]
 398 01a8 DB7A     		ldrb	r3, [r3, #11]
 399 01aa 87F86F30 		strb	r3, [r7, #111]
 400 01ae 07E0     		b	.L12
 401              	.L11:
 201:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 202:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 203:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestKid = context->recipientID;
 402              		.loc 1 203 0
 403 01b0 FB68     		ldr	r3, [r7, #12]
 404 01b2 2C33     		adds	r3, r3, #44
 405 01b4 3B67     		str	r3, [r7, #112]
 204:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestKidLen = context->recipientIDLen;
 406              		.loc 1 204 0
 407 01b6 FB68     		ldr	r3, [r7, #12]
 408 01b8 93F83630 		ldrb	r3, [r3, #54]
 409 01bc 87F86F30 		strb	r3, [r7, #111]
 410              	.L12:
 205:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 206:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 207:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (msg->length > 0 ) { // contains payload, add payload marker
 411              		.loc 1 207 0
 412 01c0 D7F88C30 		ldr	r3, [r7, #140]
 413 01c4 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 414 01c6 002B     		cmp	r3, #0
 415 01c8 0DD0     		beq	.L13
 208:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         payloadPresent = TRUE;
 416              		.loc 1 208 0
 417 01ca 0123     		movs	r3, #1
 418 01cc 87F86730 		strb	r3, [r7, #103]
 209:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         packetfunctions_reserveHeaderSize(msg,1);
 419              		.loc 1 209 0
 420 01d0 0121     		movs	r1, #1
 421 01d2 D7F88C00 		ldr	r0, [r7, #140]
 422 01d6 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 210:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         msg->payload[0] = COAP_PAYLOAD_MARKER;
 423              		.loc 1 210 0
 424 01da D7F88C30 		ldr	r3, [r7, #140]
 425 01de 5B68     		ldr	r3, [r3, #4]
 426 01e0 FF22     		movs	r2, #255
 427 01e2 1A70     		strb	r2, [r3]
 428 01e4 02E0     		b	.L14
 429              	.L13:
 211:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 212:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 213:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         payloadPresent = FALSE;
 430              		.loc 1 213 0
 431 01e6 0023     		movs	r3, #0
 432 01e8 87F86730 		strb	r3, [r7, #103]
 433              	.L14:
 214:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 215:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 216:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // encode the options to the openqueue payload buffer
 217:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     opencoap_options_encode(msg, 
 434              		.loc 1 217 0
 435 01ec 97F88820 		ldrb	r2, [r7, #136]	@ zero_extendqisi2
 436 01f0 0023     		movs	r3, #0
 437 01f2 7968     		ldr	r1, [r7, #4]
 438 01f4 D7F88C00 		ldr	r0, [r7, #140]
 439 01f8 FFF7FEFF 		bl	opencoap_options_encode
 218:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             incomingOptions, 
 219:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             incomingOptionsLen, 
 220:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             COAP_OPTION_CLASS_E);
 221:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 222:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     payload = &msg->payload[0];
 440              		.loc 1 222 0
 441 01fc D7F88C30 		ldr	r3, [r7, #140]
 442 0200 5B68     		ldr	r3, [r3, #4]
 443 0202 3B66     		str	r3, [r7, #96]
 223:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     payloadLen = msg->length;
 444              		.loc 1 223 0
 445 0204 D7F88C30 		ldr	r3, [r7, #140]
 446 0208 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 447 020a 87F85D30 		strb	r3, [r7, #93]
 224:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // shift payload to leave space for authentication tag
 225:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     packetfunctions_reserveHeaderSize(msg, AES_CCM_16_64_128_TAG_LEN);
 448              		.loc 1 225 0
 449 020e 0821     		movs	r1, #8
 450 0210 D7F88C00 		ldr	r0, [r7, #140]
 451 0214 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 226:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     memcpy(&msg->payload[0], payload, payloadLen);
 452              		.loc 1 226 0
 453 0218 D7F88C30 		ldr	r3, [r7, #140]
 454 021c 5B68     		ldr	r3, [r3, #4]
 455 021e 97F85D20 		ldrb	r2, [r7, #93]	@ zero_extendqisi2
 456 0222 396E     		ldr	r1, [r7, #96]
 457 0224 1846     		mov	r0, r3
 458 0226 FFF7FEFF 		bl	memcpy
 227:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // update payload pointer but leave length intact
 228:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     payload = &msg->payload[0];
 459              		.loc 1 228 0
 460 022a D7F88C30 		ldr	r3, [r7, #140]
 461 022e 5B68     		ldr	r3, [r3, #4]
 462 0230 3B66     		str	r3, [r7, #96]
 229:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 230:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     aadLen = openoscoap_construct_aad(aad,
 463              		.loc 1 230 0
 464 0232 BB69     		ldr	r3, [r7, #24]
 465 0234 BC7A     		ldrb	r4, [r7, #10]	@ zero_extendqisi2
 466 0236 F97A     		ldrb	r1, [r7, #11]	@ zero_extendqisi2
 467 0238 07F13C00 		add	r0, r7, #60
 468 023c 97F87720 		ldrb	r2, [r7, #119]	@ zero_extendqisi2
 469 0240 0592     		str	r2, [sp, #20]
 470 0242 0493     		str	r3, [sp, #16]
 471 0244 97F86F30 		ldrb	r3, [r7, #111]	@ zero_extendqisi2
 472 0248 0393     		str	r3, [sp, #12]
 473 024a 3B6F     		ldr	r3, [r7, #112]
 474 024c 0293     		str	r3, [sp, #8]
 475 024e 0A23     		movs	r3, #10
 476 0250 0193     		str	r3, [sp, #4]
 477 0252 0023     		movs	r3, #0
 478 0254 0093     		str	r3, [sp]
 479 0256 0023     		movs	r3, #0
 480 0258 2246     		mov	r2, r4
 481 025a FFF7FEFF 		bl	openoscoap_construct_aad
 482 025e 0346     		mov	r3, r0
 483 0260 87F85F30 		strb	r3, [r7, #95]
 231:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             version,
 232:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             code,
 233:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             NULL,
 234:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             0, // do not support Class I options at the moment
 235:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 236:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             requestKid,
 237:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             requestKidLen,
 238:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             requestSeq,
 239:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             requestSeqLen);
 240:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 241:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (aadLen > AAD_MAX_LEN) {
 484              		.loc 1 241 0
 485 0264 97F85F30 		ldrb	r3, [r7, #95]	@ zero_extendqisi2
 486 0268 1F2B     		cmp	r3, #31
 487 026a 07D9     		bls	.L15
 242:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         // corruption
 243:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         openserial_printError(
 488              		.loc 1 243 0
 489 026c 0023     		movs	r3, #0
 490 026e 0022     		movs	r2, #0
 491 0270 4621     		movs	r1, #70
 492 0272 2C20     		movs	r0, #44
 493 0274 FFF7FEFF 		bl	openserial_printError
 244:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_BUFFER_OVERFLOW,
 245:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0,
 246:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0
 247:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         );
 248:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return E_FAIL;
 494              		.loc 1 248 0
 495 0278 0123     		movs	r3, #1
 496 027a 80E0     		b	.L21
 497              	.L15:
 249:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 250:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     
 251:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // construct nonce 
 252:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (is_request(code)) {
 498              		.loc 1 252 0
 499 027c BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 500 027e 1846     		mov	r0, r3
 501 0280 FFF7FEFF 		bl	is_request
 502 0284 0346     		mov	r3, r0
 503 0286 002B     		cmp	r3, #0
 504 0288 0AD0     		beq	.L16
 253:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         xor_arrays(context->senderIV, partialIV, nonce, AES_CCM_16_64_128_IV_LEN); 
 505              		.loc 1 253 0
 506 028a FB68     		ldr	r3, [r7, #12]
 507 028c 03F11C00 		add	r0, r3, #28
 508 0290 07F12C02 		add	r2, r7, #44
 509 0294 07F11C01 		add	r1, r7, #28
 510 0298 0D23     		movs	r3, #13
 511 029a FFF7FEFF 		bl	xor_arrays
 512 029e 1AE0     		b	.L17
 513              	.L16:
 254:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 255:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 256:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         flip_first_bit(context->senderIV, nonce, AES_CCM_16_64_128_IV_LEN);
 514              		.loc 1 256 0
 515 02a0 FB68     		ldr	r3, [r7, #12]
 516 02a2 1C33     		adds	r3, r3, #28
 517 02a4 07F12C01 		add	r1, r7, #44
 518 02a8 0D22     		movs	r2, #13
 519 02aa 1846     		mov	r0, r3
 520 02ac FFF7FEFF 		bl	flip_first_bit
 257:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         xor_arrays(nonce, partialIV, nonce, AES_CCM_16_64_128_IV_LEN);
 521              		.loc 1 257 0
 522 02b0 07F12C02 		add	r2, r7, #44
 523 02b4 07F11C01 		add	r1, r7, #28
 524 02b8 07F12C00 		add	r0, r7, #44
 525 02bc 0D23     		movs	r3, #13
 526 02be FFF7FEFF 		bl	xor_arrays
 258:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         // do not encode sequence number and ID in the response
 259:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestSeq = NULL;
 527              		.loc 1 259 0
 528 02c2 0023     		movs	r3, #0
 529 02c4 BB61     		str	r3, [r7, #24]
 260:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestSeqLen = 0;
 530              		.loc 1 260 0
 531 02c6 0023     		movs	r3, #0
 532 02c8 87F87730 		strb	r3, [r7, #119]
 261:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestKid = NULL;
 533              		.loc 1 261 0
 534 02cc 0023     		movs	r3, #0
 535 02ce 3B67     		str	r3, [r7, #112]
 262:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestKidLen = 0;
 536              		.loc 1 262 0
 537 02d0 0023     		movs	r3, #0
 538 02d2 87F86F30 		strb	r3, [r7, #111]
 539              	.L17:
 263:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 264:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 265:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****      encStatus = cryptoengine_aes_ccms_enc(aad,
 266:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                         aadLen,
 267:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                         payload,
 268:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                         &payloadLen,
 269:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                         nonce,
 270:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                         2, // L=2 in 15.4 std
 271:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                         context->senderKey,
 540              		.loc 1 271 0
 541 02d6 FB68     		ldr	r3, [r7, #12]
 542 02d8 0C33     		adds	r3, r3, #12
 265:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                         aadLen,
 543              		.loc 1 265 0
 544 02da 07F15D04 		add	r4, r7, #93
 545 02de 97F85F10 		ldrb	r1, [r7, #95]	@ zero_extendqisi2
 546 02e2 07F13C00 		add	r0, r7, #60
 547 02e6 0822     		movs	r2, #8
 548 02e8 0392     		str	r2, [sp, #12]
 549 02ea 0293     		str	r3, [sp, #8]
 550 02ec 0223     		movs	r3, #2
 551 02ee 0193     		str	r3, [sp, #4]
 552 02f0 07F12C03 		add	r3, r7, #44
 553 02f4 0093     		str	r3, [sp]
 554 02f6 2346     		mov	r3, r4
 555 02f8 3A6E     		ldr	r2, [r7, #96]
 556 02fa FFF7FEFF 		bl	cryptoengine_aes_ccms_enc
 557 02fe 0346     		mov	r3, r0
 558 0300 87F85E30 		strb	r3, [r7, #94]
 272:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                         AES_CCM_16_64_128_TAG_LEN);
 273:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 274:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****      if (encStatus != E_SUCCESS) {
 559              		.loc 1 274 0
 560 0304 97F85E30 		ldrb	r3, [r7, #94]	@ zero_extendqisi2
 561 0308 002B     		cmp	r3, #0
 562 030a 01D0     		beq	.L18
 275:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return E_FAIL;
 563              		.loc 1 275 0
 564 030c 0123     		movs	r3, #1
 565 030e 36E0     		b	.L21
 566              	.L18:
 276:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****      }
 277:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 278:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****      // encode compressed COSE
 279:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****      openoscoap_encode_compressed_COSE(msg, requestSeq, requestSeqLen, requestKid, requestKidLen);
 567              		.loc 1 279 0
 568 0310 B969     		ldr	r1, [r7, #24]
 569 0312 97F87720 		ldrb	r2, [r7, #119]	@ zero_extendqisi2
 570 0316 97F86F30 		ldrb	r3, [r7, #111]	@ zero_extendqisi2
 571 031a 0093     		str	r3, [sp]
 572 031c 3B6F     		ldr	r3, [r7, #112]
 573 031e D7F88C00 		ldr	r0, [r7, #140]
 574 0322 FFF7FEFF 		bl	openoscoap_encode_compressed_COSE
 280:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 281:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 282:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (payloadPresent) {
 575              		.loc 1 282 0
 576 0326 97F86730 		ldrb	r3, [r7, #103]	@ zero_extendqisi2
 577 032a 002B     		cmp	r3, #0
 578 032c 06D0     		beq	.L19
 283:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         // set the object security option to 0 length
 284:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         // as the value will be carried in message payload
 285:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         objectSecurity->length = 0;
 579              		.loc 1 285 0
 580 032e BB6E     		ldr	r3, [r7, #104]
 581 0330 0022     		movs	r2, #0
 582 0332 5A70     		strb	r2, [r3, #1]
 286:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         objectSecurity->pValue = NULL;
 583              		.loc 1 286 0
 584 0334 BB6E     		ldr	r3, [r7, #104]
 585 0336 0022     		movs	r2, #0
 586 0338 5A60     		str	r2, [r3, #4]
 587 033a 1FE0     		b	.L20
 588              	.L19:
 287:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 288:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 289:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         objectSecurity->length = msg->length;
 589              		.loc 1 289 0
 590 033c D7F88C30 		ldr	r3, [r7, #140]
 591 0340 1A7A     		ldrb	r2, [r3, #8]	@ zero_extendqisi2
 592 0342 BB6E     		ldr	r3, [r7, #104]
 593 0344 5A70     		strb	r2, [r3, #1]
 290:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         // FIXME use the upper bytes in the msg->packet buffer
 291:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         memcpy(&msg->packet[0], &msg->payload[0], msg->length);
 594              		.loc 1 291 0
 595 0346 D7F88C30 		ldr	r3, [r7, #140]
 596 034a 03F1C000 		add	r0, r3, #192
 597 034e D7F88C30 		ldr	r3, [r7, #140]
 598 0352 5968     		ldr	r1, [r3, #4]
 599 0354 D7F88C30 		ldr	r3, [r7, #140]
 600 0358 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 601 035a 1A46     		mov	r2, r3
 602 035c FFF7FEFF 		bl	memcpy
 292:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         objectSecurity->pValue = &msg->packet[0];
 603              		.loc 1 292 0
 604 0360 D7F88C30 		ldr	r3, [r7, #140]
 605 0364 03F1C002 		add	r2, r3, #192
 606 0368 BB6E     		ldr	r3, [r7, #104]
 607 036a 5A60     		str	r2, [r3, #4]
 293:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         packetfunctions_tossHeader(msg, msg->length); // reset packet to zero as objectSecurity opt
 608              		.loc 1 293 0
 609 036c D7F88C30 		ldr	r3, [r7, #140]
 610 0370 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 611 0372 1946     		mov	r1, r3
 612 0374 D7F88C00 		ldr	r0, [r7, #140]
 613 0378 FFF7FEFF 		bl	packetfunctions_tossHeader
 614              	.L20:
 294:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 295:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 296:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     return E_SUCCESS;
 615              		.loc 1 296 0
 616 037c 0023     		movs	r3, #0
 617              	.L21:
 297:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 618              		.loc 1 297 0 discriminator 1
 619 037e 1846     		mov	r0, r3
 620 0380 7C37     		adds	r7, r7, #124
 621              		.cfi_def_cfa_offset 12
 622 0382 BD46     		mov	sp, r7
 623              		.cfi_def_cfa_register 13
 624              		@ sp needed
 625 0384 90BD     		pop	{r4, r7, pc}
 626              		.cfi_endproc
 627              	.LFE1:
 629 0386 00BF     		.align	2
 630              		.global	openoscoap_unprotect_message
 631              		.thumb
 632              		.thumb_func
 634              	openoscoap_unprotect_message:
 635              	.LFB2:
 298:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 299:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** owerror_t openoscoap_unprotect_message(
 300:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         oscoap_security_context_t *context, 
 301:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t version, 
 302:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t code,
 303:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         coap_option_iht* incomingOptions,
 304:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* incomingOptionsLen,
 305:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         OpenQueueEntry_t* msg,
 306:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint16_t sequenceNumber) {
 636              		.loc 1 306 0
 637              		.cfi_startproc
 638              		@ args = 12, pretend = 0, frame = 112
 639              		@ frame_needed = 1, uses_anonymous_args = 0
 640 0388 90B5     		push	{r4, r7, lr}
 641              		.cfi_def_cfa_offset 12
 642              		.cfi_offset 4, -12
 643              		.cfi_offset 7, -8
 644              		.cfi_offset 14, -4
 645 038a A3B0     		sub	sp, sp, #140
 646              		.cfi_def_cfa_offset 152
 647 038c 06AF     		add	r7, sp, #24
 648              		.cfi_def_cfa 7, 128
 649 038e F860     		str	r0, [r7, #12]
 650 0390 7B60     		str	r3, [r7, #4]
 651 0392 0B46     		mov	r3, r1
 652 0394 FB72     		strb	r3, [r7, #11]
 653 0396 1346     		mov	r3, r2
 654 0398 BB72     		strb	r3, [r7, #10]
 307:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****  
 308:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t nonce[AES_CCM_16_64_128_IV_LEN];
 309:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t partialIV[AES_CCM_16_64_128_IV_LEN];
 310:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t *requestKid;
 311:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t requestKidLen;
 312:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t* requestSeq;
 313:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t requestSeqLen;
 314:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t aad[AAD_MAX_LEN];
 315:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t aadLen;
 316:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     coap_option_iht* objectSecurity;
 317:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     owerror_t decStatus;
 318:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t* ciphertext;
 319:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t ciphertextLen;
 320:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     bool payloadInObjSec;
 321:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t index;
 322:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t option_count;
 323:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t option_index;
 324:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 325:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // find object security option in the list of passed options
 326:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     option_count = opencoap_find_option(incomingOptions, *incomingOptionsLen, COAP_OPTION_NUM_OBJEC
 655              		.loc 1 326 0
 656 039a D7F88030 		ldr	r3, [r7, #128]
 657 039e 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 658 03a0 07F11603 		add	r3, r7, #22
 659 03a4 1522     		movs	r2, #21
 660 03a6 7868     		ldr	r0, [r7, #4]
 661 03a8 FFF7FEFF 		bl	opencoap_find_option
 662 03ac 0346     		mov	r3, r0
 663 03ae 87F85E30 		strb	r3, [r7, #94]
 327:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if(option_count >= 1) {
 664              		.loc 1 327 0
 665 03b2 97F85E30 		ldrb	r3, [r7, #94]	@ zero_extendqisi2
 666 03b6 002B     		cmp	r3, #0
 667 03b8 05D0     		beq	.L23
 328:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****       objectSecurity = &incomingOptions[option_index];
 668              		.loc 1 328 0
 669 03ba BB7D     		ldrb	r3, [r7, #22]	@ zero_extendqisi2
 670 03bc DB00     		lsls	r3, r3, #3
 671 03be 7A68     		ldr	r2, [r7, #4]
 672 03c0 1344     		add	r3, r3, r2
 673 03c2 7B66     		str	r3, [r7, #100]
 674 03c4 01E0     		b	.L24
 675              	.L23:
 329:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     } else {
 330:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****       objectSecurity = NULL;
 676              		.loc 1 330 0
 677 03c6 0023     		movs	r3, #0
 678 03c8 7B66     		str	r3, [r7, #100]
 679              	.L24:
 331:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 332:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (objectSecurity == NULL) { // return FAIL if object security option is not present
 680              		.loc 1 332 0
 681 03ca 7B6E     		ldr	r3, [r7, #100]
 682 03cc 002B     		cmp	r3, #0
 683 03ce 01D1     		bne	.L25
 333:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return E_FAIL;
 684              		.loc 1 333 0
 685 03d0 0123     		movs	r3, #1
 686 03d2 FAE0     		b	.L39
 687              	.L25:
 334:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 335:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 336:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (objectSecurity->length != 0) {
 688              		.loc 1 336 0
 689 03d4 7B6E     		ldr	r3, [r7, #100]
 690 03d6 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 691 03d8 002B     		cmp	r3, #0
 692 03da 09D0     		beq	.L27
 337:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         ciphertext = objectSecurity->pValue;
 693              		.loc 1 337 0
 694 03dc 7B6E     		ldr	r3, [r7, #100]
 695 03de 5B68     		ldr	r3, [r3, #4]
 696 03e0 3B66     		str	r3, [r7, #96]
 338:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         ciphertextLen = objectSecurity->length;
 697              		.loc 1 338 0
 698 03e2 7B6E     		ldr	r3, [r7, #100]
 699 03e4 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 700 03e6 FB75     		strb	r3, [r7, #23]
 339:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         payloadInObjSec = TRUE;
 701              		.loc 1 339 0
 702 03e8 0123     		movs	r3, #1
 703 03ea 87F85F30 		strb	r3, [r7, #95]
 704 03ee 0AE0     		b	.L28
 705              	.L27:
 340:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 341:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 342:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         ciphertext = &msg->payload[0];
 706              		.loc 1 342 0
 707 03f0 D7F88430 		ldr	r3, [r7, #132]
 708 03f4 5B68     		ldr	r3, [r3, #4]
 709 03f6 3B66     		str	r3, [r7, #96]
 343:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         ciphertextLen = msg->length;
 710              		.loc 1 343 0
 711 03f8 D7F88430 		ldr	r3, [r7, #132]
 712 03fc 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 713 03fe FB75     		strb	r3, [r7, #23]
 344:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         payloadInObjSec = FALSE;
 714              		.loc 1 344 0
 715 0400 0023     		movs	r3, #0
 716 0402 87F85F30 		strb	r3, [r7, #95]
 717              	.L28:
 345:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 346:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 347:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (is_request(code)) {
 718              		.loc 1 347 0
 719 0406 BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 720 0408 1846     		mov	r0, r3
 721 040a FFF7FEFF 		bl	is_request
 722 040e 0346     		mov	r3, r0
 723 0410 002B     		cmp	r3, #0
 724 0412 1CD0     		beq	.L29
 348:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         if (replay_window_check(context, sequenceNumber) == FALSE) {
 725              		.loc 1 348 0
 726 0414 B7F88830 		ldrh	r3, [r7, #136]
 727 0418 1946     		mov	r1, r3
 728 041a F868     		ldr	r0, [r7, #12]
 729 041c FFF7FEFF 		bl	replay_window_check
 730 0420 0346     		mov	r3, r0
 731 0422 83F00103 		eor	r3, r3, #1
 732 0426 DBB2     		uxtb	r3, r3
 733 0428 002B     		cmp	r3, #0
 734 042a 07D0     		beq	.L30
 349:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             openserial_printError(
 735              		.loc 1 349 0
 736 042c 0023     		movs	r3, #0
 737 042e 0022     		movs	r2, #0
 738 0430 4721     		movs	r1, #71
 739 0432 2C20     		movs	r0, #44
 740 0434 FFF7FEFF 		bl	openserial_printError
 350:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_REPLAY_FAILED,
 351:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0,
 352:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0
 353:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             );
 354:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             return E_FAIL;
 741              		.loc 1 354 0
 742 0438 0123     		movs	r3, #1
 743 043a C6E0     		b	.L39
 744              	.L30:
 355:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         }
 356:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestKid = context->recipientID;
 745              		.loc 1 356 0
 746 043c FB68     		ldr	r3, [r7, #12]
 747 043e 2C33     		adds	r3, r3, #44
 748 0440 FB66     		str	r3, [r7, #108]
 357:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestKidLen = context->recipientIDLen;
 749              		.loc 1 357 0
 750 0442 FB68     		ldr	r3, [r7, #12]
 751 0444 93F83630 		ldrb	r3, [r3, #54]
 752 0448 87F86B30 		strb	r3, [r7, #107]
 753 044c 06E0     		b	.L31
 754              	.L29:
 358:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 359:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 360:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestKid = context->senderID;
 755              		.loc 1 360 0
 756 044e FB68     		ldr	r3, [r7, #12]
 757 0450 0133     		adds	r3, r3, #1
 758 0452 FB66     		str	r3, [r7, #108]
 361:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         requestKidLen = context->senderIDLen;
 759              		.loc 1 361 0
 760 0454 FB68     		ldr	r3, [r7, #12]
 761 0456 DB7A     		ldrb	r3, [r3, #11]
 762 0458 87F86B30 		strb	r3, [r7, #107]
 763              	.L31:
 362:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 363:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 364:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // convert sequence number to array and strip leading zeros
 365:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     memset(partialIV, 0x00, AES_CCM_16_64_128_IV_LEN);
 764              		.loc 1 365 0
 765 045c 07F13C03 		add	r3, r7, #60
 766 0460 0D22     		movs	r2, #13
 767 0462 0021     		movs	r1, #0
 768 0464 1846     		mov	r0, r3
 769 0466 FFF7FEFF 		bl	memset
 366:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     requestSeq = &partialIV[AES_CCM_16_64_128_IV_LEN - 2];
 770              		.loc 1 366 0
 771 046a 07F13C03 		add	r3, r7, #60
 772 046e 0B33     		adds	r3, r3, #11
 773 0470 BB63     		str	r3, [r7, #56]
 367:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     requestSeqLen = openoscoap_convert_sequence_number(sequenceNumber, &requestSeq);
 774              		.loc 1 367 0
 775 0472 07F13802 		add	r2, r7, #56
 776 0476 B7F88830 		ldrh	r3, [r7, #136]
 777 047a 1146     		mov	r1, r2
 778 047c 1846     		mov	r0, r3
 779 047e FFF7FEFF 		bl	openoscoap_convert_sequence_number
 780 0482 0346     		mov	r3, r0
 781 0484 87F85D30 		strb	r3, [r7, #93]
 368:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 369:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     aadLen = openoscoap_construct_aad(aad,
 782              		.loc 1 369 0
 783 0488 BB6B     		ldr	r3, [r7, #56]
 784 048a BC7A     		ldrb	r4, [r7, #10]	@ zero_extendqisi2
 785 048c F97A     		ldrb	r1, [r7, #11]	@ zero_extendqisi2
 786 048e 07F11800 		add	r0, r7, #24
 787 0492 97F85D20 		ldrb	r2, [r7, #93]	@ zero_extendqisi2
 788 0496 0592     		str	r2, [sp, #20]
 789 0498 0493     		str	r3, [sp, #16]
 790 049a 97F86B30 		ldrb	r3, [r7, #107]	@ zero_extendqisi2
 791 049e 0393     		str	r3, [sp, #12]
 792 04a0 FB6E     		ldr	r3, [r7, #108]
 793 04a2 0293     		str	r3, [sp, #8]
 794 04a4 0A23     		movs	r3, #10
 795 04a6 0193     		str	r3, [sp, #4]
 796 04a8 0023     		movs	r3, #0
 797 04aa 0093     		str	r3, [sp]
 798 04ac 0023     		movs	r3, #0
 799 04ae 2246     		mov	r2, r4
 800 04b0 FFF7FEFF 		bl	openoscoap_construct_aad
 801 04b4 0346     		mov	r3, r0
 802 04b6 87F85C30 		strb	r3, [r7, #92]
 370:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             version,
 371:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             code,
 372:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             NULL,
 373:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             0, // do not support Class I options at the moment
 374:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 375:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             requestKid,
 376:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             requestKidLen,
 377:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             requestSeq,
 378:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             requestSeqLen);
 379:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 380:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (aadLen > AAD_MAX_LEN) {
 803              		.loc 1 380 0
 804 04ba 97F85C30 		ldrb	r3, [r7, #92]	@ zero_extendqisi2
 805 04be 1F2B     		cmp	r3, #31
 806 04c0 07D9     		bls	.L32
 381:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         // corruption
 382:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         openserial_printError(
 807              		.loc 1 382 0
 808 04c2 0023     		movs	r3, #0
 809 04c4 0022     		movs	r2, #0
 810 04c6 4621     		movs	r1, #70
 811 04c8 2C20     		movs	r0, #44
 812 04ca FFF7FEFF 		bl	openserial_printError
 383:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_BUFFER_OVERFLOW,
 384:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0,
 385:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0
 386:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         );
 387:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return E_FAIL;
 813              		.loc 1 387 0
 814 04ce 0123     		movs	r3, #1
 815 04d0 7BE0     		b	.L39
 816              	.L32:
 388:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 389:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****  
 390:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // construct nonce 
 391:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (is_request(code)) {
 817              		.loc 1 391 0
 818 04d2 BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 819 04d4 1846     		mov	r0, r3
 820 04d6 FFF7FEFF 		bl	is_request
 821 04da 0346     		mov	r3, r0
 822 04dc 002B     		cmp	r3, #0
 823 04de 0AD0     		beq	.L33
 392:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         xor_arrays(context->recipientIV, partialIV, nonce, AES_CCM_16_64_128_IV_LEN); 
 824              		.loc 1 392 0
 825 04e0 FB68     		ldr	r3, [r7, #12]
 826 04e2 03F14700 		add	r0, r3, #71
 827 04e6 07F14C02 		add	r2, r7, #76
 828 04ea 07F13C01 		add	r1, r7, #60
 829 04ee 0D23     		movs	r3, #13
 830 04f0 FFF7FEFF 		bl	xor_arrays
 831 04f4 10E0     		b	.L34
 832              	.L33:
 393:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 394:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 395:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         flip_first_bit(context->recipientIV, nonce, AES_CCM_16_64_128_IV_LEN);
 833              		.loc 1 395 0
 834 04f6 FB68     		ldr	r3, [r7, #12]
 835 04f8 4733     		adds	r3, r3, #71
 836 04fa 07F14C01 		add	r1, r7, #76
 837 04fe 0D22     		movs	r2, #13
 838 0500 1846     		mov	r0, r3
 839 0502 FFF7FEFF 		bl	flip_first_bit
 396:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         xor_arrays(nonce, partialIV, nonce, AES_CCM_16_64_128_IV_LEN);
 840              		.loc 1 396 0
 841 0506 07F14C02 		add	r2, r7, #76
 842 050a 07F13C01 		add	r1, r7, #60
 843 050e 07F14C00 		add	r0, r7, #76
 844 0512 0D23     		movs	r3, #13
 845 0514 FFF7FEFF 		bl	xor_arrays
 846              	.L34:
 397:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 398:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     
 399:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     decStatus = cryptoengine_aes_ccms_dec(aad,
 400:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                     aadLen,
 401:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                     ciphertext,
 402:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                     &ciphertextLen,
 403:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                     nonce,
 404:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                     2,
 405:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                     context->recipientKey,
 847              		.loc 1 405 0
 848 0518 FB68     		ldr	r3, [r7, #12]
 849 051a 3733     		adds	r3, r3, #55
 399:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                     aadLen,
 850              		.loc 1 399 0
 851 051c 07F11704 		add	r4, r7, #23
 852 0520 97F85C10 		ldrb	r1, [r7, #92]	@ zero_extendqisi2
 853 0524 07F11800 		add	r0, r7, #24
 854 0528 0822     		movs	r2, #8
 855 052a 0392     		str	r2, [sp, #12]
 856 052c 0293     		str	r3, [sp, #8]
 857 052e 0223     		movs	r3, #2
 858 0530 0193     		str	r3, [sp, #4]
 859 0532 07F14C03 		add	r3, r7, #76
 860 0536 0093     		str	r3, [sp]
 861 0538 2346     		mov	r3, r4
 862 053a 3A6E     		ldr	r2, [r7, #96]
 863 053c FFF7FEFF 		bl	cryptoengine_aes_ccms_dec
 864 0540 0346     		mov	r3, r0
 865 0542 87F85B30 		strb	r3, [r7, #91]
 406:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                                     AES_CCM_16_64_128_TAG_LEN);
 407:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 408:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (decStatus != E_SUCCESS) {
 866              		.loc 1 408 0
 867 0546 97F85B30 		ldrb	r3, [r7, #91]	@ zero_extendqisi2
 868 054a 002B     		cmp	r3, #0
 869 054c 07D0     		beq	.L35
 409:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         openserial_printError(
 870              		.loc 1 409 0
 871 054e 0023     		movs	r3, #0
 872 0550 0022     		movs	r2, #0
 873 0552 4821     		movs	r1, #72
 874 0554 2C20     		movs	r0, #44
 875 0556 FFF7FEFF 		bl	openserial_printError
 410:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_DECRYPTION_FAILED,
 411:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0,
 412:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0
 413:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         );
 414:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return E_FAIL;
 876              		.loc 1 414 0
 877 055a 0123     		movs	r3, #1
 878 055c 35E0     		b	.L39
 879              	.L35:
 415:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 416:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 417:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (is_request(code)) {
 880              		.loc 1 417 0
 881 055e BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 882 0560 1846     		mov	r0, r3
 883 0562 FFF7FEFF 		bl	is_request
 884 0566 0346     		mov	r3, r0
 885 0568 002B     		cmp	r3, #0
 886 056a 05D0     		beq	.L36
 418:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         replay_window_update(context, sequenceNumber);
 887              		.loc 1 418 0
 888 056c B7F88830 		ldrh	r3, [r7, #136]
 889 0570 1946     		mov	r1, r3
 890 0572 F868     		ldr	r0, [r7, #12]
 891 0574 FFF7FEFF 		bl	replay_window_update
 892              	.L36:
 419:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 420:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 421:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (payloadInObjSec) {
 893              		.loc 1 421 0
 894 0578 97F85F30 		ldrb	r3, [r7, #95]	@ zero_extendqisi2
 895 057c 002B     		cmp	r3, #0
 896 057e 09D0     		beq	.L37
 422:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         opencoap_options_parse(objectSecurity->pValue, objectSecurity->length, incomingOptions, inc
 897              		.loc 1 422 0
 898 0580 7B6E     		ldr	r3, [r7, #100]
 899 0582 5868     		ldr	r0, [r3, #4]
 900 0584 7B6E     		ldr	r3, [r7, #100]
 901 0586 5978     		ldrb	r1, [r3, #1]	@ zero_extendqisi2
 902 0588 D7F88030 		ldr	r3, [r7, #128]
 903 058c 7A68     		ldr	r2, [r7, #4]
 904 058e FFF7FEFF 		bl	opencoap_options_parse
 905 0592 19E0     		b	.L38
 906              	.L37:
 423:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 424:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 425:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         packetfunctions_tossFooter(msg, AES_CCM_16_64_128_TAG_LEN);
 907              		.loc 1 425 0
 908 0594 0821     		movs	r1, #8
 909 0596 D7F88400 		ldr	r0, [r7, #132]
 910 059a FFF7FEFF 		bl	packetfunctions_tossFooter
 426:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         index = opencoap_options_parse(&msg->payload[0], msg->length, incomingOptions, incomingOpti
 911              		.loc 1 426 0
 912 059e D7F88430 		ldr	r3, [r7, #132]
 913 05a2 5868     		ldr	r0, [r3, #4]
 914 05a4 D7F88430 		ldr	r3, [r7, #132]
 915 05a8 197A     		ldrb	r1, [r3, #8]	@ zero_extendqisi2
 916 05aa D7F88030 		ldr	r3, [r7, #128]
 917 05ae 7A68     		ldr	r2, [r7, #4]
 918 05b0 FFF7FEFF 		bl	opencoap_options_parse
 919 05b4 0346     		mov	r3, r0
 920 05b6 87F85A30 		strb	r3, [r7, #90]
 427:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         packetfunctions_tossHeader(msg, index);
 921              		.loc 1 427 0
 922 05ba 97F85A30 		ldrb	r3, [r7, #90]	@ zero_extendqisi2
 923 05be 1946     		mov	r1, r3
 924 05c0 D7F88400 		ldr	r0, [r7, #132]
 925 05c4 FFF7FEFF 		bl	packetfunctions_tossHeader
 926              	.L38:
 428:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 429:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 430:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     return E_SUCCESS;
 927              		.loc 1 430 0
 928 05c8 0023     		movs	r3, #0
 929              	.L39:
 431:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 930              		.loc 1 431 0 discriminator 1
 931 05ca 1846     		mov	r0, r3
 932 05cc 7437     		adds	r7, r7, #116
 933              		.cfi_def_cfa_offset 12
 934 05ce BD46     		mov	sp, r7
 935              		.cfi_def_cfa_register 13
 936              		@ sp needed
 937 05d0 90BD     		pop	{r4, r7, pc}
 938              		.cfi_endproc
 939              	.LFE2:
 941 05d2 00BF     		.align	2
 942              		.global	openoscoap_get_sequence_number
 943              		.thumb
 944              		.thumb_func
 946              	openoscoap_get_sequence_number:
 947              	.LFB3:
 432:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 433:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** uint16_t openoscoap_get_sequence_number(oscoap_security_context_t *context) {
 948              		.loc 1 433 0
 949              		.cfi_startproc
 950              		@ args = 0, pretend = 0, frame = 8
 951              		@ frame_needed = 1, uses_anonymous_args = 0
 952 05d4 80B5     		push	{r7, lr}
 953              		.cfi_def_cfa_offset 8
 954              		.cfi_offset 7, -8
 955              		.cfi_offset 14, -4
 956 05d6 82B0     		sub	sp, sp, #8
 957              		.cfi_def_cfa_offset 16
 958 05d8 00AF     		add	r7, sp, #0
 959              		.cfi_def_cfa_register 7
 960 05da 7860     		str	r0, [r7, #4]
 434:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (context->sequenceNumber == 0xffff) {
 961              		.loc 1 434 0
 962 05dc 7B68     		ldr	r3, [r7, #4]
 963 05de 5B8D     		ldrh	r3, [r3, #42]
 964 05e0 4FF6FF72 		movw	r2, #65535
 965 05e4 9342     		cmp	r3, r2
 966 05e6 06D1     		bne	.L41
 435:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         openserial_printError(
 967              		.loc 1 435 0
 968 05e8 0023     		movs	r3, #0
 969 05ea 0022     		movs	r2, #0
 970 05ec 4521     		movs	r1, #69
 971 05ee 2C20     		movs	r0, #44
 972 05f0 FFF7FEFF 		bl	openserial_printError
 973 05f4 05E0     		b	.L42
 974              	.L41:
 436:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_SEQUENCE_NUMBER_OVERFLOW,
 437:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0,
 438:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0
 439:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****       );
 440:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     } else {
 441:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         context->sequenceNumber++;
 975              		.loc 1 441 0
 976 05f6 7B68     		ldr	r3, [r7, #4]
 977 05f8 5B8D     		ldrh	r3, [r3, #42]
 978 05fa 0133     		adds	r3, r3, #1
 979 05fc 9AB2     		uxth	r2, r3
 980 05fe 7B68     		ldr	r3, [r7, #4]
 981 0600 5A85     		strh	r2, [r3, #42]	@ movhi
 982              	.L42:
 442:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 443:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     return context->sequenceNumber;
 983              		.loc 1 443 0
 984 0602 7B68     		ldr	r3, [r7, #4]
 985 0604 5B8D     		ldrh	r3, [r3, #42]
 444:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 986              		.loc 1 444 0
 987 0606 1846     		mov	r0, r3
 988 0608 0837     		adds	r7, r7, #8
 989              		.cfi_def_cfa_offset 8
 990 060a BD46     		mov	sp, r7
 991              		.cfi_def_cfa_register 13
 992              		@ sp needed
 993 060c 80BD     		pop	{r7, pc}
 994              		.cfi_endproc
 995              	.LFE3:
 997 060e 00BF     		.align	2
 998              		.global	openoscoap_parse_compressed_COSE
 999              		.thumb
 1000              		.thumb_func
 1002              	openoscoap_parse_compressed_COSE:
 1003              	.LFB4:
 445:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 446:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** uint8_t openoscoap_parse_compressed_COSE(uint8_t *buffer,
 447:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t bufferLen,
 448:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint16_t* sequenceNumber,
 449:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t** kid,
 450:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* kidLen
 451:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         ) {
 1004              		.loc 1 451 0
 1005              		.cfi_startproc
 1006              		@ args = 4, pretend = 0, frame = 24
 1007              		@ frame_needed = 1, uses_anonymous_args = 0
 1008 0610 80B5     		push	{r7, lr}
 1009              		.cfi_def_cfa_offset 8
 1010              		.cfi_offset 7, -8
 1011              		.cfi_offset 14, -4
 1012 0612 86B0     		sub	sp, sp, #24
 1013              		.cfi_def_cfa_offset 32
 1014 0614 00AF     		add	r7, sp, #0
 1015              		.cfi_def_cfa_register 7
 1016 0616 F860     		str	r0, [r7, #12]
 1017 0618 7A60     		str	r2, [r7, #4]
 1018 061a 3B60     		str	r3, [r7]
 1019 061c 0B46     		mov	r3, r1
 1020 061e FB72     		strb	r3, [r7, #11]
 452:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t index;
 453:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t pivsz;
 454:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t k;
 455:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t reserved;
 456:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 457:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     index = 0;
 1021              		.loc 1 457 0
 1022 0620 0023     		movs	r3, #0
 1023 0622 FB75     		strb	r3, [r7, #23]
 458:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     pivsz = (buffer[index] >> 0) & 0x07;
 1024              		.loc 1 458 0
 1025 0624 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1026 0626 FA68     		ldr	r2, [r7, #12]
 1027 0628 1344     		add	r3, r3, r2
 1028 062a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1029 062c 03F00703 		and	r3, r3, #7
 1030 0630 BB75     		strb	r3, [r7, #22]
 459:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     k = (buffer[index] >> 3) & 0x01;
 1031              		.loc 1 459 0
 1032 0632 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1033 0634 FA68     		ldr	r2, [r7, #12]
 1034 0636 1344     		add	r3, r3, r2
 1035 0638 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1036 063a DB08     		lsrs	r3, r3, #3
 1037 063c DBB2     		uxtb	r3, r3
 1038 063e 03F00103 		and	r3, r3, #1
 1039 0642 7B75     		strb	r3, [r7, #21]
 460:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     reserved = (buffer[index] >> 4) & 0x0f;
 1040              		.loc 1 460 0
 1041 0644 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1042 0646 FA68     		ldr	r2, [r7, #12]
 1043 0648 1344     		add	r3, r3, r2
 1044 064a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1045 064c 1B09     		lsrs	r3, r3, #4
 1046 064e 3B75     		strb	r3, [r7, #20]
 461:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 462:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (reserved) {
 1047              		.loc 1 462 0
 1048 0650 3B7D     		ldrb	r3, [r7, #20]	@ zero_extendqisi2
 1049 0652 002B     		cmp	r3, #0
 1050 0654 01D0     		beq	.L45
 463:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return 0;
 1051              		.loc 1 463 0
 1052 0656 0023     		movs	r3, #0
 1053 0658 42E0     		b	.L46
 1054              	.L45:
 464:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 465:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 466:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     index++;
 1055              		.loc 1 466 0
 1056 065a FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1057 065c 0133     		adds	r3, r3, #1
 1058 065e FB75     		strb	r3, [r7, #23]
 467:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 468:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (pivsz > 2) {
 1059              		.loc 1 468 0
 1060 0660 BB7D     		ldrb	r3, [r7, #22]	@ zero_extendqisi2
 1061 0662 022B     		cmp	r3, #2
 1062 0664 01D9     		bls	.L47
 469:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return 0;
 1063              		.loc 1 469 0
 1064 0666 0023     		movs	r3, #0
 1065 0668 3AE0     		b	.L46
 1066              	.L47:
 470:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 471:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else if (pivsz == 1) {
 1067              		.loc 1 471 0
 1068 066a BB7D     		ldrb	r3, [r7, #22]	@ zero_extendqisi2
 1069 066c 012B     		cmp	r3, #1
 1070 066e 0AD1     		bne	.L48
 472:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         *sequenceNumber = buffer[index];
 1071              		.loc 1 472 0
 1072 0670 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1073 0672 FA68     		ldr	r2, [r7, #12]
 1074 0674 1344     		add	r3, r3, r2
 1075 0676 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1076 0678 9AB2     		uxth	r2, r3
 1077 067a 7B68     		ldr	r3, [r7, #4]
 1078 067c 1A80     		strh	r2, [r3]	@ movhi
 473:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         index++;
 1079              		.loc 1 473 0
 1080 067e FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1081 0680 0133     		adds	r3, r3, #1
 1082 0682 FB75     		strb	r3, [r7, #23]
 1083 0684 0FE0     		b	.L49
 1084              	.L48:
 474:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 475:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else if (pivsz == 2) {
 1085              		.loc 1 475 0
 1086 0686 BB7D     		ldrb	r3, [r7, #22]	@ zero_extendqisi2
 1087 0688 022B     		cmp	r3, #2
 1088 068a 0CD1     		bne	.L49
 476:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         *sequenceNumber = packetfunctions_ntohs(&buffer[index]);
 1089              		.loc 1 476 0
 1090 068c FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1091 068e FA68     		ldr	r2, [r7, #12]
 1092 0690 1344     		add	r3, r3, r2
 1093 0692 1846     		mov	r0, r3
 1094 0694 FFF7FEFF 		bl	packetfunctions_ntohs
 1095 0698 0346     		mov	r3, r0
 1096 069a 1A46     		mov	r2, r3
 1097 069c 7B68     		ldr	r3, [r7, #4]
 1098 069e 1A80     		strh	r2, [r3]	@ movhi
 477:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         index += 2;
 1099              		.loc 1 477 0
 1100 06a0 FB7D     		ldrb	r3, [r7, #23]
 1101 06a2 0233     		adds	r3, r3, #2
 1102 06a4 FB75     		strb	r3, [r7, #23]
 1103              	.L49:
 478:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 479:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 480:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (k) {
 1104              		.loc 1 480 0
 1105 06a6 7B7D     		ldrb	r3, [r7, #21]	@ zero_extendqisi2
 1106 06a8 002B     		cmp	r3, #0
 1107 06aa 12D0     		beq	.L50
 481:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         *kidLen = buffer[index];
 1108              		.loc 1 481 0
 1109 06ac FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1110 06ae FA68     		ldr	r2, [r7, #12]
 1111 06b0 1344     		add	r3, r3, r2
 1112 06b2 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1113 06b4 3B6A     		ldr	r3, [r7, #32]
 1114 06b6 1A70     		strb	r2, [r3]
 482:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         index++;
 1115              		.loc 1 482 0
 1116 06b8 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1117 06ba 0133     		adds	r3, r3, #1
 1118 06bc FB75     		strb	r3, [r7, #23]
 483:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         *kid = &buffer[index];
 1119              		.loc 1 483 0
 1120 06be FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1121 06c0 FA68     		ldr	r2, [r7, #12]
 1122 06c2 1A44     		add	r2, r2, r3
 1123 06c4 3B68     		ldr	r3, [r7]
 1124 06c6 1A60     		str	r2, [r3]
 484:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         index += *kidLen;
 1125              		.loc 1 484 0
 1126 06c8 3B6A     		ldr	r3, [r7, #32]
 1127 06ca 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1128 06cc FB7D     		ldrb	r3, [r7, #23]
 1129 06ce 1344     		add	r3, r3, r2
 1130 06d0 FB75     		strb	r3, [r7, #23]
 1131              	.L50:
 485:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 486:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 487:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (index > bufferLen) {
 1132              		.loc 1 487 0
 1133 06d2 FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 1134 06d4 FB7A     		ldrb	r3, [r7, #11]	@ zero_extendqisi2
 1135 06d6 9A42     		cmp	r2, r3
 1136 06d8 01D9     		bls	.L51
 488:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return 0; 
 1137              		.loc 1 488 0
 1138 06da 0023     		movs	r3, #0
 1139 06dc 00E0     		b	.L46
 1140              	.L51:
 489:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 490:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 491:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     return index;
 1141              		.loc 1 491 0
 1142 06de FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1143              	.L46:
 492:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 1144              		.loc 1 492 0
 1145 06e0 1846     		mov	r0, r3
 1146 06e2 1837     		adds	r7, r7, #24
 1147              		.cfi_def_cfa_offset 8
 1148 06e4 BD46     		mov	sp, r7
 1149              		.cfi_def_cfa_register 13
 1150              		@ sp needed
 1151 06e6 80BD     		pop	{r7, pc}
 1152              		.cfi_endproc
 1153              	.LFE4:
 1155              		.section	.rodata
 1156              		.align	2
 1157              	.LC0:
 1158 0080 495600   		.ascii	"IV\000"
 1159              		.text
 1160              		.align	2
 1161              		.global	hkdf_derive_parameter
 1162              		.thumb
 1163              		.thumb_func
 1165              	hkdf_derive_parameter:
 1166              	.LFB5:
 493:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 494:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 495:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** //=========================== private =========================================
 496:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 497:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** owerror_t hkdf_derive_parameter(uint8_t* buffer,
 498:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* masterSecret, 
 499:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t masterSecretLen, 
 500:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* masterSalt,
 501:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t masterSaltLen,
 502:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* identifier,
 503:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t identifierLen,
 504:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t algorithm,
 505:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         oscoap_derivation_t type,
 506:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t length
 507:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         ){
 1167              		.loc 1 507 0
 1168              		.cfi_startproc
 1169              		@ args = 24, pretend = 0, frame = 56
 1170              		@ frame_needed = 1, uses_anonymous_args = 0
 1171 06e8 80B5     		push	{r7, lr}
 1172              		.cfi_def_cfa_offset 8
 1173              		.cfi_offset 7, -8
 1174              		.cfi_offset 14, -4
 1175 06ea 94B0     		sub	sp, sp, #80
 1176              		.cfi_def_cfa_offset 88
 1177 06ec 06AF     		add	r7, sp, #24
 1178              		.cfi_def_cfa 7, 64
 1179 06ee F860     		str	r0, [r7, #12]
 1180 06f0 B960     		str	r1, [r7, #8]
 1181 06f2 3B60     		str	r3, [r7]
 1182 06f4 1346     		mov	r3, r2
 1183 06f6 FB71     		strb	r3, [r7, #7]
 508:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****    
 509:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     const uint8_t iv[] = "IV";
 1184              		.loc 1 509 0
 1185 06f8 4B4A     		ldr	r2, .L59
 1186 06fa 07F13003 		add	r3, r7, #48
 1187 06fe 1268     		ldr	r2, [r2]
 1188 0700 1146     		mov	r1, r2	@ movhi
 1189 0702 1980     		strh	r1, [r3]	@ movhi
 1190 0704 0233     		adds	r3, r3, #2
 1191 0706 120C     		lsrs	r2, r2, #16
 1192 0708 1A70     		strb	r2, [r3]
 510:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     const uint8_t key[] = "Key";
 1193              		.loc 1 510 0
 1194 070a 484B     		ldr	r3, .L59+4
 1195 070c FB62     		str	r3, [r7, #44]
 511:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t info[20];
 512:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t infoLen;
 513:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t *temp;
 514:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t ret;
 515:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 516:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     temp = info;
 1196              		.loc 1 516 0
 1197 070e 07F11803 		add	r3, r7, #24
 1198 0712 7B61     		str	r3, [r7, #20]
 517:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 518:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     infoLen = 0;
 1199              		.loc 1 518 0
 1200 0714 0023     		movs	r3, #0
 1201 0716 87F83730 		strb	r3, [r7, #55]
 519:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     infoLen += cborencoder_put_array(&temp, 4);
 1202              		.loc 1 519 0
 1203 071a 07F11403 		add	r3, r7, #20
 1204 071e 0421     		movs	r1, #4
 1205 0720 1846     		mov	r0, r3
 1206 0722 FFF7FEFF 		bl	cborencoder_put_array
 1207 0726 0346     		mov	r3, r0
 1208 0728 1A46     		mov	r2, r3
 1209 072a 97F83730 		ldrb	r3, [r7, #55]
 1210 072e 1344     		add	r3, r3, r2
 1211 0730 87F83730 		strb	r3, [r7, #55]
 520:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     infoLen += cborencoder_put_bytes(&temp, identifierLen, identifier);
 1212              		.loc 1 520 0
 1213 0734 97F84810 		ldrb	r1, [r7, #72]	@ zero_extendqisi2
 1214 0738 07F11403 		add	r3, r7, #20
 1215 073c 7A6C     		ldr	r2, [r7, #68]
 1216 073e 1846     		mov	r0, r3
 1217 0740 FFF7FEFF 		bl	cborencoder_put_bytes
 1218 0744 0346     		mov	r3, r0
 1219 0746 1A46     		mov	r2, r3
 1220 0748 97F83730 		ldrb	r3, [r7, #55]
 1221 074c 1344     		add	r3, r3, r2
 1222 074e 87F83730 		strb	r3, [r7, #55]
 521:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     infoLen += cborencoder_put_unsigned(&temp, algorithm);
 1223              		.loc 1 521 0
 1224 0752 97F84C20 		ldrb	r2, [r7, #76]	@ zero_extendqisi2
 1225 0756 07F11403 		add	r3, r7, #20
 1226 075a 1146     		mov	r1, r2
 1227 075c 1846     		mov	r0, r3
 1228 075e FFF7FEFF 		bl	cborencoder_put_unsigned
 1229 0762 0346     		mov	r3, r0
 1230 0764 1A46     		mov	r2, r3
 1231 0766 97F83730 		ldrb	r3, [r7, #55]
 1232 076a 1344     		add	r3, r3, r2
 1233 076c 87F83730 		strb	r3, [r7, #55]
 522:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 523:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (type == OSCOAP_DERIVATION_TYPE_KEY) {
 1234              		.loc 1 523 0
 1235 0770 97F85030 		ldrb	r3, [r7, #80]	@ zero_extendqisi2
 1236 0774 002B     		cmp	r3, #0
 1237 0776 0FD1     		bne	.L53
 524:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         infoLen += cborencoder_put_text(&temp, (char *) key, sizeof(key)-1);
 1238              		.loc 1 524 0
 1239 0778 07F12C01 		add	r1, r7, #44
 1240 077c 07F11403 		add	r3, r7, #20
 1241 0780 0322     		movs	r2, #3
 1242 0782 1846     		mov	r0, r3
 1243 0784 FFF7FEFF 		bl	cborencoder_put_text
 1244 0788 0346     		mov	r3, r0
 1245 078a 1A46     		mov	r2, r3
 1246 078c 97F83730 		ldrb	r3, [r7, #55]
 1247 0790 1344     		add	r3, r3, r2
 1248 0792 87F83730 		strb	r3, [r7, #55]
 1249 0796 15E0     		b	.L54
 1250              	.L53:
 525:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     } 
 526:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else if (type == OSCOAP_DERIVATION_TYPE_IV) {
 1251              		.loc 1 526 0
 1252 0798 97F85030 		ldrb	r3, [r7, #80]	@ zero_extendqisi2
 1253 079c 012B     		cmp	r3, #1
 1254 079e 0FD1     		bne	.L55
 527:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         infoLen += cborencoder_put_text(&temp, (char *) iv, sizeof(iv)-1);
 1255              		.loc 1 527 0
 1256 07a0 07F13001 		add	r1, r7, #48
 1257 07a4 07F11403 		add	r3, r7, #20
 1258 07a8 0222     		movs	r2, #2
 1259 07aa 1846     		mov	r0, r3
 1260 07ac FFF7FEFF 		bl	cborencoder_put_text
 1261 07b0 0346     		mov	r3, r0
 1262 07b2 1A46     		mov	r2, r3
 1263 07b4 97F83730 		ldrb	r3, [r7, #55]
 1264 07b8 1344     		add	r3, r3, r2
 1265 07ba 87F83730 		strb	r3, [r7, #55]
 1266 07be 01E0     		b	.L54
 1267              	.L55:
 528:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 529:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 530:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return E_FAIL;
 1268              		.loc 1 530 0
 1269 07c0 0123     		movs	r3, #1
 1270 07c2 2DE0     		b	.L58
 1271              	.L54:
 531:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 532:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     
 533:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     infoLen += cborencoder_put_unsigned(&temp, length);
 1272              		.loc 1 533 0
 1273 07c4 97F85420 		ldrb	r2, [r7, #84]	@ zero_extendqisi2
 1274 07c8 07F11403 		add	r3, r7, #20
 1275 07cc 1146     		mov	r1, r2
 1276 07ce 1846     		mov	r0, r3
 1277 07d0 FFF7FEFF 		bl	cborencoder_put_unsigned
 1278 07d4 0346     		mov	r3, r0
 1279 07d6 1A46     		mov	r2, r3
 1280 07d8 97F83730 		ldrb	r3, [r7, #55]
 1281 07dc 1344     		add	r3, r3, r2
 1282 07de 87F83730 		strb	r3, [r7, #55]
 534:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 535:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ret = hkdf(SHA256, masterSalt, masterSaltLen, masterSecret, masterSecretLen, info, infoLen, buf
 1283              		.loc 1 535 0
 1284 07e2 97F84000 		ldrb	r0, [r7, #64]	@ zero_extendqisi2
 1285 07e6 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1286 07e8 97F83720 		ldrb	r2, [r7, #55]	@ zero_extendqisi2
 1287 07ec 97F85410 		ldrb	r1, [r7, #84]	@ zero_extendqisi2
 1288 07f0 0491     		str	r1, [sp, #16]
 1289 07f2 F968     		ldr	r1, [r7, #12]
 1290 07f4 0391     		str	r1, [sp, #12]
 1291 07f6 0292     		str	r2, [sp, #8]
 1292 07f8 07F11802 		add	r2, r7, #24
 1293 07fc 0192     		str	r2, [sp, #4]
 1294 07fe 0093     		str	r3, [sp]
 1295 0800 BB68     		ldr	r3, [r7, #8]
 1296 0802 0246     		mov	r2, r0
 1297 0804 3968     		ldr	r1, [r7]
 1298 0806 0220     		movs	r0, #2
 1299 0808 FFF7FEFF 		bl	hkdf
 1300 080c 0346     		mov	r3, r0
 1301 080e 87F83630 		strb	r3, [r7, #54]
 536:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 537:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (ret == shaSuccess) {
 1302              		.loc 1 537 0
 1303 0812 97F83630 		ldrb	r3, [r7, #54]	@ zero_extendqisi2
 1304 0816 002B     		cmp	r3, #0
 1305 0818 01D1     		bne	.L57
 538:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return E_SUCCESS;
 1306              		.loc 1 538 0
 1307 081a 0023     		movs	r3, #0
 1308 081c 00E0     		b	.L58
 1309              	.L57:
 539:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 540:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     return E_FAIL;
 1310              		.loc 1 540 0
 1311 081e 0123     		movs	r3, #1
 1312              	.L58:
 541:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 1313              		.loc 1 541 0 discriminator 1
 1314 0820 1846     		mov	r0, r3
 1315 0822 3837     		adds	r7, r7, #56
 1316              		.cfi_def_cfa_offset 8
 1317 0824 BD46     		mov	sp, r7
 1318              		.cfi_def_cfa_register 13
 1319              		@ sp needed
 1320 0826 80BD     		pop	{r7, pc}
 1321              	.L60:
 1322              		.align	2
 1323              	.L59:
 1324 0828 80000000 		.word	.LC0
 1325 082c 4B657900 		.word	7955787
 1326              		.cfi_endproc
 1327              	.LFE5:
 1329              		.align	2
 1330              		.global	is_request
 1331              		.thumb
 1332              		.thumb_func
 1334              	is_request:
 1335              	.LFB6:
 542:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 543:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** bool is_request(uint8_t code) {
 1336              		.loc 1 543 0
 1337              		.cfi_startproc
 1338              		@ args = 0, pretend = 0, frame = 8
 1339              		@ frame_needed = 1, uses_anonymous_args = 0
 1340              		@ link register save eliminated.
 1341 0830 80B4     		push	{r7}
 1342              		.cfi_def_cfa_offset 4
 1343              		.cfi_offset 7, -4
 1344 0832 83B0     		sub	sp, sp, #12
 1345              		.cfi_def_cfa_offset 16
 1346 0834 00AF     		add	r7, sp, #0
 1347              		.cfi_def_cfa_register 7
 1348 0836 0346     		mov	r3, r0
 1349 0838 FB71     		strb	r3, [r7, #7]
 544:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****    if ( code == (uint8_t) COAP_CODE_REQ_GET     ||
 1350              		.loc 1 544 0
 1351 083a FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1352 083c 012B     		cmp	r3, #1
 1353 083e 08D0     		beq	.L62
 1354              		.loc 1 544 0 is_stmt 0 discriminator 1
 1355 0840 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1356 0842 022B     		cmp	r3, #2
 1357 0844 05D0     		beq	.L62
 545:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         code == (uint8_t) COAP_CODE_REQ_POST    ||
 1358              		.loc 1 545 0 is_stmt 1
 1359 0846 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1360 0848 032B     		cmp	r3, #3
 1361 084a 02D0     		beq	.L62
 546:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         code == (uint8_t) COAP_CODE_REQ_PUT     ||
 1362              		.loc 1 546 0
 1363 084c FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1364 084e 042B     		cmp	r3, #4
 1365 0850 01D1     		bne	.L63
 1366              	.L62:
 547:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         code == (uint8_t) COAP_CODE_REQ_DELETE) {
 548:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return TRUE;
 1367              		.loc 1 548 0
 1368 0852 0123     		movs	r3, #1
 1369 0854 00E0     		b	.L64
 1370              	.L63:
 549:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****    }
 550:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****    else {
 551:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return FALSE;
 1371              		.loc 1 551 0
 1372 0856 0023     		movs	r3, #0
 1373              	.L64:
 552:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****    }
 553:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 1374              		.loc 1 553 0
 1375 0858 1846     		mov	r0, r3
 1376 085a 0C37     		adds	r7, r7, #12
 1377              		.cfi_def_cfa_offset 4
 1378 085c BD46     		mov	sp, r7
 1379              		.cfi_def_cfa_register 13
 1380              		@ sp needed
 1381 085e 80BC     		pop	{r7}
 1382              		.cfi_restore 7
 1383              		.cfi_def_cfa_offset 0
 1384 0860 7047     		bx	lr
 1385              		.cfi_endproc
 1386              	.LFE6:
 1388              		.section	.rodata
 1389 0083 00       		.align	2
 1390              	.LC1:
 1391 0084 456E6372 		.ascii	"Encrypt0\000"
 1391      79707430 
 1391      00
 1392              		.text
 1393 0862 00BF     		.align	2
 1394              		.global	openoscoap_construct_aad
 1395              		.thumb
 1396              		.thumb_func
 1398              	openoscoap_construct_aad:
 1399              	.LFB7:
 554:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 555:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** uint8_t openoscoap_construct_aad(uint8_t* buffer, 
 556:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t version, 
 557:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t code,
 558:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* optionsSerialized,
 559:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t optionsSerializedLen,
 560:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t aeadAlgorithm,
 561:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* requestKid,
 562:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t requestKidLen,
 563:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* requestSeq,
 564:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t requestSeqLen
 565:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         ) {
 1400              		.loc 1 565 0
 1401              		.cfi_startproc
 1402              		@ args = 24, pretend = 0, frame = 56
 1403              		@ frame_needed = 1, uses_anonymous_args = 0
 1404 0864 80B5     		push	{r7, lr}
 1405              		.cfi_def_cfa_offset 8
 1406              		.cfi_offset 7, -8
 1407              		.cfi_offset 14, -4
 1408 0866 8EB0     		sub	sp, sp, #56
 1409              		.cfi_def_cfa_offset 64
 1410 0868 00AF     		add	r7, sp, #0
 1411              		.cfi_def_cfa_register 7
 1412 086a F860     		str	r0, [r7, #12]
 1413 086c 7B60     		str	r3, [r7, #4]
 1414 086e 0B46     		mov	r3, r1
 1415 0870 FB72     		strb	r3, [r7, #11]
 1416 0872 1346     		mov	r3, r2
 1417 0874 BB72     		strb	r3, [r7, #10]
 566:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t* ptr;
 567:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t externalAAD[EAAD_MAX_LEN];
 568:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t externalAADLen;
 569:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t ret;
 570:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     const uint8_t encrypt0[] = "Encrypt0";
 1418              		.loc 1 570 0
 1419 0876 614A     		ldr	r2, .L69
 1420 0878 07F11003 		add	r3, r7, #16
 1421 087c 07CA     		ldmia	r2, {r0, r1, r2}
 1422 087e 03C3     		stmia	r3!, {r0, r1}
 1423 0880 1A70     		strb	r2, [r3]
 571:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 572:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ret = 0;
 1424              		.loc 1 572 0
 1425 0882 0023     		movs	r3, #0
 1426 0884 87F83730 		strb	r3, [r7, #55]
 573:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     externalAADLen = 0;
 1427              		.loc 1 573 0
 1428 0888 0023     		movs	r3, #0
 1429 088a 87F83630 		strb	r3, [r7, #54]
 574:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 575:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ptr = externalAAD;
 1430              		.loc 1 575 0
 1431 088e 07F11C03 		add	r3, r7, #28
 1432 0892 3B63     		str	r3, [r7, #48]
 576:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_array(&ptr, 6);
 1433              		.loc 1 576 0
 1434 0894 07F13003 		add	r3, r7, #48
 1435 0898 0621     		movs	r1, #6
 1436 089a 1846     		mov	r0, r3
 1437 089c FFF7FEFF 		bl	cborencoder_put_array
 1438 08a0 0346     		mov	r3, r0
 1439 08a2 1A46     		mov	r2, r3
 1440 08a4 97F83630 		ldrb	r3, [r7, #54]
 1441 08a8 1344     		add	r3, r3, r2
 1442 08aa 87F83630 		strb	r3, [r7, #54]
 577:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_unsigned(&ptr, version);
 1443              		.loc 1 577 0
 1444 08ae FA7A     		ldrb	r2, [r7, #11]	@ zero_extendqisi2
 1445 08b0 07F13003 		add	r3, r7, #48
 1446 08b4 1146     		mov	r1, r2
 1447 08b6 1846     		mov	r0, r3
 1448 08b8 FFF7FEFF 		bl	cborencoder_put_unsigned
 1449 08bc 0346     		mov	r3, r0
 1450 08be 1A46     		mov	r2, r3
 1451 08c0 97F83630 		ldrb	r3, [r7, #54]
 1452 08c4 1344     		add	r3, r3, r2
 1453 08c6 87F83630 		strb	r3, [r7, #54]
 578:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_unsigned(&ptr, code);
 1454              		.loc 1 578 0
 1455 08ca BA7A     		ldrb	r2, [r7, #10]	@ zero_extendqisi2
 1456 08cc 07F13003 		add	r3, r7, #48
 1457 08d0 1146     		mov	r1, r2
 1458 08d2 1846     		mov	r0, r3
 1459 08d4 FFF7FEFF 		bl	cborencoder_put_unsigned
 1460 08d8 0346     		mov	r3, r0
 1461 08da 1A46     		mov	r2, r3
 1462 08dc 97F83630 		ldrb	r3, [r7, #54]
 1463 08e0 1344     		add	r3, r3, r2
 1464 08e2 87F83630 		strb	r3, [r7, #54]
 579:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_bytes(&ptr, optionsSerializedLen, optionsSerialized);
 1465              		.loc 1 579 0
 1466 08e6 97F84010 		ldrb	r1, [r7, #64]	@ zero_extendqisi2
 1467 08ea 07F13003 		add	r3, r7, #48
 1468 08ee 7A68     		ldr	r2, [r7, #4]
 1469 08f0 1846     		mov	r0, r3
 1470 08f2 FFF7FEFF 		bl	cborencoder_put_bytes
 1471 08f6 0346     		mov	r3, r0
 1472 08f8 1A46     		mov	r2, r3
 1473 08fa 97F83630 		ldrb	r3, [r7, #54]
 1474 08fe 1344     		add	r3, r3, r2
 1475 0900 87F83630 		strb	r3, [r7, #54]
 580:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_unsigned(&ptr, aeadAlgorithm);
 1476              		.loc 1 580 0
 1477 0904 97F84420 		ldrb	r2, [r7, #68]	@ zero_extendqisi2
 1478 0908 07F13003 		add	r3, r7, #48
 1479 090c 1146     		mov	r1, r2
 1480 090e 1846     		mov	r0, r3
 1481 0910 FFF7FEFF 		bl	cborencoder_put_unsigned
 1482 0914 0346     		mov	r3, r0
 1483 0916 1A46     		mov	r2, r3
 1484 0918 97F83630 		ldrb	r3, [r7, #54]
 1485 091c 1344     		add	r3, r3, r2
 1486 091e 87F83630 		strb	r3, [r7, #54]
 581:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_bytes(&ptr, requestKidLen, requestKid);
 1487              		.loc 1 581 0
 1488 0922 97F84C10 		ldrb	r1, [r7, #76]	@ zero_extendqisi2
 1489 0926 07F13003 		add	r3, r7, #48
 1490 092a BA6C     		ldr	r2, [r7, #72]
 1491 092c 1846     		mov	r0, r3
 1492 092e FFF7FEFF 		bl	cborencoder_put_bytes
 1493 0932 0346     		mov	r3, r0
 1494 0934 1A46     		mov	r2, r3
 1495 0936 97F83630 		ldrb	r3, [r7, #54]
 1496 093a 1344     		add	r3, r3, r2
 1497 093c 87F83630 		strb	r3, [r7, #54]
 582:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_bytes(&ptr, requestSeqLen, requestSeq);
 1498              		.loc 1 582 0
 1499 0940 97F85410 		ldrb	r1, [r7, #84]	@ zero_extendqisi2
 1500 0944 07F13003 		add	r3, r7, #48
 1501 0948 3A6D     		ldr	r2, [r7, #80]
 1502 094a 1846     		mov	r0, r3
 1503 094c FFF7FEFF 		bl	cborencoder_put_bytes
 1504 0950 0346     		mov	r3, r0
 1505 0952 1A46     		mov	r2, r3
 1506 0954 97F83630 		ldrb	r3, [r7, #54]
 1507 0958 1344     		add	r3, r3, r2
 1508 095a 87F83630 		strb	r3, [r7, #54]
 583:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 584:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (externalAADLen > EAAD_MAX_LEN) {
 1509              		.loc 1 584 0
 1510 095e 97F83630 		ldrb	r3, [r7, #54]	@ zero_extendqisi2
 1511 0962 132B     		cmp	r3, #19
 1512 0964 07D9     		bls	.L66
 585:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         // corruption
 586:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         openserial_printError(
 1513              		.loc 1 586 0
 1514 0966 0023     		movs	r3, #0
 1515 0968 0022     		movs	r2, #0
 1516 096a 4621     		movs	r1, #70
 1517 096c 2C20     		movs	r0, #44
 1518 096e FFF7FEFF 		bl	openserial_printError
 587:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_BUFFER_OVERFLOW,
 588:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0,
 589:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****                 (errorparameter_t)0
 590:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         );
 591:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return 0;
 1519              		.loc 1 591 0
 1520 0972 0023     		movs	r3, #0
 1521 0974 3DE0     		b	.L68
 1522              	.L66:
 592:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 593:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 594:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ptr = buffer;
 1523              		.loc 1 594 0
 1524 0976 FB68     		ldr	r3, [r7, #12]
 1525 0978 3B63     		str	r3, [r7, #48]
 595:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ret += cborencoder_put_array(&ptr, 3); // COSE Encrypt0 structure with 3 elements
 1526              		.loc 1 595 0
 1527 097a 07F13003 		add	r3, r7, #48
 1528 097e 0321     		movs	r1, #3
 1529 0980 1846     		mov	r0, r3
 1530 0982 FFF7FEFF 		bl	cborencoder_put_array
 1531 0986 0346     		mov	r3, r0
 1532 0988 1A46     		mov	r2, r3
 1533 098a 97F83730 		ldrb	r3, [r7, #55]
 1534 098e 1344     		add	r3, r3, r2
 1535 0990 87F83730 		strb	r3, [r7, #55]
 596:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // first element: "Encrypt0"
 597:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ret += cborencoder_put_text(&ptr, (char *) encrypt0, sizeof(encrypt0) - 1); 
 1536              		.loc 1 597 0
 1537 0994 07F11001 		add	r1, r7, #16
 1538 0998 07F13003 		add	r3, r7, #48
 1539 099c 0822     		movs	r2, #8
 1540 099e 1846     		mov	r0, r3
 1541 09a0 FFF7FEFF 		bl	cborencoder_put_text
 1542 09a4 0346     		mov	r3, r0
 1543 09a6 1A46     		mov	r2, r3
 1544 09a8 97F83730 		ldrb	r3, [r7, #55]
 1545 09ac 1344     		add	r3, r3, r2
 1546 09ae 87F83730 		strb	r3, [r7, #55]
 598:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // second element: empty byte string
 599:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ret += cborencoder_put_bytes(&ptr, 0, NULL); 
 1547              		.loc 1 599 0
 1548 09b2 07F13003 		add	r3, r7, #48
 1549 09b6 0022     		movs	r2, #0
 1550 09b8 0021     		movs	r1, #0
 1551 09ba 1846     		mov	r0, r3
 1552 09bc FFF7FEFF 		bl	cborencoder_put_bytes
 1553 09c0 0346     		mov	r3, r0
 1554 09c2 1A46     		mov	r2, r3
 1555 09c4 97F83730 		ldrb	r3, [r7, #55]
 1556 09c8 1344     		add	r3, r3, r2
 1557 09ca 87F83730 		strb	r3, [r7, #55]
 600:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // third element: external AAD from OSCOAP
 601:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     ret += cborencoder_put_bytes(&ptr, externalAADLen, externalAAD);
 1558              		.loc 1 601 0
 1559 09ce 07F11C02 		add	r2, r7, #28
 1560 09d2 97F83610 		ldrb	r1, [r7, #54]	@ zero_extendqisi2
 1561 09d6 07F13003 		add	r3, r7, #48
 1562 09da 1846     		mov	r0, r3
 1563 09dc FFF7FEFF 		bl	cborencoder_put_bytes
 1564 09e0 0346     		mov	r3, r0
 1565 09e2 1A46     		mov	r2, r3
 1566 09e4 97F83730 		ldrb	r3, [r7, #55]
 1567 09e8 1344     		add	r3, r3, r2
 1568 09ea 87F83730 		strb	r3, [r7, #55]
 602:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     
 603:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     return ret;
 1569              		.loc 1 603 0
 1570 09ee 97F83730 		ldrb	r3, [r7, #55]	@ zero_extendqisi2
 1571              	.L68:
 604:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 1572              		.loc 1 604 0 discriminator 1
 1573 09f2 1846     		mov	r0, r3
 1574 09f4 3837     		adds	r7, r7, #56
 1575              		.cfi_def_cfa_offset 8
 1576 09f6 BD46     		mov	sp, r7
 1577              		.cfi_def_cfa_register 13
 1578              		@ sp needed
 1579 09f8 80BD     		pop	{r7, pc}
 1580              	.L70:
 1581 09fa 00BF     		.align	2
 1582              	.L69:
 1583 09fc 84000000 		.word	.LC1
 1584              		.cfi_endproc
 1585              	.LFE7:
 1587              		.align	2
 1588              		.global	openoscoap_encode_compressed_COSE
 1589              		.thumb
 1590              		.thumb_func
 1592              	openoscoap_encode_compressed_COSE:
 1593              	.LFB8:
 605:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 606:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** void openoscoap_encode_compressed_COSE(OpenQueueEntry_t* msg, 
 607:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* partialIV, uint8_t partialIVLen, 
 608:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t* kid, 
 609:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         uint8_t kidLen) {
 1594              		.loc 1 609 0
 1595              		.cfi_startproc
 1596              		@ args = 4, pretend = 0, frame = 24
 1597              		@ frame_needed = 1, uses_anonymous_args = 0
 1598 0a00 80B5     		push	{r7, lr}
 1599              		.cfi_def_cfa_offset 8
 1600              		.cfi_offset 7, -8
 1601              		.cfi_offset 14, -4
 1602 0a02 86B0     		sub	sp, sp, #24
 1603              		.cfi_def_cfa_offset 32
 1604 0a04 00AF     		add	r7, sp, #0
 1605              		.cfi_def_cfa_register 7
 1606 0a06 F860     		str	r0, [r7, #12]
 1607 0a08 B960     		str	r1, [r7, #8]
 1608 0a0a 3B60     		str	r3, [r7]
 1609 0a0c 1346     		mov	r3, r2
 1610 0a0e FB71     		strb	r3, [r7, #7]
 610:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // ciphertext is already encoded and of length msg->length
 611:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t kidFlag;
 612:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 613:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (kidLen != 0) {
 1611              		.loc 1 613 0
 1612 0a10 97F82030 		ldrb	r3, [r7, #32]	@ zero_extendqisi2
 1613 0a14 002B     		cmp	r3, #0
 1614 0a16 02D0     		beq	.L72
 614:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         kidFlag = 1;
 1615              		.loc 1 614 0
 1616 0a18 0123     		movs	r3, #1
 1617 0a1a FB75     		strb	r3, [r7, #23]
 1618 0a1c 01E0     		b	.L73
 1619              	.L72:
 615:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 616:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 617:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         kidFlag = 0;
 1620              		.loc 1 617 0
 1621 0a1e 0023     		movs	r3, #0
 1622 0a20 FB75     		strb	r3, [r7, #23]
 1623              	.L73:
 618:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 619:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 620:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (kidFlag) {
 1624              		.loc 1 620 0
 1625 0a22 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1626 0a24 002B     		cmp	r3, #0
 1627 0a26 15D0     		beq	.L74
 621:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         packetfunctions_reserveHeaderSize(msg, kidLen + 1);
 1628              		.loc 1 621 0
 1629 0a28 97F82030 		ldrb	r3, [r7, #32]
 1630 0a2c 0133     		adds	r3, r3, #1
 1631 0a2e DBB2     		uxtb	r3, r3
 1632 0a30 1946     		mov	r1, r3
 1633 0a32 F868     		ldr	r0, [r7, #12]
 1634 0a34 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 622:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         msg->payload[0] = kidLen;
 1635              		.loc 1 622 0
 1636 0a38 FB68     		ldr	r3, [r7, #12]
 1637 0a3a 5B68     		ldr	r3, [r3, #4]
 1638 0a3c 97F82020 		ldrb	r2, [r7, #32]
 1639 0a40 1A70     		strb	r2, [r3]
 623:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         memcpy(&msg->payload[1], kid, kidLen);
 1640              		.loc 1 623 0
 1641 0a42 FB68     		ldr	r3, [r7, #12]
 1642 0a44 5B68     		ldr	r3, [r3, #4]
 1643 0a46 0133     		adds	r3, r3, #1
 1644 0a48 97F82020 		ldrb	r2, [r7, #32]	@ zero_extendqisi2
 1645 0a4c 3968     		ldr	r1, [r7]
 1646 0a4e 1846     		mov	r0, r3
 1647 0a50 FFF7FEFF 		bl	memcpy
 1648              	.L74:
 624:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 625:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 626:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (partialIVLen) {
 1649              		.loc 1 626 0
 1650 0a54 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1651 0a56 002B     		cmp	r3, #0
 1652 0a58 0BD0     		beq	.L75
 627:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         packetfunctions_reserveHeaderSize(msg, partialIVLen);
 1653              		.loc 1 627 0
 1654 0a5a FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1655 0a5c 1946     		mov	r1, r3
 1656 0a5e F868     		ldr	r0, [r7, #12]
 1657 0a60 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 628:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         memcpy(&msg->payload[0], partialIV, partialIVLen);
 1658              		.loc 1 628 0
 1659 0a64 FB68     		ldr	r3, [r7, #12]
 1660 0a66 5B68     		ldr	r3, [r3, #4]
 1661 0a68 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 1662 0a6a B968     		ldr	r1, [r7, #8]
 1663 0a6c 1846     		mov	r0, r3
 1664 0a6e FFF7FEFF 		bl	memcpy
 1665              	.L75:
 629:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 630:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // flag byte
 631:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     packetfunctions_reserveHeaderSize(msg, 1);
 1666              		.loc 1 631 0
 1667 0a72 0121     		movs	r1, #1
 1668 0a74 F868     		ldr	r0, [r7, #12]
 1669 0a76 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 632:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     msg->payload[0] = ((kidFlag << 3) | partialIVLen);
 1670              		.loc 1 632 0
 1671 0a7a FB68     		ldr	r3, [r7, #12]
 1672 0a7c 5B68     		ldr	r3, [r3, #4]
 1673 0a7e FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 1674 0a80 D200     		lsls	r2, r2, #3
 1675 0a82 51B2     		sxtb	r1, r2
 1676 0a84 97F90720 		ldrsb	r2, [r7, #7]
 1677 0a88 0A43     		orrs	r2, r2, r1
 1678 0a8a 52B2     		sxtb	r2, r2
 1679 0a8c D2B2     		uxtb	r2, r2
 1680 0a8e 1A70     		strb	r2, [r3]
 633:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 1681              		.loc 1 633 0
 1682 0a90 00BF     		nop
 1683 0a92 1837     		adds	r7, r7, #24
 1684              		.cfi_def_cfa_offset 8
 1685 0a94 BD46     		mov	sp, r7
 1686              		.cfi_def_cfa_register 13
 1687              		@ sp needed
 1688 0a96 80BD     		pop	{r7, pc}
 1689              		.cfi_endproc
 1690              	.LFE8:
 1692              		.align	2
 1693              		.global	xor_arrays
 1694              		.thumb
 1695              		.thumb_func
 1697              	xor_arrays:
 1698              	.LFB9:
 634:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 635:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 636:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** void xor_arrays(uint8_t* s1, uint8_t* s2, uint8_t* dst, uint8_t len) {
 1699              		.loc 1 636 0
 1700              		.cfi_startproc
 1701              		@ args = 0, pretend = 0, frame = 24
 1702              		@ frame_needed = 1, uses_anonymous_args = 0
 1703              		@ link register save eliminated.
 1704 0a98 80B4     		push	{r7}
 1705              		.cfi_def_cfa_offset 4
 1706              		.cfi_offset 7, -4
 1707 0a9a 87B0     		sub	sp, sp, #28
 1708              		.cfi_def_cfa_offset 32
 1709 0a9c 00AF     		add	r7, sp, #0
 1710              		.cfi_def_cfa_register 7
 1711 0a9e F860     		str	r0, [r7, #12]
 1712 0aa0 B960     		str	r1, [r7, #8]
 1713 0aa2 7A60     		str	r2, [r7, #4]
 1714 0aa4 FB70     		strb	r3, [r7, #3]
 637:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint8_t i;
 638:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     for (i = 0; i < len; i++) {
 1715              		.loc 1 638 0
 1716 0aa6 0023     		movs	r3, #0
 1717 0aa8 FB75     		strb	r3, [r7, #23]
 1718 0aaa 10E0     		b	.L77
 1719              	.L78:
 639:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         dst[i] = s1[i] ^ s2[i];
 1720              		.loc 1 639 0 discriminator 3
 1721 0aac FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1722 0aae 7A68     		ldr	r2, [r7, #4]
 1723 0ab0 1344     		add	r3, r3, r2
 1724 0ab2 FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 1725 0ab4 F968     		ldr	r1, [r7, #12]
 1726 0ab6 0A44     		add	r2, r2, r1
 1727 0ab8 1178     		ldrb	r1, [r2]	@ zero_extendqisi2
 1728 0aba FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 1729 0abc B868     		ldr	r0, [r7, #8]
 1730 0abe 0244     		add	r2, r2, r0
 1731 0ac0 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 1732 0ac2 4A40     		eors	r2, r2, r1
 1733 0ac4 D2B2     		uxtb	r2, r2
 1734 0ac6 1A70     		strb	r2, [r3]
 638:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         dst[i] = s1[i] ^ s2[i];
 1735              		.loc 1 638 0 discriminator 3
 1736 0ac8 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1737 0aca 0133     		adds	r3, r3, #1
 1738 0acc FB75     		strb	r3, [r7, #23]
 1739              	.L77:
 638:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         dst[i] = s1[i] ^ s2[i];
 1740              		.loc 1 638 0 is_stmt 0 discriminator 1
 1741 0ace FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 1742 0ad0 FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
 1743 0ad2 9A42     		cmp	r2, r3
 1744 0ad4 EAD3     		bcc	.L78
 640:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 641:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 1745              		.loc 1 641 0 is_stmt 1
 1746 0ad6 00BF     		nop
 1747 0ad8 1C37     		adds	r7, r7, #28
 1748              		.cfi_def_cfa_offset 4
 1749 0ada BD46     		mov	sp, r7
 1750              		.cfi_def_cfa_register 13
 1751              		@ sp needed
 1752 0adc 80BC     		pop	{r7}
 1753              		.cfi_restore 7
 1754              		.cfi_def_cfa_offset 0
 1755 0ade 7047     		bx	lr
 1756              		.cfi_endproc
 1757              	.LFE9:
 1759              		.align	2
 1760              		.global	flip_first_bit
 1761              		.thumb
 1762              		.thumb_func
 1764              	flip_first_bit:
 1765              	.LFB10:
 642:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 643:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** void flip_first_bit(uint8_t* source, uint8_t* dst, uint8_t len){
 1766              		.loc 1 643 0
 1767              		.cfi_startproc
 1768              		@ args = 0, pretend = 0, frame = 16
 1769              		@ frame_needed = 1, uses_anonymous_args = 0
 1770 0ae0 80B5     		push	{r7, lr}
 1771              		.cfi_def_cfa_offset 8
 1772              		.cfi_offset 7, -8
 1773              		.cfi_offset 14, -4
 1774 0ae2 84B0     		sub	sp, sp, #16
 1775              		.cfi_def_cfa_offset 24
 1776 0ae4 00AF     		add	r7, sp, #0
 1777              		.cfi_def_cfa_register 7
 1778 0ae6 F860     		str	r0, [r7, #12]
 1779 0ae8 B960     		str	r1, [r7, #8]
 1780 0aea 1346     		mov	r3, r2
 1781 0aec FB71     		strb	r3, [r7, #7]
 644:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     memcpy(dst, source, len);
 1782              		.loc 1 644 0
 1783 0aee FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1784 0af0 1A46     		mov	r2, r3
 1785 0af2 F968     		ldr	r1, [r7, #12]
 1786 0af4 B868     		ldr	r0, [r7, #8]
 1787 0af6 FFF7FEFF 		bl	memcpy
 645:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     dst[0] = dst[0] ^ 0x80;
 1788              		.loc 1 645 0
 1789 0afa BB68     		ldr	r3, [r7, #8]
 1790 0afc 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1791 0afe 83F07F03 		eor	r3, r3, #127
 1792 0b02 DB43     		mvns	r3, r3
 1793 0b04 DAB2     		uxtb	r2, r3
 1794 0b06 BB68     		ldr	r3, [r7, #8]
 1795 0b08 1A70     		strb	r2, [r3]
 646:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 1796              		.loc 1 646 0
 1797 0b0a 00BF     		nop
 1798 0b0c 1037     		adds	r7, r7, #16
 1799              		.cfi_def_cfa_offset 8
 1800 0b0e BD46     		mov	sp, r7
 1801              		.cfi_def_cfa_register 13
 1802              		@ sp needed
 1803 0b10 80BD     		pop	{r7, pc}
 1804              		.cfi_endproc
 1805              	.LFE10:
 1807 0b12 00BF     		.align	2
 1808              		.global	replay_window_check
 1809              		.thumb
 1810              		.thumb_func
 1812              	replay_window_check:
 1813              	.LFB11:
 647:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 648:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** bool replay_window_check(oscoap_security_context_t *context, uint16_t sequenceNumber) {
 1814              		.loc 1 648 0
 1815              		.cfi_startproc
 1816              		@ args = 0, pretend = 0, frame = 16
 1817              		@ frame_needed = 1, uses_anonymous_args = 0
 1818              		@ link register save eliminated.
 1819 0b14 80B4     		push	{r7}
 1820              		.cfi_def_cfa_offset 4
 1821              		.cfi_offset 7, -4
 1822 0b16 85B0     		sub	sp, sp, #20
 1823              		.cfi_def_cfa_offset 24
 1824 0b18 00AF     		add	r7, sp, #0
 1825              		.cfi_def_cfa_register 7
 1826 0b1a 7860     		str	r0, [r7, #4]
 1827 0b1c 0B46     		mov	r3, r1
 1828 0b1e 7B80     		strh	r3, [r7, #2]	@ movhi
 649:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint16_t delta;
 650:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     
 651:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // packets lower than the left edge are rejected
 652:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if ((int)sequenceNumber < (int)(context->window.rightEdge - 31)) {
 1829              		.loc 1 652 0
 1830 0b20 7A88     		ldrh	r2, [r7, #2]
 1831 0b22 7B68     		ldr	r3, [r7, #4]
 1832 0b24 B3F85830 		ldrh	r3, [r3, #88]
 1833 0b28 1F3B     		subs	r3, r3, #31
 1834 0b2a 9A42     		cmp	r2, r3
 1835 0b2c 01DA     		bge	.L81
 653:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return FALSE;
 1836              		.loc 1 653 0
 1837 0b2e 0023     		movs	r3, #0
 1838 0b30 1AE0     		b	.L82
 1839              	.L81:
 654:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 655:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****  
 656:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // packets higher than the right edge are accepted
 657:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (sequenceNumber > context->window.rightEdge) {
 1840              		.loc 1 657 0
 1841 0b32 7B68     		ldr	r3, [r7, #4]
 1842 0b34 B3F85830 		ldrh	r3, [r3, #88]
 1843 0b38 7A88     		ldrh	r2, [r7, #2]
 1844 0b3a 9A42     		cmp	r2, r3
 1845 0b3c 01D9     		bls	.L83
 658:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return TRUE;
 1846              		.loc 1 658 0
 1847 0b3e 0123     		movs	r3, #1
 1848 0b40 12E0     		b	.L82
 1849              	.L83:
 659:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 660:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 661:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     // packet falls within the window, check if appropriate bit is set
 662:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     delta = context->window.rightEdge - sequenceNumber;
 1850              		.loc 1 662 0
 1851 0b42 7B68     		ldr	r3, [r7, #4]
 1852 0b44 B3F85820 		ldrh	r2, [r3, #88]
 1853 0b48 7B88     		ldrh	r3, [r7, #2]	@ movhi
 1854 0b4a D31A     		subs	r3, r2, r3
 1855 0b4c FB81     		strh	r3, [r7, #14]	@ movhi
 663:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if ((uint32_t)(1 << delta) & context->window.bitArray) {
 1856              		.loc 1 663 0
 1857 0b4e FB89     		ldrh	r3, [r7, #14]
 1858 0b50 0122     		movs	r2, #1
 1859 0b52 02FA03F3 		lsl	r3, r2, r3
 1860 0b56 1A46     		mov	r2, r3
 1861 0b58 7B68     		ldr	r3, [r7, #4]
 1862 0b5a 5B6D     		ldr	r3, [r3, #84]
 1863 0b5c 1340     		ands	r3, r3, r2
 1864 0b5e 002B     		cmp	r3, #0
 1865 0b60 01D0     		beq	.L84
 664:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return FALSE;
 1866              		.loc 1 664 0
 1867 0b62 0023     		movs	r3, #0
 1868 0b64 00E0     		b	.L82
 1869              	.L84:
 665:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 666:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 667:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     return TRUE;
 1870              		.loc 1 667 0
 1871 0b66 0123     		movs	r3, #1
 1872              	.L82:
 668:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 1873              		.loc 1 668 0
 1874 0b68 1846     		mov	r0, r3
 1875 0b6a 1437     		adds	r7, r7, #20
 1876              		.cfi_def_cfa_offset 4
 1877 0b6c BD46     		mov	sp, r7
 1878              		.cfi_def_cfa_register 13
 1879              		@ sp needed
 1880 0b6e 80BC     		pop	{r7}
 1881              		.cfi_restore 7
 1882              		.cfi_def_cfa_offset 0
 1883 0b70 7047     		bx	lr
 1884              		.cfi_endproc
 1885              	.LFE11:
 1887 0b72 00BF     		.align	2
 1888              		.global	replay_window_update
 1889              		.thumb
 1890              		.thumb_func
 1892              	replay_window_update:
 1893              	.LFB12:
 669:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 670:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** void replay_window_update(oscoap_security_context_t *context, uint16_t sequenceNumber) {
 1894              		.loc 1 670 0
 1895              		.cfi_startproc
 1896              		@ args = 0, pretend = 0, frame = 16
 1897              		@ frame_needed = 1, uses_anonymous_args = 0
 1898 0b74 80B5     		push	{r7, lr}
 1899              		.cfi_def_cfa_offset 8
 1900              		.cfi_offset 7, -8
 1901              		.cfi_offset 14, -4
 1902 0b76 84B0     		sub	sp, sp, #16
 1903              		.cfi_def_cfa_offset 24
 1904 0b78 00AF     		add	r7, sp, #0
 1905              		.cfi_def_cfa_register 7
 1906 0b7a 7860     		str	r0, [r7, #4]
 1907 0b7c 0B46     		mov	r3, r1
 1908 0b7e 7B80     		strh	r3, [r7, #2]	@ movhi
 671:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     uint16_t delta;
 672:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 673:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (replay_window_check(context, sequenceNumber) == FALSE) {
 1909              		.loc 1 673 0
 1910 0b80 7B88     		ldrh	r3, [r7, #2]
 1911 0b82 1946     		mov	r1, r3
 1912 0b84 7868     		ldr	r0, [r7, #4]
 1913 0b86 FFF7FEFF 		bl	replay_window_check
 1914 0b8a 0346     		mov	r3, r0
 1915 0b8c 83F00103 		eor	r3, r3, #1
 1916 0b90 DBB2     		uxtb	r3, r3
 1917 0b92 002B     		cmp	r3, #0
 1918 0b94 36D1     		bne	.L91
 674:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return;
 675:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 676:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     
 677:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (sequenceNumber > context->window.rightEdge) {
 1919              		.loc 1 677 0
 1920 0b96 7B68     		ldr	r3, [r7, #4]
 1921 0b98 B3F85830 		ldrh	r3, [r3, #88]
 1922 0b9c 7A88     		ldrh	r2, [r7, #2]
 1923 0b9e 9A42     		cmp	r2, r3
 1924 0ba0 1DD9     		bls	.L88
 678:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         delta = sequenceNumber - context->window.rightEdge;
 1925              		.loc 1 678 0
 1926 0ba2 7B68     		ldr	r3, [r7, #4]
 1927 0ba4 B3F85830 		ldrh	r3, [r3, #88]
 1928 0ba8 7A88     		ldrh	r2, [r7, #2]	@ movhi
 1929 0baa D31A     		subs	r3, r2, r3
 1930 0bac FB81     		strh	r3, [r7, #14]	@ movhi
 679:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         context->window.rightEdge = sequenceNumber;
 1931              		.loc 1 679 0
 1932 0bae 7B68     		ldr	r3, [r7, #4]
 1933 0bb0 7A88     		ldrh	r2, [r7, #2]	@ movhi
 1934 0bb2 A3F85820 		strh	r2, [r3, #88]	@ movhi
 680:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         if (delta < 32) {
 1935              		.loc 1 680 0
 1936 0bb6 FB89     		ldrh	r3, [r7, #14]
 1937 0bb8 1F2B     		cmp	r3, #31
 1938 0bba 06D8     		bhi	.L89
 681:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             context->window.bitArray = context->window.bitArray << delta;
 1939              		.loc 1 681 0
 1940 0bbc 7B68     		ldr	r3, [r7, #4]
 1941 0bbe 5A6D     		ldr	r2, [r3, #84]
 1942 0bc0 FB89     		ldrh	r3, [r7, #14]
 1943 0bc2 9A40     		lsls	r2, r2, r3
 1944 0bc4 7B68     		ldr	r3, [r7, #4]
 1945 0bc6 5A65     		str	r2, [r3, #84]
 1946 0bc8 02E0     		b	.L90
 1947              	.L89:
 682:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         }
 683:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         else {
 684:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             context->window.bitArray = 0x00;
 1948              		.loc 1 684 0
 1949 0bca 7B68     		ldr	r3, [r7, #4]
 1950 0bcc 0022     		movs	r2, #0
 1951 0bce 5A65     		str	r2, [r3, #84]
 1952              	.L90:
 685:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         }
 686:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         context->window.bitArray |= 1; // update the right edge bit
 1953              		.loc 1 686 0
 1954 0bd0 7B68     		ldr	r3, [r7, #4]
 1955 0bd2 5B6D     		ldr	r3, [r3, #84]
 1956 0bd4 43F00102 		orr	r2, r3, #1
 1957 0bd8 7B68     		ldr	r3, [r7, #4]
 1958 0bda 5A65     		str	r2, [r3, #84]
 1959 0bdc 13E0     		b	.L85
 1960              	.L88:
 687:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 688:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 689:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         delta = context->window.rightEdge - sequenceNumber;
 1961              		.loc 1 689 0
 1962 0bde 7B68     		ldr	r3, [r7, #4]
 1963 0be0 B3F85820 		ldrh	r2, [r3, #88]
 1964 0be4 7B88     		ldrh	r3, [r7, #2]	@ movhi
 1965 0be6 D31A     		subs	r3, r2, r3
 1966 0be8 FB81     		strh	r3, [r7, #14]	@ movhi
 690:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         if (delta < 32) {
 1967              		.loc 1 690 0
 1968 0bea FB89     		ldrh	r3, [r7, #14]
 1969 0bec 1F2B     		cmp	r3, #31
 1970 0bee 0AD8     		bhi	.L85
 691:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****             context->window.bitArray |= 1 << delta;
 1971              		.loc 1 691 0
 1972 0bf0 7B68     		ldr	r3, [r7, #4]
 1973 0bf2 5B6D     		ldr	r3, [r3, #84]
 1974 0bf4 FA89     		ldrh	r2, [r7, #14]
 1975 0bf6 0121     		movs	r1, #1
 1976 0bf8 01FA02F2 		lsl	r2, r1, r2
 1977 0bfc 1A43     		orrs	r2, r2, r3
 1978 0bfe 7B68     		ldr	r3, [r7, #4]
 1979 0c00 5A65     		str	r2, [r3, #84]
 1980 0c02 00E0     		b	.L85
 1981              	.L91:
 674:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 1982              		.loc 1 674 0
 1983 0c04 00BF     		nop
 1984              	.L85:
 692:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         }
 693:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 694:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 1985              		.loc 1 694 0
 1986 0c06 1037     		adds	r7, r7, #16
 1987              		.cfi_def_cfa_offset 8
 1988 0c08 BD46     		mov	sp, r7
 1989              		.cfi_def_cfa_register 13
 1990              		@ sp needed
 1991 0c0a 80BD     		pop	{r7, pc}
 1992              		.cfi_endproc
 1993              	.LFE12:
 1995              		.align	2
 1996              		.global	openoscoap_convert_sequence_number
 1997              		.thumb
 1998              		.thumb_func
 2000              	openoscoap_convert_sequence_number:
 2001              	.LFB13:
 695:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** 
 696:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** uint8_t openoscoap_convert_sequence_number(uint16_t sequenceNumber, uint8_t** buffer) {
 2002              		.loc 1 696 0
 2003              		.cfi_startproc
 2004              		@ args = 0, pretend = 0, frame = 8
 2005              		@ frame_needed = 1, uses_anonymous_args = 0
 2006 0c0c 80B5     		push	{r7, lr}
 2007              		.cfi_def_cfa_offset 8
 2008              		.cfi_offset 7, -8
 2009              		.cfi_offset 14, -4
 2010 0c0e 82B0     		sub	sp, sp, #8
 2011              		.cfi_def_cfa_offset 16
 2012 0c10 00AF     		add	r7, sp, #0
 2013              		.cfi_def_cfa_register 7
 2014 0c12 0346     		mov	r3, r0
 2015 0c14 3960     		str	r1, [r7]
 2016 0c16 FB80     		strh	r3, [r7, #6]	@ movhi
 697:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     packetfunctions_htons(sequenceNumber, *buffer);
 2017              		.loc 1 697 0
 2018 0c18 3B68     		ldr	r3, [r7]
 2019 0c1a 1A68     		ldr	r2, [r3]
 2020 0c1c FB88     		ldrh	r3, [r7, #6]
 2021 0c1e 1146     		mov	r1, r2
 2022 0c20 1846     		mov	r0, r3
 2023 0c22 FFF7FEFF 		bl	packetfunctions_htons
 698:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     if (**buffer == 0x00) {
 2024              		.loc 1 698 0
 2025 0c26 3B68     		ldr	r3, [r7]
 2026 0c28 1B68     		ldr	r3, [r3]
 2027 0c2a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2028 0c2c 002B     		cmp	r3, #0
 2029 0c2e 06D1     		bne	.L93
 699:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         (*buffer)++;
 2030              		.loc 1 699 0
 2031 0c30 3B68     		ldr	r3, [r7]
 2032 0c32 1B68     		ldr	r3, [r3]
 2033 0c34 5A1C     		adds	r2, r3, #1
 2034 0c36 3B68     		ldr	r3, [r7]
 2035 0c38 1A60     		str	r2, [r3]
 700:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return 1;
 2036              		.loc 1 700 0
 2037 0c3a 0123     		movs	r3, #1
 2038 0c3c 00E0     		b	.L94
 2039              	.L93:
 701:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 702:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     else {
 703:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****         return 2;
 2040              		.loc 1 703 0
 2041 0c3e 0223     		movs	r3, #2
 2042              	.L94:
 704:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c ****     }
 705:build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.c **** }
 2043              		.loc 1 705 0
 2044 0c40 1846     		mov	r0, r3
 2045 0c42 0837     		adds	r7, r7, #8
 2046              		.cfi_def_cfa_offset 8
 2047 0c44 BD46     		mov	sp, r7
 2048              		.cfi_def_cfa_register 13
 2049              		@ sp needed
 2050 0c46 80BD     		pop	{r7, pc}
 2051              		.cfi_endproc
 2052              	.LFE13:
 2054              	.Letext0:
 2055              		.file 2 "/usr/include/newlib/machine/_default_types.h"
 2056              		.file 3 "/usr/include/newlib/sys/_stdint.h"
 2057              		.file 4 "inc/opendefs.h"
 2058              		.file 5 "build/openmote-cc2538_armgcc/openapps/opencoap/opencoap.h"
 2059              		.file 6 "build/openmote-cc2538_armgcc/openapps/opencoap/openoscoap.h"
 2060              		.file 7 "build/openmote-cc2538_armgcc/openapps/opencoap/sha.h"
 2061              		.file 8 "bsp/boards/openmote-cc2538/board_info.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 openoscoap.c
     /tmp/ccTrwncx.s:20     .rodata:0000000000000000 $d
     /tmp/ccTrwncx.s:23     .rodata:0000000000000000 rreg_uriquery
     /tmp/ccTrwncx.s:28     .rodata:0000000000000008 infoBoardname
     /tmp/ccTrwncx.s:33     .rodata:0000000000000010 infouCName
     /tmp/ccTrwncx.s:38     .rodata:0000000000000018 infoRadioName
     /tmp/ccTrwncx.s:43     .rodata:0000000000000024 infoStackName
     /tmp/ccTrwncx.s:48     .rodata:0000000000000030 ipAddr_ipsoRD
     /tmp/ccTrwncx.s:68     .rodata:0000000000000040 ipAddr_motesEecs
     /tmp/ccTrwncx.s:88     .rodata:0000000000000050 ipAddr_local
     /tmp/ccTrwncx.s:108    .rodata:0000000000000060 ipAddr_motedata
     /tmp/ccTrwncx.s:128    .rodata:0000000000000070 ipAddr_ringmaster
                            *COM*:0000000000000001 openoscoap_vars
     /tmp/ccTrwncx.s:147    .text:0000000000000000 $t
     /tmp/ccTrwncx.s:152    .text:0000000000000000 openoscoap_init_security_context
     /tmp/ccTrwncx.s:1165   .text:00000000000006e8 hkdf_derive_parameter
     /tmp/ccTrwncx.s:314    .text:000000000000011c openoscoap_protect_message
     /tmp/ccTrwncx.s:2000   .text:0000000000000c0c openoscoap_convert_sequence_number
     /tmp/ccTrwncx.s:1334   .text:0000000000000830 is_request
     /tmp/ccTrwncx.s:1398   .text:0000000000000864 openoscoap_construct_aad
     /tmp/ccTrwncx.s:1697   .text:0000000000000a98 xor_arrays
     /tmp/ccTrwncx.s:1764   .text:0000000000000ae0 flip_first_bit
     /tmp/ccTrwncx.s:1592   .text:0000000000000a00 openoscoap_encode_compressed_COSE
     /tmp/ccTrwncx.s:634    .text:0000000000000388 openoscoap_unprotect_message
     /tmp/ccTrwncx.s:1812   .text:0000000000000b14 replay_window_check
     /tmp/ccTrwncx.s:1892   .text:0000000000000b74 replay_window_update
     /tmp/ccTrwncx.s:946    .text:00000000000005d4 openoscoap_get_sequence_number
     /tmp/ccTrwncx.s:1002   .text:0000000000000610 openoscoap_parse_compressed_COSE
     /tmp/ccTrwncx.s:1324   .text:0000000000000828 $d
     /tmp/ccTrwncx.s:1329   .text:0000000000000830 $t
     /tmp/ccTrwncx.s:1583   .text:00000000000009fc $d
     /tmp/ccTrwncx.s:1587   .text:0000000000000a00 $t
                     .debug_frame:0000000000000010 $d
                           .group:0000000000000000 wm4.0.8e445c0106ab795ab4704214cba6f089
                           .group:0000000000000000 wm4._newlib_version.h.4.ad342815780c8db09778091a421b5b5b
                           .group:0000000000000000 wm4.features.h.33.d97f2d646536517df901beeb5b9993f5
                           .group:0000000000000000 wm4._default_types.h.15.933e8edd27a65e0b69af4a865eb623d2
                           .group:0000000000000000 wm4._intsup.h.10.b82bf99f69d6a5c085fc866de0d3eb9b
                           .group:0000000000000000 wm4._stdint.h.10.7a5f60e6741af4a5594a3867d347e1f9
                           .group:0000000000000000 wm4.stdint.h.23.373a9d32a9e4c2e88fd347156532d281
                           .group:0000000000000000 wm4.toolchain_defs.h.2.e5fd326231d01413e5361944b26cde07
                           .group:0000000000000000 wm4.newlib.h.8.36dd0417407b0a085bc04c49cc2ed13a
                           .group:0000000000000000 wm4.config.h.219.65a553ab5bef5482f0d7880b0d33015e
                           .group:0000000000000000 wm4._ansi.h.23.9f8fcfa20193763fcf364fb91705c94b
                           .group:0000000000000000 wm4.stddef.h.39.a38874c8f8a57e66301090908ec2a69f
                           .group:0000000000000000 wm4.lock.h.2.9bc98482741e5e2a9450b12934a684ea
                           .group:0000000000000000 wm4._types.h.125.5cf8a495f1f7ef36777ad868a1e32068
                           .group:0000000000000000 wm4.stddef.h.161.5349cb105733e8777bfb0cf53c4e3f34
                           .group:0000000000000000 wm4._types.h.183.c226d164ceca1f2ecb9ae9360c54a098
                           .group:0000000000000000 wm4.reent.h.17.850ac0a908956e5fb788be1b80de2f32
                           .group:0000000000000000 wm4.cdefs.h.47.ba62642086d429b4f95c2381cae1c0aa
                           .group:0000000000000000 wm4.string.h.15.dab3980bf35408a4c507182805e2de3a
                           .group:0000000000000000 wm4.stddef.h.161.19e15733342b50ead2919490b095303e
                           .group:0000000000000000 wm4.stdbool.h.29.07dce69c3b78884144b7f7bd19483461
                           .group:0000000000000000 wm4.hw_types.h.67.b10589a0806dcc2d274d6fab6b736519
                           .group:0000000000000000 wm4.interrupt.h.41.272fc4ec0e276feb439e7974d0f77eaf
                           .group:0000000000000000 wm4.board_info.h.22.1291259c351bc018e4d4402148b3c6db
                           .group:0000000000000000 wm4.opendefs.h.23.47191652995b7fa35f12da40c3552cda
                           .group:0000000000000000 wm4.openserial.h.9.e4d628a9d51214e15d3007d4c3811df6
                           .group:0000000000000000 wm4.opentimers.h.8.4ddb88466c5d61beaa6758270059ffcf
                           .group:0000000000000000 wm4.opencoap.h.32.4fd89a1f25836020968932a0f7dffe46
                           .group:0000000000000000 wm4.cryptoengine.h.8.da068b9149b7576990bbc3b5f1e9b415
                           .group:0000000000000000 wm4.sha.h.40.d735a7d478637a222f13b357edda1d20

UNDEFINED SYMBOLS
memcpy
opencoap_find_option
memset
packetfunctions_reserveHeaderSize
opencoap_options_encode
openserial_printError
cryptoengine_aes_ccms_enc
packetfunctions_tossHeader
cryptoengine_aes_ccms_dec
opencoap_options_parse
packetfunctions_tossFooter
packetfunctions_ntohs
cborencoder_put_array
cborencoder_put_bytes
cborencoder_put_unsigned
cborencoder_put_text
hkdf
packetfunctions_htons
