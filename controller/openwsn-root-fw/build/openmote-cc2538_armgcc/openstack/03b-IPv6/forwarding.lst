   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.syntax unified
  15              		.file	"forwarding.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.rodata
  20              		.align	2
  23              	rreg_uriquery:
  24 0000 683D7563 		.ascii	"h=ucb\000"
  24      6200
  25 0006 0000     		.align	2
  28              	infoBoardname:
  29 0008 43433235 		.ascii	"CC2538\000"
  29      333800
  30 000f 00       		.align	2
  33              	infouCName:
  34 0010 43433235 		.ascii	"CC2538\000"
  34      333800
  35 0017 00       		.align	2
  38              	infoRadioName:
  39 0018 43433235 		.ascii	"CC2538 SoC\000"
  39      33382053 
  39      6F4300
  40 0023 00       		.align	2
  43              	infoStackName:
  44 0024 4F70656E 		.ascii	"OpenWSN \000"
  44      57534E20 
  44      00
  45 002d 000000   		.align	2
  48              	linklocalprefix:
  49 0030 FE       		.byte	-2
  50 0031 80       		.byte	-128
  51 0032 00       		.byte	0
  52 0033 00       		.byte	0
  53 0034 00       		.byte	0
  54 0035 00       		.byte	0
  55 0036 00       		.byte	0
  56 0037 00       		.byte	0
  57              		.align	2
  60              	all_routers_multicast:
  61 0038 FF       		.byte	-1
  62 0039 02       		.byte	2
  63 003a 00       		.byte	0
  64 003b 00       		.byte	0
  65 003c 00       		.byte	0
  66 003d 00       		.byte	0
  67 003e 00       		.byte	0
  68 003f 00       		.byte	0
  69 0040 00       		.byte	0
  70 0041 00       		.byte	0
  71 0042 00       		.byte	0
  72 0043 00       		.byte	0
  73 0044 00       		.byte	0
  74 0045 00       		.byte	0
  75 0046 00       		.byte	0
  76 0047 1A       		.byte	26
  77              		.text
  78              		.align	2
  79              		.global	forwarding_init
  80              		.thumb
  81              		.thumb_func
  83              	forwarding_init:
  84              	.LFB0:
  85              		.file 1 "build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c"
   1:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "opendefs.h"
   2:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "forwarding.h"
   3:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "iphc.h"
   4:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "openqueue.h"
   5:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "openserial.h"
   6:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "idmanager.h"
   7:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "packetfunctions.h"
   8:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "neighbors.h"
   9:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "icmpv6.h"
  10:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "icmpv6rpl.h"
  11:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "openudp.h"
  12:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "debugpins.h"
  13:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #include "scheduler.h"
  14:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  15:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //=========================== variables =======================================
  16:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  17:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //=========================== prototypes ======================================
  18:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  19:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** void      forwarding_getNextHop(
  20:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    open_addr_t*         destination,
  21:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    open_addr_t*         addressToWrite
  22:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** );
  23:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** owerror_t forwarding_send_internal_RoutingTable(
  24:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    OpenQueueEntry_t*    msg,
  25:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    ipv6_header_iht*     ipv6_outer_header,
  26:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    ipv6_header_iht*     ipv6_inner_header,
  27:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    rpl_option_ht*       rpl_option,
  28:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
  29:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    deadline_option_ht*	deadline_option,
  30:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif   
  31:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    uint32_t*             flow_label,
  32:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    uint8_t              fw_SendOrfw_Rcv
  33:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** );
  34:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** owerror_t forwarding_send_internal_SourceRouting(
  35:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    OpenQueueEntry_t*    msg,
  36:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    ipv6_header_iht*     ipv6_outer_header,
  37:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    ipv6_header_iht*     ipv6_inner_header,
  38:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
  39:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    deadline_option_ht*	deadline_option,
  40:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif   
  41:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    rpl_option_ht*       rpl_option
  42:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** );
  43:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** void      forwarding_createRplOption(
  44:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    rpl_option_ht*       rpl_option,
  45:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    uint8_t              flags
  46:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** );
  47:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  48:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
  49:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** void forwarding_createDeadlineOption(
  50:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    deadline_option_ht*   deadline_option
  51:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** );
  52:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif
  53:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  54:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //=========================== public ==========================================
  55:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  56:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** /**
  57:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \brief Initialize this module.
  58:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** */
  59:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** void forwarding_init() {
  86              		.loc 1 59 0
  87              		.cfi_startproc
  88              		@ args = 0, pretend = 0, frame = 0
  89              		@ frame_needed = 1, uses_anonymous_args = 0
  90              		@ link register save eliminated.
  91 0000 80B4     		push	{r7}
  92              		.cfi_def_cfa_offset 4
  93              		.cfi_offset 7, -4
  94 0002 00AF     		add	r7, sp, #0
  95              		.cfi_def_cfa_register 7
  60:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** }
  96              		.loc 1 60 0
  97 0004 00BF     		nop
  98 0006 BD46     		mov	sp, r7
  99              		.cfi_def_cfa_register 13
 100              		@ sp needed
 101 0008 80BC     		pop	{r7}
 102              		.cfi_restore 7
 103              		.cfi_def_cfa_offset 0
 104 000a 7047     		bx	lr
 105              		.cfi_endproc
 106              	.LFE0:
 108              		.section	.rodata
 109              		.align	2
 110              	.LC0:
 111 0048 BB       		.byte	-69
 112 0049 BB       		.byte	-69
 113 004a 00       		.byte	0
 114 004b 00       		.byte	0
 115 004c 00       		.byte	0
 116 004d 00       		.byte	0
 117 004e 00       		.byte	0
 118 004f 00       		.byte	0
 119 0050 00       		.byte	0
 120 0051 12       		.byte	18
 121 0052 4B       		.byte	75
 122 0053 00       		.byte	0
 123 0054 06       		.byte	6
 124 0055 13       		.byte	19
 125 0056 06       		.byte	6
 126 0057 36       		.byte	54
 127              		.text
 128              		.align	2
 129              		.global	forwarding_send
 130              		.thumb
 131              		.thumb_func
 133              	forwarding_send:
 134              	.LFB1:
  61:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  62:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** /**
  63:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \brief Send a packet originating at this mote.
  64:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  65:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** This function is called by an upper layer, and only concerns packets originated
  66:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** at this mote.
  67:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  68:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in,out] msg Packet to send.
  69:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** */
  70:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** owerror_t forwarding_send(OpenQueueEntry_t* msg) {
 135              		.loc 1 70 0
 136              		.cfi_startproc
 137              		@ args = 0, pretend = 0, frame = 328
 138              		@ frame_needed = 1, uses_anonymous_args = 0
 139 000c F0B5     		push	{r4, r5, r6, r7, lr}
 140              		.cfi_def_cfa_offset 20
 141              		.cfi_offset 4, -20
 142              		.cfi_offset 5, -16
 143              		.cfi_offset 6, -12
 144              		.cfi_offset 7, -8
 145              		.cfi_offset 14, -4
 146 000e DFB0     		sub	sp, sp, #380
 147              		.cfi_def_cfa_offset 400
 148 0010 0CAF     		add	r7, sp, #48
 149              		.cfi_def_cfa 7, 352
 150 0012 3B1D     		adds	r3, r7, #4
 151 0014 1860     		str	r0, [r3]
  71:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ipv6_header_iht      ipv6_outer_header;
  72:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ipv6_header_iht      ipv6_inner_header;
  73:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     rpl_option_ht        rpl_option;
  74:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t          link_local_prefix;
  75:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
  76:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     deadline_option_ht   deadline_option;
  77:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif    
  78:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t*         myprefix;
  79:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t*         myadd64;
  80:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint32_t             flow_label = 0;
 152              		.loc 1 80 0
 153 0016 0023     		movs	r3, #0
 154 0018 BB66     		str	r3, [r7, #104]
  81:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  82:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t          temp_dest_prefix;
  83:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t          temp_dest_mac64b;
  84:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t*         p_dest;
  85:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t*         p_src;  
  86:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t          temp_src_prefix;
  87:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t          temp_src_mac64b;
  88:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     bool                 sac;
  89:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              sam;
  90:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              m;
  91:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     bool                 dac;
  92:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              dam;
  93:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              next_header;
  94:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  95:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // take ownership over the packet
  96:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     msg->owner                = COMPONENT_FORWARDING;
 155              		.loc 1 96 0
 156 001a 3B1D     		adds	r3, r7, #4
 157 001c 1B68     		ldr	r3, [r3]
 158 001e 1322     		movs	r2, #19
 159 0020 5A70     		strb	r2, [r3, #1]
  97:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
  98:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     m   = IPHC_M_NO;
 160              		.loc 1 98 0
 161 0022 0023     		movs	r3, #0
 162 0024 87F83931 		strb	r3, [r7, #313]
  99:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 100:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // retrieve my prefix and EUI64
 101:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     myadd64                   = idmanager_getMyID(ADDR_64B);
 163              		.loc 1 101 0
 164 0028 0220     		movs	r0, #2
 165 002a FFF7FEFF 		bl	idmanager_getMyID
 166 002e C7F83001 		str	r0, [r7, #304]
 102:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 103:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // set source address (me)
 104:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     msg->l3_sourceAdd.type=ADDR_128B;
 167              		.loc 1 104 0
 168 0032 3B1D     		adds	r3, r7, #4
 169 0034 1B68     		ldr	r3, [r3]
 170 0036 0322     		movs	r2, #3
 171 0038 83F82A20 		strb	r2, [r3, #42]
 105:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 106:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // if we are sending to a link-local address set the source prefix to link-local
 107:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if (packetfunctions_isLinkLocal(&msg->l3_destinationAdd)                ||
 172              		.loc 1 107 0
 173 003c 3B1D     		adds	r3, r7, #4
 174 003e 1B68     		ldr	r3, [r3]
 175 0040 1933     		adds	r3, r3, #25
 176 0042 1846     		mov	r0, r3
 177 0044 FFF7FEFF 		bl	packetfunctions_isLinkLocal
 178 0048 0346     		mov	r3, r0
 179 004a 002B     		cmp	r3, #0
 180 004c 11D1     		bne	.L3
 108:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             packetfunctions_isAllRoutersMulticast(&msg->l3_destinationAdd)  ||
 181              		.loc 1 108 0 discriminator 1
 182 004e 3B1D     		adds	r3, r7, #4
 183 0050 1B68     		ldr	r3, [r3]
 184 0052 1933     		adds	r3, r3, #25
 185 0054 1846     		mov	r0, r3
 186 0056 FFF7FEFF 		bl	packetfunctions_isAllRoutersMulticast
 187 005a 0346     		mov	r3, r0
 107:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             packetfunctions_isAllRoutersMulticast(&msg->l3_destinationAdd)  ||
 188              		.loc 1 107 0 discriminator 1
 189 005c 002B     		cmp	r3, #0
 190 005e 08D1     		bne	.L3
 109:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             packetfunctions_isAllHostsMulticast(&msg->l3_destinationAdd)) {
 191              		.loc 1 109 0
 192 0060 3B1D     		adds	r3, r7, #4
 193 0062 1B68     		ldr	r3, [r3]
 194 0064 1933     		adds	r3, r3, #25
 195 0066 1846     		mov	r0, r3
 196 0068 FFF7FEFF 		bl	packetfunctions_isAllHostsMulticast
 197 006c 0346     		mov	r3, r0
 108:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             packetfunctions_isAllRoutersMulticast(&msg->l3_destinationAdd)  ||
 198              		.loc 1 108 0
 199 006e 002B     		cmp	r3, #0
 200 0070 1AD0     		beq	.L4
 201              	.L3:
 110:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         memset(&link_local_prefix, 0x00, sizeof(open_addr_t));
 202              		.loc 1 110 0
 203 0072 07F18403 		add	r3, r7, #132
 204 0076 1122     		movs	r2, #17
 205 0078 0021     		movs	r1, #0
 206 007a 1846     		mov	r0, r3
 207 007c FFF7FEFF 		bl	memset
 111:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         link_local_prefix.type = ADDR_PREFIX;
 208              		.loc 1 111 0
 209 0080 0523     		movs	r3, #5
 210 0082 87F88430 		strb	r3, [r7, #132]
 112:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         link_local_prefix.prefix[0] = 0xfe;
 211              		.loc 1 112 0
 212 0086 FE23     		movs	r3, #254
 213 0088 87F88530 		strb	r3, [r7, #133]
 113:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         link_local_prefix.prefix[1] = 0x80;
 214              		.loc 1 113 0
 215 008c 8023     		movs	r3, #128
 216 008e 87F88630 		strb	r3, [r7, #134]
 114:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         myprefix = &link_local_prefix;
 217              		.loc 1 114 0
 218 0092 07F18403 		add	r3, r7, #132
 219 0096 C7F84431 		str	r3, [r7, #324]
 115:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         sac = IPHC_SAC_STATELESS;
 220              		.loc 1 115 0
 221 009a 0023     		movs	r3, #0
 222 009c 87F83B31 		strb	r3, [r7, #315]
 116:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         dac = IPHC_DAC_STATELESS;
 223              		.loc 1 116 0
 224 00a0 0023     		movs	r3, #0
 225 00a2 87F83831 		strb	r3, [r7, #312]
 226 00a6 0AE0     		b	.L5
 227              	.L4:
 117:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     } else {
 118:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         myprefix = idmanager_getMyID(ADDR_PREFIX);
 228              		.loc 1 118 0
 229 00a8 0520     		movs	r0, #5
 230 00aa FFF7FEFF 		bl	idmanager_getMyID
 231 00ae C7F84401 		str	r0, [r7, #324]
 119:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         sac = IPHC_SAC_STATEFUL;
 232              		.loc 1 119 0
 233 00b2 0123     		movs	r3, #1
 234 00b4 87F83B31 		strb	r3, [r7, #315]
 120:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         dac = IPHC_DAC_STATEFUL;
 235              		.loc 1 120 0
 236 00b8 0123     		movs	r3, #1
 237 00ba 87F83831 		strb	r3, [r7, #312]
 238              	.L5:
 121:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
 122:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 123:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     //printf("I am node %d, forwarding \n", idmanager_getMyID(ADDR_64B)->addr_64b[7]);
 124:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 125:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if (msg->creator == COMPONENT_ICMPv6RPL){
 239              		.loc 1 125 0
 240 00be 3B1D     		adds	r3, r7, #4
 241 00c0 1B68     		ldr	r3, [r3]
 242 00c2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 243 00c4 172B     		cmp	r3, #23
 244 00c6 59D1     		bne	.L6
 126:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		if( (msg->isDioFake==TRUE) && (idmanager_getIsDAGroot()==TRUE) ){
 245              		.loc 1 126 0
 246 00c8 3B1D     		adds	r3, r7, #4
 247 00ca 1B68     		ldr	r3, [r3]
 248 00cc 93F84331 		ldrb	r3, [r3, #323]	@ zero_extendqisi2
 249 00d0 002B     		cmp	r3, #0
 250 00d2 37D0     		beq	.L7
 251              		.loc 1 126 0 is_stmt 0 discriminator 1
 252 00d4 FFF7FEFF 		bl	idmanager_getIsDAGroot
 253 00d8 0346     		mov	r3, r0
 254 00da 002B     		cmp	r3, #0
 255 00dc 32D0     		beq	.L7
 256              	.LBB2:
 127:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			uint8_t whisper_target128[] = {
 257              		.loc 1 127 0 is_stmt 1
 258 00de 07F10803 		add	r3, r7, #8
 259 00e2 A74A     		ldr	r2, .L18
 260 00e4 1C46     		mov	r4, r3
 261 00e6 1346     		mov	r3, r2
 262 00e8 1868     		ldr	r0, [r3]	@ unaligned
 263 00ea 5968     		ldr	r1, [r3, #4]	@ unaligned
 264 00ec 9A68     		ldr	r2, [r3, #8]	@ unaligned
 265 00ee DB68     		ldr	r3, [r3, #12]	@ unaligned
 266 00f0 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 267              	.LBB3:
 128:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			   0xbb, 0xbb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
 129:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			   0x00, 0x12, 0x4b, 0x00, 0x06, 0x13, 0x06, 0x36
 130:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			};
 131:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 132:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //			   uint8_t whisper_target128[] = {
 133:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //			   	0xbb, 0xbb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
 134:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //				0x14, 0x15, 0x92, 0xcc, 0x00, 0x00, 0x00, 0x03
 135:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //			   };
 136:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 137:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			//printf("I am node %d, FORWARDING packet DIO FAKE \n",idmanager_getMyID(ADDR_64B)->addr_64b[7])
 138:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			//whisper_target128[15]=whisper_getTargetParentOld();
 139:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 140:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			if (whisper_getTargetParentOld()==0x55){
 268              		.loc 1 140 0
 269 00f2 FFF7FEFF 		bl	whisper_getTargetParentOld
 270 00f6 0346     		mov	r3, r0
 271 00f8 552B     		cmp	r3, #85
 272 00fa 08D1     		bne	.L8
 141:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 				whisper_target128[14]=0x06;
 273              		.loc 1 141 0
 274 00fc 07F10803 		add	r3, r7, #8
 275 0100 0622     		movs	r2, #6
 276 0102 9A73     		strb	r2, [r3, #14]
 142:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 				whisper_target128[15]=0x55;
 277              		.loc 1 142 0
 278 0104 07F10803 		add	r3, r7, #8
 279 0108 5522     		movs	r2, #85
 280 010a DA73     		strb	r2, [r3, #15]
 281 010c 07E0     		b	.L9
 282              	.L8:
 143:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			}else{
 144:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 				whisper_target128[14]=0x0a;
 283              		.loc 1 144 0
 284 010e 07F10803 		add	r3, r7, #8
 285 0112 0A22     		movs	r2, #10
 286 0114 9A73     		strb	r2, [r3, #14]
 145:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 				whisper_target128[15]=0xac;
 287              		.loc 1 145 0
 288 0116 07F10803 		add	r3, r7, #8
 289 011a AC22     		movs	r2, #172
 290 011c DA73     		strb	r2, [r3, #15]
 291              	.L9:
 292              	.LBE3:
 146:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			}
 147:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 148:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			//printf("Setting source to %d in the FAKEDIO\n", whisper_target128[15]);
 149:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			// set source address of node 3
 150:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			msg->l3_sourceAdd.type=ADDR_128B;
 293              		.loc 1 150 0
 294 011e 3B1D     		adds	r3, r7, #4
 295 0120 1B68     		ldr	r3, [r3]
 296 0122 0322     		movs	r2, #3
 297 0124 83F82A20 		strb	r2, [r3, #42]
 151:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			memcpy(&(msg->l3_sourceAdd.addr_128b[0]),whisper_target128,16);
 298              		.loc 1 151 0
 299 0128 3B1D     		adds	r3, r7, #4
 300 012a 1B68     		ldr	r3, [r3]
 301 012c 03F12B02 		add	r2, r3, #43
 302 0130 07F10803 		add	r3, r7, #8
 303 0134 1446     		mov	r4, r2
 304 0136 1D46     		mov	r5, r3
 305 0138 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
 306 013a 2060     		str	r0, [r4]	@ unaligned
 307 013c 6160     		str	r1, [r4, #4]	@ unaligned
 308 013e A260     		str	r2, [r4, #8]	@ unaligned
 309 0140 E360     		str	r3, [r4, #12]	@ unaligned
 310              	.LBE2:
 126:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			uint8_t whisper_target128[] = {
 311              		.loc 1 126 0
 312 0142 36E0     		b	.L11
 313              	.L7:
 152:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		}else{
 153:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			// set source address (me)
 154:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			msg->l3_sourceAdd.type=ADDR_128B;
 314              		.loc 1 154 0
 315 0144 3B1D     		adds	r3, r7, #4
 316 0146 1B68     		ldr	r3, [r3]
 317 0148 0322     		movs	r2, #3
 318 014a 83F82A20 		strb	r2, [r3, #42]
 155:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			memcpy(&(msg->l3_sourceAdd.addr_128b[0]),myprefix->prefix,8);
 319              		.loc 1 155 0
 320 014e 3B1D     		adds	r3, r7, #4
 321 0150 1B68     		ldr	r3, [r3]
 322 0152 03F12B00 		add	r0, r3, #43
 323 0156 D7F84431 		ldr	r3, [r7, #324]
 324 015a 0133     		adds	r3, r3, #1
 325 015c 0822     		movs	r2, #8
 326 015e 1946     		mov	r1, r3
 327 0160 FFF7FEFF 		bl	memcpy
 156:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			memcpy(&(msg->l3_sourceAdd.addr_128b[8]),myadd64->addr_64b,8);
 328              		.loc 1 156 0
 329 0164 3B1D     		adds	r3, r7, #4
 330 0166 1B68     		ldr	r3, [r3]
 331 0168 03F13300 		add	r0, r3, #51
 332 016c D7F83031 		ldr	r3, [r7, #304]
 333 0170 0133     		adds	r3, r3, #1
 334 0172 0822     		movs	r2, #8
 335 0174 1946     		mov	r1, r3
 336 0176 FFF7FEFF 		bl	memcpy
 337 017a 1AE0     		b	.L11
 338              	.L6:
 157:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 158:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		}
 159:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 160:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 161:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 162:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //		// set source address (me)
 163:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //		msg->l3_sourceAdd.type=ADDR_128B;
 164:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //		memcpy(&(msg->l3_sourceAdd.addr_128b[0]),myprefix->prefix,8);
 165:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //		memcpy(&(msg->l3_sourceAdd.addr_128b[8]),myadd64->addr_64b,8);
 166:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }else{
 167:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			// set source address (me)
 168:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			msg->l3_sourceAdd.type=ADDR_128B;
 339              		.loc 1 168 0
 340 017c 3B1D     		adds	r3, r7, #4
 341 017e 1B68     		ldr	r3, [r3]
 342 0180 0322     		movs	r2, #3
 343 0182 83F82A20 		strb	r2, [r3, #42]
 169:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			memcpy(&(msg->l3_sourceAdd.addr_128b[0]),myprefix->prefix,8);
 344              		.loc 1 169 0
 345 0186 3B1D     		adds	r3, r7, #4
 346 0188 1B68     		ldr	r3, [r3]
 347 018a 03F12B00 		add	r0, r3, #43
 348 018e D7F84431 		ldr	r3, [r7, #324]
 349 0192 0133     		adds	r3, r3, #1
 350 0194 0822     		movs	r2, #8
 351 0196 1946     		mov	r1, r3
 352 0198 FFF7FEFF 		bl	memcpy
 170:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			memcpy(&(msg->l3_sourceAdd.addr_128b[8]),myadd64->addr_64b,8);
 353              		.loc 1 170 0
 354 019c 3B1D     		adds	r3, r7, #4
 355 019e 1B68     		ldr	r3, [r3]
 356 01a0 03F13300 		add	r0, r3, #51
 357 01a4 D7F83031 		ldr	r3, [r7, #304]
 358 01a8 0133     		adds	r3, r3, #1
 359 01aa 0822     		movs	r2, #8
 360 01ac 1946     		mov	r1, r3
 361 01ae FFF7FEFF 		bl	memcpy
 362              	.L11:
 171:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 	}
 172:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 173:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 174:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // initialize IPv6 header
 175:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     memset(&ipv6_outer_header,0,sizeof(ipv6_header_iht));
 363              		.loc 1 175 0
 364 01b2 07F1E803 		add	r3, r7, #232
 365 01b6 4822     		movs	r2, #72
 366 01b8 0021     		movs	r1, #0
 367 01ba 1846     		mov	r0, r3
 368 01bc FFF7FEFF 		bl	memset
 176:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     memset(&ipv6_inner_header,0,sizeof(ipv6_header_iht));
 369              		.loc 1 176 0
 370 01c0 07F1A003 		add	r3, r7, #160
 371 01c4 4822     		movs	r2, #72
 372 01c6 0021     		movs	r1, #0
 373 01c8 1846     		mov	r0, r3
 374 01ca FFF7FEFF 		bl	memset
 177:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 178:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // Set hop limit to the default in-network value as this packet is being
 179:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // sent from upper layer. This is done here as send_internal() is used by
 180:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // forwarding of packets as well which carry a hlim. This value is required
 181:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // to be set to a value as the following function can decrement it.
 182:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ipv6_inner_header.hop_limit     = IPHC_DEFAULT_HOP_LIMIT;
 375              		.loc 1 182 0
 376 01ce 4123     		movs	r3, #65
 377 01d0 87F8C030 		strb	r3, [r7, #192]
 183:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 184:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // create the RPL hop-by-hop option
 185:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 186:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     forwarding_createRplOption(
 378              		.loc 1 186 0
 379 01d4 07F19803 		add	r3, r7, #152
 380 01d8 0021     		movs	r1, #0
 381 01da 1846     		mov	r0, r3
 382 01dc FFF7FEFF 		bl	forwarding_createRplOption
 187:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       &rpl_option,      // rpl_option to fill in
 188:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       0x00              // flags
 189:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     );
 190:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
 191:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 192:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     forwarding_createDeadlineOption(
 383              		.loc 1 192 0
 384 01e0 07F16C03 		add	r3, r7, #108
 385 01e4 1846     		mov	r0, r3
 386 01e6 FFF7FEFF 		bl	forwarding_createDeadlineOption
 193:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       &deadline_option
 194:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     );
 195:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif    
 196:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 197:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     packetfunctions_ip128bToMac64b(&(msg->l3_destinationAdd),&temp_dest_prefix,&temp_dest_mac64b);
 387              		.loc 1 197 0
 388 01ea 3B1D     		adds	r3, r7, #4
 389 01ec 1B68     		ldr	r3, [r3]
 390 01ee 1933     		adds	r3, r3, #25
 391 01f0 07F14002 		add	r2, r7, #64
 392 01f4 07F15401 		add	r1, r7, #84
 393 01f8 1846     		mov	r0, r3
 394 01fa FFF7FEFF 		bl	packetfunctions_ip128bToMac64b
 198:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     //xv poipoi -- get the src prefix as well
 199:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     packetfunctions_ip128bToMac64b(&(msg->l3_sourceAdd),&temp_src_prefix,&temp_src_mac64b);
 395              		.loc 1 199 0
 396 01fe 3B1D     		adds	r3, r7, #4
 397 0200 1B68     		ldr	r3, [r3]
 398 0202 2A33     		adds	r3, r3, #42
 399 0204 07F11802 		add	r2, r7, #24
 400 0208 07F12C01 		add	r1, r7, #44
 401 020c 1846     		mov	r0, r3
 402 020e FFF7FEFF 		bl	packetfunctions_ip128bToMac64b
 200:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     //XV -poipoi we want to check if the source address prefix is the same as destination prefix
 201:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if (packetfunctions_sameAddress(&temp_dest_prefix,&temp_src_prefix)) {
 403              		.loc 1 201 0
 404 0212 07F12C02 		add	r2, r7, #44
 405 0216 07F15403 		add	r3, r7, #84
 406 021a 1146     		mov	r1, r2
 407 021c 1846     		mov	r0, r3
 408 021e FFF7FEFF 		bl	packetfunctions_sameAddress
 409 0222 0346     		mov	r3, r0
 410 0224 002B     		cmp	r3, #0
 411 0226 0ED0     		beq	.L12
 202:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          // same prefix use 64B address
 203:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          sam = IPHC_SAM_64B;
 412              		.loc 1 203 0
 413 0228 0123     		movs	r3, #1
 414 022a 87F83A31 		strb	r3, [r7, #314]
 204:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          dam = IPHC_DAM_64B;
 415              		.loc 1 204 0
 416 022e 0123     		movs	r3, #1
 417 0230 87F83731 		strb	r3, [r7, #311]
 205:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          p_dest = &temp_dest_mac64b;      
 418              		.loc 1 205 0
 419 0234 07F14003 		add	r3, r7, #64
 420 0238 C7F84031 		str	r3, [r7, #320]
 206:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          p_src  = &temp_src_mac64b; 
 421              		.loc 1 206 0
 422 023c 07F11803 		add	r3, r7, #24
 423 0240 C7F83C31 		str	r3, [r7, #316]
 424 0244 43E0     		b	.L13
 425              	.L12:
 207:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     } else {
 208:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         //not the same prefix. so the packet travels to another network
 209:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         //check if this is a source routing pkt. in case it is then the DAM is elided as it is in t
 210:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         if (packetfunctions_isBroadcastMulticast(&(msg->l3_destinationAdd))==FALSE){
 426              		.loc 1 210 0
 427 0246 3B1D     		adds	r3, r7, #4
 428 0248 1B68     		ldr	r3, [r3]
 429 024a 1933     		adds	r3, r3, #25
 430 024c 1846     		mov	r0, r3
 431 024e FFF7FEFF 		bl	packetfunctions_isBroadcastMulticast
 432 0252 0346     		mov	r3, r0
 433 0254 83F00103 		eor	r3, r3, #1
 434 0258 DBB2     		uxtb	r3, r3
 435 025a 002B     		cmp	r3, #0
 436 025c 24D0     		beq	.L14
 211:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             sam = IPHC_SAM_128B;
 437              		.loc 1 211 0
 438 025e 0023     		movs	r3, #0
 439 0260 87F83A31 		strb	r3, [r7, #314]
 212:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             dam = IPHC_DAM_128B;
 440              		.loc 1 212 0
 441 0264 0023     		movs	r3, #0
 442 0266 87F83731 		strb	r3, [r7, #311]
 213:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             p_dest = &(msg->l3_destinationAdd);
 443              		.loc 1 213 0
 444 026a 3B1D     		adds	r3, r7, #4
 445 026c 1B68     		ldr	r3, [r3]
 446 026e 1933     		adds	r3, r3, #25
 447 0270 C7F84031 		str	r3, [r7, #320]
 214:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             p_src = &(msg->l3_sourceAdd);
 448              		.loc 1 214 0
 449 0274 3B1D     		adds	r3, r7, #4
 450 0276 1B68     		ldr	r3, [r3]
 451 0278 2A33     		adds	r3, r3, #42
 452 027a C7F83C31 		str	r3, [r7, #316]
 215:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             
 216:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             ipv6_outer_header.src.type = ADDR_128B;
 453              		.loc 1 216 0
 454 027e 0323     		movs	r3, #3
 455 0280 87F80A31 		strb	r3, [r7, #266]
 217:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             memcpy(&ipv6_outer_header.src,p_src,sizeof(open_addr_t));
 456              		.loc 1 217 0
 457 0284 D7F83C21 		ldr	r2, [r7, #316]
 458 0288 07F58573 		add	r3, r7, #266
 459 028c 1568     		ldr	r5, [r2]	@ unaligned
 460 028e 5468     		ldr	r4, [r2, #4]	@ unaligned
 461 0290 9068     		ldr	r0, [r2, #8]	@ unaligned
 462 0292 D168     		ldr	r1, [r2, #12]	@ unaligned
 463 0294 1D60     		str	r5, [r3]	@ unaligned
 464 0296 5C60     		str	r4, [r3, #4]	@ unaligned
 465 0298 9860     		str	r0, [r3, #8]	@ unaligned
 466 029a D960     		str	r1, [r3, #12]	@ unaligned
 467 029c 127C     		ldrb	r2, [r2, #16]
 468 029e 1A74     		strb	r2, [r3, #16]
 218:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             ipv6_outer_header.hop_limit = IPHC_DEFAULT_HOP_LIMIT;
 469              		.loc 1 218 0
 470 02a0 4123     		movs	r3, #65
 471 02a2 87F80831 		strb	r3, [r7, #264]
 472 02a6 12E0     		b	.L13
 473              	.L14:
 219:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         } else {
 220:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****            // this is DIO, source address elided, multicast bit is set
 221:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             sam = IPHC_SAM_ELIDED;
 474              		.loc 1 221 0
 475 02a8 0323     		movs	r3, #3
 476 02aa 87F83A31 		strb	r3, [r7, #314]
 222:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             m   = IPHC_M_YES;
 477              		.loc 1 222 0
 478 02ae 0123     		movs	r3, #1
 479 02b0 87F83931 		strb	r3, [r7, #313]
 223:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             dam = IPHC_DAM_ELIDED;
 480              		.loc 1 223 0
 481 02b4 0323     		movs	r3, #3
 482 02b6 87F83731 		strb	r3, [r7, #311]
 224:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             p_dest = &(msg->l3_destinationAdd);
 483              		.loc 1 224 0
 484 02ba 3B1D     		adds	r3, r7, #4
 485 02bc 1B68     		ldr	r3, [r3]
 486 02be 1933     		adds	r3, r3, #25
 487 02c0 C7F84031 		str	r3, [r7, #320]
 225:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             p_src = &(msg->l3_sourceAdd);
 488              		.loc 1 225 0
 489 02c4 3B1D     		adds	r3, r7, #4
 490 02c6 1B68     		ldr	r3, [r3]
 491 02c8 2A33     		adds	r3, r3, #42
 492 02ca C7F83C31 		str	r3, [r7, #316]
 493              	.L13:
 226:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         }
 227:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
 228:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     //IPHC inner header and NHC IPv6 header will be added at here
 229:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 230:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if (msg->l4_protocol_compressed){
 494              		.loc 1 230 0
 495 02ce 3B1D     		adds	r3, r7, #4
 496 02d0 1B68     		ldr	r3, [r3]
 497 02d2 DB7B     		ldrb	r3, [r3, #15]	@ zero_extendqisi2
 498 02d4 002B     		cmp	r3, #0
 499 02d6 03D0     		beq	.L15
 231:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         next_header = IPHC_NH_COMPRESSED;
 500              		.loc 1 231 0
 501 02d8 0123     		movs	r3, #1
 502 02da 87F83631 		strb	r3, [r7, #310]
 503 02de 02E0     		b	.L16
 504              	.L15:
 232:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }else{
 233:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         next_header = IPHC_NH_INLINE;
 505              		.loc 1 233 0
 506 02e0 0023     		movs	r3, #0
 507 02e2 87F83631 		strb	r3, [r7, #310]
 508              	.L16:
 234:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
 235:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     iphc_prependIPv6Header(msg,
 509              		.loc 1 235 0
 510 02e6 BD6E     		ldr	r5, [r7, #104]
 511 02e8 3B1D     		adds	r3, r7, #4
 512 02ea 1B68     		ldr	r3, [r3]
 513 02ec 9B7B     		ldrb	r3, [r3, #14]	@ zero_extendqisi2
 514 02ee 97F80821 		ldrb	r2, [r7, #264]	@ zero_extendqisi2
 515 02f2 97F83911 		ldrb	r1, [r7, #313]	@ zero_extendqisi2
 516 02f6 0029     		cmp	r1, #0
 517 02f8 14BF     		ite	ne
 518 02fa 0121     		movne	r1, #1
 519 02fc 0021     		moveq	r1, #0
 520 02fe C9B2     		uxtb	r1, r1
 521 0300 97F83661 		ldrb	r6, [r7, #310]	@ zero_extendqisi2
 522 0304 381D     		adds	r0, r7, #4
 523 0306 0224     		movs	r4, #2
 524 0308 0B94     		str	r4, [sp, #44]
 525 030a D7F83C41 		ldr	r4, [r7, #316]
 526 030e 0A94     		str	r4, [sp, #40]
 527 0310 D7F84041 		ldr	r4, [r7, #320]
 528 0314 0994     		str	r4, [sp, #36]
 529 0316 97F83741 		ldrb	r4, [r7, #311]	@ zero_extendqisi2
 530 031a 0894     		str	r4, [sp, #32]
 531 031c 97F83841 		ldrb	r4, [r7, #312]	@ zero_extendqisi2
 532 0320 0794     		str	r4, [sp, #28]
 533 0322 0691     		str	r1, [sp, #24]
 534 0324 97F83A11 		ldrb	r1, [r7, #314]	@ zero_extendqisi2
 535 0328 0591     		str	r1, [sp, #20]
 536 032a 97F83B11 		ldrb	r1, [r7, #315]	@ zero_extendqisi2
 537 032e 0491     		str	r1, [sp, #16]
 538 0330 0021     		movs	r1, #0
 539 0332 0391     		str	r1, [sp, #12]
 540 0334 0292     		str	r2, [sp, #8]
 541 0336 0222     		movs	r2, #2
 542 0338 0192     		str	r2, [sp, #4]
 543 033a 0093     		str	r3, [sp]
 544 033c 3346     		mov	r3, r6
 545 033e 2A46     		mov	r2, r5
 546 0340 0321     		movs	r1, #3
 547 0342 0068     		ldr	r0, [r0]
 548 0344 FFF7FEFF 		bl	iphc_prependIPv6Header
 236:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 IPHC_TF_ELIDED,
 237:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 flow_label, // value_flowlabel
 238:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 next_header,
 239:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 msg->l4_protocol, // value nh. If compressed this is ignored as LOWPAN_NH is alread
 240:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 IPHC_HLIM_64,
 241:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 ipv6_outer_header.hop_limit,
 242:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 IPHC_CID_NO,
 243:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 sac,
 244:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 sam,
 245:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 m,
 246:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 dac,
 247:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 dam,
 248:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 p_dest,
 249:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 p_src,            
 250:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 PCKTSEND  
 251:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 );
 252:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // both of them are compressed
 253:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ipv6_outer_header.next_header_compressed = TRUE;
 549              		.loc 1 253 0
 550 0348 0123     		movs	r3, #1
 551 034a 87F8F030 		strb	r3, [r7, #240]
 254:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 255:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     //printf("I am node %d, forwarding done\n", idmanager_getMyID(ADDR_64B)->addr_64b[7]);
 256:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 257:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     return forwarding_send_internal_RoutingTable(
 552              		.loc 1 257 0
 553 034e 07F19804 		add	r4, r7, #152
 554 0352 07F1A002 		add	r2, r7, #160
 555 0356 07F1E801 		add	r1, r7, #232
 556 035a 381D     		adds	r0, r7, #4
 557 035c 0223     		movs	r3, #2
 558 035e 0293     		str	r3, [sp, #8]
 559 0360 07F16803 		add	r3, r7, #104
 560 0364 0193     		str	r3, [sp, #4]
 561 0366 07F16C03 		add	r3, r7, #108
 562 036a 0093     		str	r3, [sp]
 563 036c 2346     		mov	r3, r4
 564 036e 0068     		ldr	r0, [r0]
 565 0370 FFF7FEFF 		bl	forwarding_send_internal_RoutingTable
 566 0374 0346     		mov	r3, r0
 258:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         msg,
 259:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         &ipv6_outer_header,
 260:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         &ipv6_inner_header,
 261:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         &rpl_option,
 262:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 263:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         &deadline_option,
 264:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif        
 265:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         &flow_label,
 266:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         PCKTSEND
 267:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     );
 268:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** }
 567              		.loc 1 268 0
 568 0376 1846     		mov	r0, r3
 569 0378 07F5A677 		add	r7, r7, #332
 570              		.cfi_def_cfa_offset 20
 571 037c BD46     		mov	sp, r7
 572              		.cfi_def_cfa_register 13
 573              		@ sp needed
 574 037e F0BD     		pop	{r4, r5, r6, r7, pc}
 575              	.L19:
 576              		.align	2
 577              	.L18:
 578 0380 48000000 		.word	.LC0
 579              		.cfi_endproc
 580              	.LFE1:
 582              		.align	2
 583              		.global	forwarding_sendDone
 584              		.thumb
 585              		.thumb_func
 587              	forwarding_sendDone:
 588              	.LFB2:
 269:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 270:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** /**
 271:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \brief Indicates a packet has been sent.
 272:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 273:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in,out] msg   The packet just sent.
 274:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     error The outcome of sending it.
 275:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** */
 276:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** void forwarding_sendDone(OpenQueueEntry_t* msg, owerror_t error) {
 589              		.loc 1 276 0
 590              		.cfi_startproc
 591              		@ args = 0, pretend = 0, frame = 8
 592              		@ frame_needed = 1, uses_anonymous_args = 0
 593 0384 80B5     		push	{r7, lr}
 594              		.cfi_def_cfa_offset 8
 595              		.cfi_offset 7, -8
 596              		.cfi_offset 14, -4
 597 0386 82B0     		sub	sp, sp, #8
 598              		.cfi_def_cfa_offset 16
 599 0388 00AF     		add	r7, sp, #0
 600              		.cfi_def_cfa_register 7
 601 038a 7860     		str	r0, [r7, #4]
 602 038c 0B46     		mov	r3, r1
 603 038e FB70     		strb	r3, [r7, #3]
 277:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    
 278:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    // take ownership
 279:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    msg->owner = COMPONENT_FORWARDING;
 604              		.loc 1 279 0
 605 0390 7B68     		ldr	r3, [r7, #4]
 606 0392 1322     		movs	r2, #19
 607 0394 5A70     		strb	r2, [r3, #1]
 280:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    
 281:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    if (msg->creator==COMPONENT_RADIO || msg->creator==COMPONENT_FORWARDING) {
 608              		.loc 1 281 0
 609 0396 7B68     		ldr	r3, [r7, #4]
 610 0398 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 611 039a 072B     		cmp	r3, #7
 612 039c 03D0     		beq	.L21
 613              		.loc 1 281 0 is_stmt 0 discriminator 1
 614 039e 7B68     		ldr	r3, [r7, #4]
 615 03a0 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 616 03a2 132B     		cmp	r3, #19
 617 03a4 03D1     		bne	.L22
 618              	.L21:
 282:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       // this is a relayed packet
 283:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       
 284:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       // free packet
 285:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       openqueue_freePacketBuffer(msg);
 619              		.loc 1 285 0 is_stmt 1
 620 03a6 7868     		ldr	r0, [r7, #4]
 621 03a8 FFF7FEFF 		bl	openqueue_freePacketBuffer
 622 03ac 1DE0     		b	.L23
 623              	.L22:
 286:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    } else {
 287:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       // this is a packet created by this mote
 288:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       
 289:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       // indicate sendDone to upper layer
 290:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       switch(msg->l4_protocol) {
 624              		.loc 1 290 0
 625 03ae 7B68     		ldr	r3, [r7, #4]
 626 03b0 9B7B     		ldrb	r3, [r3, #14]	@ zero_extendqisi2
 627 03b2 112B     		cmp	r3, #17
 628 03b4 02D0     		beq	.L25
 629 03b6 3A2B     		cmp	r3, #58
 630 03b8 06D0     		beq	.L26
 631 03ba 0BE0     		b	.L27
 632              	.L25:
 291:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             break;
 292:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          case IANA_UDP:
 293:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             openudp_sendDone(msg,error);
 633              		.loc 1 293 0
 634 03bc FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
 635 03be 1946     		mov	r1, r3
 636 03c0 7868     		ldr	r0, [r7, #4]
 637 03c2 FFF7FEFF 		bl	openudp_sendDone
 294:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             break;
 638              		.loc 1 294 0
 639 03c6 10E0     		b	.L23
 640              	.L26:
 295:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          case IANA_ICMPv6:
 296:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             icmpv6_sendDone(msg,error);
 641              		.loc 1 296 0
 642 03c8 FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
 643 03ca 1946     		mov	r1, r3
 644 03cc 7868     		ldr	r0, [r7, #4]
 645 03ce FFF7FEFF 		bl	icmpv6_sendDone
 297:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             break;
 646              		.loc 1 297 0
 647 03d2 0AE0     		b	.L23
 648              	.L27:
 298:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          default:
 299:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             
 300:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // log error
 301:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             openserial_printCritical(
 302:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                COMPONENT_FORWARDING,
 303:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                ERR_WRONG_TRAN_PROTOCOL,
 304:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                (errorparameter_t)msg->l4_protocol,
 649              		.loc 1 304 0
 650 03d4 7B68     		ldr	r3, [r7, #4]
 651 03d6 9B7B     		ldrb	r3, [r3, #14]	@ zero_extendqisi2
 301:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                COMPONENT_FORWARDING,
 652              		.loc 1 301 0
 653 03d8 9AB2     		uxth	r2, r3
 654 03da 0023     		movs	r3, #0
 655 03dc 0621     		movs	r1, #6
 656 03de 1320     		movs	r0, #19
 657 03e0 FFF7FEFF 		bl	openserial_printCritical
 305:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                (errorparameter_t)0
 306:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             );
 307:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             
 308:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // free packet
 309:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             openqueue_freePacketBuffer(msg);
 658              		.loc 1 309 0
 659 03e4 7868     		ldr	r0, [r7, #4]
 660 03e6 FFF7FEFF 		bl	openqueue_freePacketBuffer
 661              	.L23:
 310:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       }
 311:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    }
 312:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** }
 662              		.loc 1 312 0
 663 03ea 00BF     		nop
 664 03ec 0837     		adds	r7, r7, #8
 665              		.cfi_def_cfa_offset 8
 666 03ee BD46     		mov	sp, r7
 667              		.cfi_def_cfa_register 13
 668              		@ sp needed
 669 03f0 80BD     		pop	{r7, pc}
 670              		.cfi_endproc
 671              	.LFE2:
 673 03f2 00BF     		.align	2
 674              		.global	forwarding_receive
 675              		.thumb
 676              		.thumb_func
 678              	forwarding_receive:
 679              	.LFB3:
 313:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 314:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** /**
 315:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \brief Indicates a packet was received.
 316:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 317:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in,out] msg               The packet just sent.
 318:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     ipv6_outer_header The information contained in the IPv6 header.
 319:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     ipv6_inner_header The hop-by-hop header present in the packet.
 320:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     rpl_option        The hop-by-hop options present in the packet.
 321:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** */
 322:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** void forwarding_receive(
 323:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       OpenQueueEntry_t*      msg,
 324:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       ipv6_header_iht*       ipv6_outer_header,
 325:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       ipv6_header_iht*       ipv6_inner_header,
 326:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED      
 327:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       deadline_option_ht*	 	 deadline_option,
 328:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif      
 329:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       rpl_option_ht*         rpl_option
 330:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ) {
 680              		.loc 1 330 0
 681              		.cfi_startproc
 682              		@ args = 4, pretend = 0, frame = 24
 683              		@ frame_needed = 1, uses_anonymous_args = 0
 684 03f4 80B5     		push	{r7, lr}
 685              		.cfi_def_cfa_offset 8
 686              		.cfi_offset 7, -8
 687              		.cfi_offset 14, -4
 688 03f6 8AB0     		sub	sp, sp, #40
 689              		.cfi_def_cfa_offset 48
 690 03f8 04AF     		add	r7, sp, #16
 691              		.cfi_def_cfa 7, 32
 692 03fa F860     		str	r0, [r7, #12]
 693 03fc B960     		str	r1, [r7, #8]
 694 03fe 7A60     		str	r2, [r7, #4]
 695 0400 3B60     		str	r3, [r7]
 331:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t flags;
 332:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint16_t senderRank;
 333:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    
 334:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // take ownership
 335:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     msg->owner                     = COMPONENT_FORWARDING;
 696              		.loc 1 335 0
 697 0402 FB68     		ldr	r3, [r7, #12]
 698 0404 1322     		movs	r2, #19
 699 0406 5A70     		strb	r2, [r3, #1]
 336:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 337:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 338:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // determine L4 protocol
 339:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // get information from ipv6_header
 340:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     msg->l4_protocol            = ipv6_inner_header->next_header;
 700              		.loc 1 340 0
 701 0408 7B68     		ldr	r3, [r7, #4]
 702 040a 5A7A     		ldrb	r2, [r3, #9]	@ zero_extendqisi2
 703 040c FB68     		ldr	r3, [r7, #12]
 704 040e 9A73     		strb	r2, [r3, #14]
 341:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     msg->l4_protocol_compressed = ipv6_inner_header->next_header_compressed;
 705              		.loc 1 341 0
 706 0410 7B68     		ldr	r3, [r7, #4]
 707 0412 1A7A     		ldrb	r2, [r3, #8]	@ zero_extendqisi2
 708 0414 FB68     		ldr	r3, [r7, #12]
 709 0416 DA73     		strb	r2, [r3, #15]
 342:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    
 343:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // populate packets metadata with L3 information
 344:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     memcpy(&(msg->l3_destinationAdd),&ipv6_inner_header->dest, sizeof(open_addr_t));
 710              		.loc 1 344 0
 711 0418 FB68     		ldr	r3, [r7, #12]
 712 041a 03F11900 		add	r0, r3, #25
 713 041e 7B68     		ldr	r3, [r7, #4]
 714 0420 3333     		adds	r3, r3, #51
 715 0422 1122     		movs	r2, #17
 716 0424 1946     		mov	r1, r3
 717 0426 FFF7FEFF 		bl	memcpy
 345:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     memcpy(&(msg->l3_sourceAdd),     &ipv6_inner_header->src,  sizeof(open_addr_t));
 718              		.loc 1 345 0
 719 042a FB68     		ldr	r3, [r7, #12]
 720 042c 03F12A00 		add	r0, r3, #42
 721 0430 7B68     		ldr	r3, [r7, #4]
 722 0432 2233     		adds	r3, r3, #34
 723 0434 1122     		movs	r2, #17
 724 0436 1946     		mov	r1, r3
 725 0438 FFF7FEFF 		bl	memcpy
 346:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 347:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if (
 348:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         (
 349:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             idmanager_isMyAddress(&(msg->l3_destinationAdd))
 726              		.loc 1 349 0
 727 043c FB68     		ldr	r3, [r7, #12]
 728 043e 1933     		adds	r3, r3, #25
 729 0440 1846     		mov	r0, r3
 730 0442 FFF7FEFF 		bl	idmanager_isMyAddress
 731 0446 0346     		mov	r3, r0
 347:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         (
 732              		.loc 1 347 0
 733 0448 002B     		cmp	r3, #0
 734 044a 07D1     		bne	.L29
 350:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             ||
 351:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             packetfunctions_isBroadcastMulticast(&(msg->l3_destinationAdd))
 735              		.loc 1 351 0
 736 044c FB68     		ldr	r3, [r7, #12]
 737 044e 1933     		adds	r3, r3, #25
 738 0450 1846     		mov	r0, r3
 739 0452 FFF7FEFF 		bl	packetfunctions_isBroadcastMulticast
 740 0456 0346     		mov	r3, r0
 350:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             ||
 741              		.loc 1 350 0
 742 0458 002B     		cmp	r3, #0
 743 045a 3CD0     		beq	.L30
 744              	.L29:
 352:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         )
 353:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         &&
 354:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         ipv6_outer_header->next_header!=IANA_IPv6ROUTE
 745              		.loc 1 354 0
 746 045c BB68     		ldr	r3, [r7, #8]
 747 045e 5B7A     		ldrb	r3, [r3, #9]	@ zero_extendqisi2
 353:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         ipv6_outer_header->next_header!=IANA_IPv6ROUTE
 748              		.loc 1 353 0
 749 0460 2B2B     		cmp	r3, #43
 750 0462 38D0     		beq	.L30
 355:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ) {
 356:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         if (ipv6_outer_header->src.type != ADDR_NONE || ipv6_outer_header->rhe_length){
 751              		.loc 1 356 0
 752 0464 BB68     		ldr	r3, [r7, #8]
 753 0466 93F82230 		ldrb	r3, [r3, #34]	@ zero_extendqisi2
 754 046a 002B     		cmp	r3, #0
 755 046c 04D1     		bne	.L31
 756              		.loc 1 356 0 is_stmt 0 discriminator 1
 757 046e BB68     		ldr	r3, [r7, #8]
 758 0470 93F82130 		ldrb	r3, [r3, #33]	@ zero_extendqisi2
 759 0474 002B     		cmp	r3, #0
 760 0476 0BD0     		beq	.L32
 761              	.L31:
 357:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             packetfunctions_tossHeader(msg,ipv6_outer_header->header_length + ipv6_outer_header->rh
 762              		.loc 1 357 0 is_stmt 1
 763 0478 BB68     		ldr	r3, [r7, #8]
 764 047a 93F84420 		ldrb	r2, [r3, #68]	@ zero_extendqisi2
 765 047e BB68     		ldr	r3, [r7, #8]
 766 0480 93F82130 		ldrb	r3, [r3, #33]	@ zero_extendqisi2
 767 0484 1344     		add	r3, r3, r2
 768 0486 DBB2     		uxtb	r3, r3
 769 0488 1946     		mov	r1, r3
 770 048a F868     		ldr	r0, [r7, #12]
 771 048c FFF7FEFF 		bl	packetfunctions_tossHeader
 772              	.L32:
 358:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         }
 359:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         // this packet is for me, no source routing header // toss iphc inner header
 360:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         packetfunctions_tossHeader(msg,ipv6_inner_header->header_length);
 773              		.loc 1 360 0
 774 0490 7B68     		ldr	r3, [r7, #4]
 775 0492 93F84430 		ldrb	r3, [r3, #68]	@ zero_extendqisi2
 776 0496 1946     		mov	r1, r3
 777 0498 F868     		ldr	r0, [r7, #12]
 778 049a FFF7FEFF 		bl	packetfunctions_tossHeader
 361:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         // indicate received packet to upper layer
 362:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         switch(msg->l4_protocol) {
 779              		.loc 1 362 0
 780 049e FB68     		ldr	r3, [r7, #12]
 781 04a0 9B7B     		ldrb	r3, [r3, #14]	@ zero_extendqisi2
 782 04a2 112B     		cmp	r3, #17
 783 04a4 02D0     		beq	.L34
 784 04a6 3A2B     		cmp	r3, #58
 785 04a8 04D0     		beq	.L35
 786 04aa 07E0     		b	.L45
 787              	.L34:
 363:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             break;
 364:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         case IANA_UDP:
 365:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             openudp_receive(msg);
 788              		.loc 1 365 0
 789 04ac F868     		ldr	r0, [r7, #12]
 790 04ae FFF7FEFF 		bl	openudp_receive
 366:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             break;
 791              		.loc 1 366 0
 792 04b2 0FE0     		b	.L36
 793              	.L35:
 367:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         case IANA_ICMPv6:
 368:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             icmpv6_receive(msg);
 794              		.loc 1 368 0
 795 04b4 F868     		ldr	r0, [r7, #12]
 796 04b6 FFF7FEFF 		bl	icmpv6_receive
 369:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             break;
 797              		.loc 1 369 0
 798 04ba 0BE0     		b	.L36
 799              	.L45:
 370:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         default:
 371:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // log error
 372:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             openserial_printError(
 373:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 COMPONENT_FORWARDING,ERR_WRONG_TRAN_PROTOCOL,
 374:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 (errorparameter_t)msg->l4_protocol,
 800              		.loc 1 374 0
 801 04bc FB68     		ldr	r3, [r7, #12]
 802 04be 9B7B     		ldrb	r3, [r3, #14]	@ zero_extendqisi2
 372:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 COMPONENT_FORWARDING,ERR_WRONG_TRAN_PROTOCOL,
 803              		.loc 1 372 0
 804 04c0 9AB2     		uxth	r2, r3
 805 04c2 0123     		movs	r3, #1
 806 04c4 0621     		movs	r1, #6
 807 04c6 1320     		movs	r0, #19
 808 04c8 FFF7FEFF 		bl	openserial_printError
 375:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 (errorparameter_t)1
 376:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             );
 377:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             
 378:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // free packet
 379:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             openqueue_freePacketBuffer(msg);
 809              		.loc 1 379 0
 810 04cc F868     		ldr	r0, [r7, #12]
 811 04ce FFF7FEFF 		bl	openqueue_freePacketBuffer
 380:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         }
 381:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     } else {
 812              		.loc 1 381 0
 813 04d2 8EE0     		b	.L28
 814              	.L36:
 815 04d4 8DE0     		b	.L28
 816              	.L30:
 382:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         // this packet is not for me: relay
 383:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       
 384:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         // change the creator of the packet
 385:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         msg->creator = COMPONENT_FORWARDING;
 817              		.loc 1 385 0
 818 04d6 FB68     		ldr	r3, [r7, #12]
 819 04d8 1322     		movs	r2, #19
 820 04da 1A70     		strb	r2, [r3]
 386:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         
 387:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 388:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         if (deadline_option != NULL) {       
 821              		.loc 1 388 0
 822 04dc 3B68     		ldr	r3, [r7]
 823 04de 002B     		cmp	r3, #0
 824 04e0 1BD0     		beq	.L38
 389:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // Deadline Option : Drop 
 390:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             if( (deadline_option->time_left <= 0) && (deadline_option->d_flag == 1) ) { // packet e
 825              		.loc 1 390 0
 826 04e2 3B68     		ldr	r3, [r7]
 827 04e4 B3F91330 		ldrsh	r3, [r3, #19]	@ unaligned
 828 04e8 1BB2     		sxth	r3, r3
 829 04ea 002B     		cmp	r3, #0
 830 04ec 15DC     		bgt	.L38
 831              		.loc 1 390 0 is_stmt 0 discriminator 1
 832 04ee 3B68     		ldr	r3, [r7]
 833 04f0 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 834 04f2 03F00203 		and	r3, r3, #2
 835 04f6 DBB2     		uxtb	r3, r3
 836 04f8 002B     		cmp	r3, #0
 837 04fa 0ED0     		beq	.L38
 391:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                deadline_option->time_left = 0;         
 838              		.loc 1 391 0 is_stmt 1
 839 04fc 3B68     		ldr	r3, [r7]
 840 04fe 0022     		movs	r2, #0
 841 0500 DA74     		strb	r2, [r3, #19]
 842 0502 0022     		movs	r2, #0
 843 0504 1A75     		strb	r2, [r3, #20]
 392:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                openserial_printError(
 844              		.loc 1 392 0
 845 0506 0023     		movs	r3, #0
 846 0508 0022     		movs	r2, #0
 847 050a 4321     		movs	r1, #67
 848 050c 1320     		movs	r0, #19
 849 050e FFF7FEFF 		bl	openserial_printError
 393:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                          COMPONENT_FORWARDING,
 394:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                          ERR_6LORH_DEADLINE_DROPPED,
 395:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                          (errorparameter_t)0,
 396:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                          (errorparameter_t)0
 397:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                );           
 398:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                openqueue_freePacketBuffer(msg);
 850              		.loc 1 398 0
 851 0512 F868     		ldr	r0, [r7, #12]
 852 0514 FFF7FEFF 		bl	openqueue_freePacketBuffer
 399:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                return;
 853              		.loc 1 399 0
 854 0518 6BE0     		b	.L28
 855              	.L38:
 400:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****            }
 401:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****        }
 402:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif        
 403:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         
 404:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         if(openqueue_isHighPriorityEntryEnough()==FALSE){
 856              		.loc 1 404 0
 857 051a FFF7FEFF 		bl	openqueue_isHighPriorityEntryEnough
 858 051e 0346     		mov	r3, r0
 859 0520 83F00103 		eor	r3, r3, #1
 860 0524 DBB2     		uxtb	r3, r3
 861 0526 002B     		cmp	r3, #0
 862 0528 03D0     		beq	.L39
 405:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****           // after change the creator to COMPONENT_FORWARDING,
 406:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****           // there is no space for high priority packet, drop this message
 407:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****           // by free the buffer.
 408:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****           openqueue_freePacketBuffer(msg);
 863              		.loc 1 408 0
 864 052a F868     		ldr	r0, [r7, #12]
 865 052c FFF7FEFF 		bl	openqueue_freePacketBuffer
 409:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****           return;
 866              		.loc 1 409 0
 867 0530 5FE0     		b	.L28
 868              	.L39:
 410:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         }
 411:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       
 412:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         if (ipv6_outer_header->next_header!=IANA_IPv6ROUTE) {
 869              		.loc 1 412 0
 870 0532 BB68     		ldr	r3, [r7, #8]
 871 0534 5B7A     		ldrb	r3, [r3, #9]	@ zero_extendqisi2
 872 0536 2B2B     		cmp	r3, #43
 873 0538 4AD0     		beq	.L40
 413:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             flags = rpl_option->flags;
 874              		.loc 1 413 0
 875 053a 3B6A     		ldr	r3, [r7, #32]
 876 053c 5B78     		ldrb	r3, [r3, #1]
 877 053e FB75     		strb	r3, [r7, #23]
 414:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             senderRank = rpl_option->senderRank;
 878              		.loc 1 414 0
 879 0540 3B6A     		ldr	r3, [r7, #32]
 880 0542 DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 881 0544 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 882 0546 1B02     		lsls	r3, r3, #8
 883 0548 1343     		orrs	r3, r3, r2
 884 054a BB82     		strh	r3, [r7, #20]	@ movhi
 415:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             if ((flags & O_FLAG)!=0){
 885              		.loc 1 415 0
 886 054c FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 887 054e 03F01003 		and	r3, r3, #16
 888 0552 002B     		cmp	r3, #0
 889 0554 06D0     		beq	.L41
 416:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 // wrong direction
 417:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 // log error
 418:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 openserial_printError(
 890              		.loc 1 418 0
 891 0556 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 892 0558 9AB2     		uxth	r2, r3
 893 055a BB8A     		ldrh	r3, [r7, #20]
 894 055c 1321     		movs	r1, #19
 895 055e 1320     		movs	r0, #19
 896 0560 FFF7FEFF 		bl	openserial_printError
 897              	.L41:
 419:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     COMPONENT_FORWARDING,
 420:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     ERR_WRONG_DIRECTION,
 421:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     (errorparameter_t)flags,
 422:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     (errorparameter_t)senderRank
 423:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 );
 424:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             }
 425:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             if (senderRank < icmpv6rpl_getMyDAGrank()){
 898              		.loc 1 425 0
 899 0564 FFF7FEFF 		bl	icmpv6rpl_getMyDAGrank
 900 0568 0346     		mov	r3, r0
 901 056a 1A46     		mov	r2, r3
 902 056c BB8A     		ldrh	r3, [r7, #20]
 903 056e 9342     		cmp	r3, r2
 904 0570 0ED2     		bcs	.L42
 426:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 // loop detected
 427:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 // set flag
 428:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 rpl_option->flags |= R_FLAG;
 905              		.loc 1 428 0
 906 0572 3B6A     		ldr	r3, [r7, #32]
 907 0574 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 908 0576 43F00803 		orr	r3, r3, #8
 909 057a DAB2     		uxtb	r2, r3
 910 057c 3B6A     		ldr	r3, [r7, #32]
 911 057e 5A70     		strb	r2, [r3, #1]
 429:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 // log error
 430:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 openserial_printError(
 431:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     COMPONENT_FORWARDING,
 432:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     ERR_LOOP_DETECTED,
 433:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     (errorparameter_t) senderRank,
 434:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     (errorparameter_t) icmpv6rpl_getMyDAGrank()
 912              		.loc 1 434 0
 913 0580 FFF7FEFF 		bl	icmpv6rpl_getMyDAGrank
 914 0584 0346     		mov	r3, r0
 430:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     COMPONENT_FORWARDING,
 915              		.loc 1 430 0
 916 0586 BA8A     		ldrh	r2, [r7, #20]
 917 0588 1221     		movs	r1, #18
 918 058a 1320     		movs	r0, #19
 919 058c FFF7FEFF 		bl	openserial_printError
 920              	.L42:
 435:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 );
 436:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             }
 437:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             forwarding_createRplOption(rpl_option, rpl_option->flags);
 921              		.loc 1 437 0
 922 0590 3B6A     		ldr	r3, [r7, #32]
 923 0592 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 924 0594 1946     		mov	r1, r3
 925 0596 386A     		ldr	r0, [r7, #32]
 926 0598 FFF7FEFF 		bl	forwarding_createRplOption
 438:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             
 439:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 440:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             if (deadline_option != NULL)
 927              		.loc 1 440 0
 928 059c 3B68     		ldr	r3, [r7]
 929 059e 002B     		cmp	r3, #0
 930 05a0 02D0     		beq	.L43
 441:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 forwarding_createDeadlineOption(deadline_option);
 931              		.loc 1 441 0
 932 05a2 3868     		ldr	r0, [r7]
 933 05a4 FFF7FEFF 		bl	forwarding_createDeadlineOption
 934              	.L43:
 442:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif
 443:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             
 444:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // resend as if from upper layer
 445:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             if (
 446:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 forwarding_send_internal_RoutingTable(
 935              		.loc 1 446 0
 936 05a8 BB68     		ldr	r3, [r7, #8]
 937 05aa 0433     		adds	r3, r3, #4
 938 05ac 0122     		movs	r2, #1
 939 05ae 0292     		str	r2, [sp, #8]
 940 05b0 0193     		str	r3, [sp, #4]
 941 05b2 3B68     		ldr	r3, [r7]
 942 05b4 0093     		str	r3, [sp]
 943 05b6 3B6A     		ldr	r3, [r7, #32]
 944 05b8 7A68     		ldr	r2, [r7, #4]
 945 05ba B968     		ldr	r1, [r7, #8]
 946 05bc F868     		ldr	r0, [r7, #12]
 947 05be FFF7FEFF 		bl	forwarding_send_internal_RoutingTable
 948 05c2 0346     		mov	r3, r0
 445:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 forwarding_send_internal_RoutingTable(
 949              		.loc 1 445 0
 950 05c4 012B     		cmp	r3, #1
 951 05c6 14D1     		bne	.L28
 447:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     msg,
 448:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     ipv6_outer_header,
 449:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     ipv6_inner_header,
 450:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     rpl_option,
 451:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 452:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     deadline_option,
 453:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif                    
 454:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     &(ipv6_outer_header->flow_label),
 455:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     PCKTFORWARD 
 456:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 )==E_FAIL
 457:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             ) {
 458:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 openqueue_freePacketBuffer(msg);
 952              		.loc 1 458 0
 953 05c8 F868     		ldr	r0, [r7, #12]
 954 05ca FFF7FEFF 		bl	openqueue_freePacketBuffer
 955 05ce 10E0     		b	.L28
 956              	.L40:
 459:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             }
 460:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         } else {
 461:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // source routing header present
 462:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             if (
 463:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 forwarding_send_internal_SourceRouting(
 957              		.loc 1 463 0
 958 05d0 3B6A     		ldr	r3, [r7, #32]
 959 05d2 0093     		str	r3, [sp]
 960 05d4 3B68     		ldr	r3, [r7]
 961 05d6 7A68     		ldr	r2, [r7, #4]
 962 05d8 B968     		ldr	r1, [r7, #8]
 963 05da F868     		ldr	r0, [r7, #12]
 964 05dc FFF7FEFF 		bl	forwarding_send_internal_SourceRouting
 965 05e0 0346     		mov	r3, r0
 462:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 forwarding_send_internal_SourceRouting(
 966              		.loc 1 462 0
 967 05e2 012B     		cmp	r3, #1
 968 05e4 05D1     		bne	.L28
 464:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     msg,
 465:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     ipv6_outer_header,
 466:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     ipv6_inner_header,
 467:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 468:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     deadline_option,
 469:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif                    
 470:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     rpl_option
 471:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 )==E_FAIL
 472:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             ) {
 473:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 // log error
 474:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 openserial_printError(
 969              		.loc 1 474 0
 970 05e6 0023     		movs	r3, #0
 971 05e8 0022     		movs	r2, #0
 972 05ea 0F21     		movs	r1, #15
 973 05ec 1320     		movs	r0, #19
 974 05ee FFF7FEFF 		bl	openserial_printError
 975              	.L28:
 475:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     COMPONENT_FORWARDING,
 476:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     ERR_INVALID_FWDMODE,
 477:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     (errorparameter_t)0,
 478:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     (errorparameter_t)0
 479:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 );
 480:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             }
 481:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         }
 482:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
 483:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** }
 976              		.loc 1 483 0
 977 05f2 1837     		adds	r7, r7, #24
 978              		.cfi_def_cfa_offset 8
 979 05f4 BD46     		mov	sp, r7
 980              		.cfi_def_cfa_register 13
 981              		@ sp needed
 982 05f6 80BD     		pop	{r7, pc}
 983              		.cfi_endproc
 984              	.LFE3:
 986              		.align	2
 987              		.global	forwarding_getNextHopWhisper
 988              		.thumb
 989              		.thumb_func
 991              	forwarding_getNextHopWhisper:
 992              	.LFB4:
 484:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 485:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** void forwarding_getNextHopWhisper(open_addr_t* destination128b, open_addr_t* addressToWrite64b) {
 993              		.loc 1 485 0
 994              		.cfi_startproc
 995              		@ args = 0, pretend = 0, frame = 32
 996              		@ frame_needed = 1, uses_anonymous_args = 0
 997 05f8 80B5     		push	{r7, lr}
 998              		.cfi_def_cfa_offset 8
 999              		.cfi_offset 7, -8
 1000              		.cfi_offset 14, -4
 1001 05fa 88B0     		sub	sp, sp, #32
 1002              		.cfi_def_cfa_offset 40
 1003 05fc 00AF     		add	r7, sp, #0
 1004              		.cfi_def_cfa_register 7
 1005 05fe 7860     		str	r0, [r7, #4]
 1006 0600 3960     		str	r1, [r7]
 486:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 487:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    open_addr_t     temp_prefix64btoWrite;
 488:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 489:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 490:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    packetfunctions_ip128bToMac64b(destination128b,&temp_prefix64btoWrite,addressToWrite64b);
 1007              		.loc 1 490 0
 1008 0602 07F10C03 		add	r3, r7, #12
 1009 0606 3A68     		ldr	r2, [r7]
 1010 0608 1946     		mov	r1, r3
 1011 060a 7868     		ldr	r0, [r7, #4]
 1012 060c FFF7FEFF 		bl	packetfunctions_ip128bToMac64b
 491:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 492:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** }
 1013              		.loc 1 492 0
 1014 0610 00BF     		nop
 1015 0612 2037     		adds	r7, r7, #32
 1016              		.cfi_def_cfa_offset 8
 1017 0614 BD46     		mov	sp, r7
 1018              		.cfi_def_cfa_register 13
 1019              		@ sp needed
 1020 0616 80BD     		pop	{r7, pc}
 1021              		.cfi_endproc
 1022              	.LFE4:
 1024              		.align	2
 1025              		.global	forwarding_getNextHop
 1026              		.thumb
 1027              		.thumb_func
 1029              	forwarding_getNextHop:
 1030              	.LFB5:
 493:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 494:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //=========================== private =========================================
 495:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 496:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 497:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** /**
 498:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \brief Retrieve the next hop's address from routing table.
 499:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 500:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]  destination128b  Final IPv6 destination address.
 501:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[out] addressToWrite64b Location to write the EUI64 of next hop to.
 502:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** */
 503:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** void forwarding_getNextHop(open_addr_t* destination128b, open_addr_t* addressToWrite64b) {
 1031              		.loc 1 503 0
 1032              		.cfi_startproc
 1033              		@ args = 0, pretend = 0, frame = 32
 1034              		@ frame_needed = 1, uses_anonymous_args = 0
 1035 0618 80B5     		push	{r7, lr}
 1036              		.cfi_def_cfa_offset 8
 1037              		.cfi_offset 7, -8
 1038              		.cfi_offset 14, -4
 1039 061a 88B0     		sub	sp, sp, #32
 1040              		.cfi_def_cfa_offset 40
 1041 061c 00AF     		add	r7, sp, #0
 1042              		.cfi_def_cfa_register 7
 1043 061e 7860     		str	r0, [r7, #4]
 1044 0620 3960     		str	r1, [r7]
 504:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    uint8_t         i;
 505:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    open_addr_t     temp_prefix64btoWrite;
 506:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    
 507:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    if (packetfunctions_isBroadcastMulticast(destination128b)) {
 1045              		.loc 1 507 0
 1046 0622 7868     		ldr	r0, [r7, #4]
 1047 0624 FFF7FEFF 		bl	packetfunctions_isBroadcastMulticast
 1048 0628 0346     		mov	r3, r0
 1049 062a 002B     		cmp	r3, #0
 1050 062c 11D0     		beq	.L48
 508:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       // IP destination is broadcast, send to 0xffffffffffffffff
 509:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       addressToWrite64b->type = ADDR_64B;
 1051              		.loc 1 509 0
 1052 062e 3B68     		ldr	r3, [r7]
 1053 0630 0222     		movs	r2, #2
 1054 0632 1A70     		strb	r2, [r3]
 510:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       for (i=0;i<8;i++) {
 1055              		.loc 1 510 0
 1056 0634 0023     		movs	r3, #0
 1057 0636 FB77     		strb	r3, [r7, #31]
 1058 0638 07E0     		b	.L49
 1059              	.L50:
 511:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          addressToWrite64b->addr_64b[i] = 0xff;
 1060              		.loc 1 511 0 discriminator 3
 1061 063a FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 1062 063c 3A68     		ldr	r2, [r7]
 1063 063e 1344     		add	r3, r3, r2
 1064 0640 FF22     		movs	r2, #255
 1065 0642 5A70     		strb	r2, [r3, #1]
 510:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       for (i=0;i<8;i++) {
 1066              		.loc 1 510 0 discriminator 3
 1067 0644 FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 1068 0646 0133     		adds	r3, r3, #1
 1069 0648 FB77     		strb	r3, [r7, #31]
 1070              	.L49:
 510:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       for (i=0;i<8;i++) {
 1071              		.loc 1 510 0 is_stmt 0 discriminator 1
 1072 064a FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 1073 064c 072B     		cmp	r3, #7
 1074 064e F4D9     		bls	.L50
 512:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       }
 513:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    } else if (neighbors_isStableNeighbor(destination128b)) {
 514:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       // IP destination is 1-hop neighbor, send directly
 515:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       packetfunctions_ip128bToMac64b(destination128b,&temp_prefix64btoWrite,addressToWrite64b);
 516:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    } else {
 517:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       // destination is remote, send to preferred parent
 518:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       icmpv6rpl_getPreferredParentEui64(addressToWrite64b);
 519:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    }
 520:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** }
 1075              		.loc 1 520 0 is_stmt 1
 1076 0650 10E0     		b	.L53
 1077              	.L48:
 513:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       // IP destination is 1-hop neighbor, send directly
 1078              		.loc 1 513 0
 1079 0652 7868     		ldr	r0, [r7, #4]
 1080 0654 FFF7FEFF 		bl	neighbors_isStableNeighbor
 1081 0658 0346     		mov	r3, r0
 1082 065a 002B     		cmp	r3, #0
 1083 065c 07D0     		beq	.L52
 515:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    } else {
 1084              		.loc 1 515 0
 1085 065e 07F10C03 		add	r3, r7, #12
 1086 0662 3A68     		ldr	r2, [r7]
 1087 0664 1946     		mov	r1, r3
 1088 0666 7868     		ldr	r0, [r7, #4]
 1089 0668 FFF7FEFF 		bl	packetfunctions_ip128bToMac64b
 1090              		.loc 1 520 0
 1091 066c 02E0     		b	.L53
 1092              	.L52:
 518:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    }
 1093              		.loc 1 518 0
 1094 066e 3868     		ldr	r0, [r7]
 1095 0670 FFF7FEFF 		bl	icmpv6rpl_getPreferredParentEui64
 1096              	.L53:
 1097              		.loc 1 520 0
 1098 0674 00BF     		nop
 1099 0676 2037     		adds	r7, r7, #32
 1100              		.cfi_def_cfa_offset 8
 1101 0678 BD46     		mov	sp, r7
 1102              		.cfi_def_cfa_register 13
 1103              		@ sp needed
 1104 067a 80BD     		pop	{r7, pc}
 1105              		.cfi_endproc
 1106              	.LFE5:
 1108              		.section	.rodata
 1109              		.align	2
 1110              	.LC1:
 1111 0058 BB       		.byte	-69
 1112 0059 BB       		.byte	-69
 1113 005a 00       		.byte	0
 1114 005b 00       		.byte	0
 1115 005c 00       		.byte	0
 1116 005d 00       		.byte	0
 1117 005e 00       		.byte	0
 1118 005f 00       		.byte	0
 1119 0060 00       		.byte	0
 1120 0061 12       		.byte	18
 1121 0062 4B       		.byte	75
 1122 0063 00       		.byte	0
 1123 0064 06       		.byte	6
 1124 0065 13       		.byte	19
 1125 0066 0F       		.byte	15
 1126 0067 61       		.byte	97
 1127              		.text
 1128              		.align	2
 1129              		.global	forwarding_send_internal_RoutingTable
 1130              		.thumb
 1131              		.thumb_func
 1133              	forwarding_send_internal_RoutingTable:
 1134              	.LFB6:
 521:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 522:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** /**
 523:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \brief Send a packet using the routing table to find the next hop.
 524:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 525:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in,out] msg               The packet to send.
 526:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     ipv6_outer_header The packet's IPv6 outer header.
 527:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     ipv6_inner_header The packet's IPv6 inner header.
 528:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     rpl_option        The hop-by-hop option to add in this packet.
 529:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     flow_label        The flowlabel to add in the 6LoWPAN header.
 530:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     fw_SendOrfw_Rcv   The packet is originating from this mote
 531:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    (PCKTSEND), or forwarded (PCKTFORWARD).
 532:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** */
 533:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** owerror_t forwarding_send_internal_RoutingTable(
 534:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       OpenQueueEntry_t*      msg,
 535:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       ipv6_header_iht*       ipv6_outer_header,
 536:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       ipv6_header_iht*       ipv6_inner_header,
 537:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       rpl_option_ht*         rpl_option,
 538:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 539:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       deadline_option_ht*    deadline_option,
 540:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif      
 541:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       uint32_t*              flow_label,
 542:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       uint8_t                fw_SendOrfw_Rcv
 543:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    ) {
 1135              		.loc 1 543 0
 1136              		.cfi_startproc
 1137              		@ args = 12, pretend = 0, frame = 32
 1138              		@ frame_needed = 1, uses_anonymous_args = 0
 1139 067c B0B5     		push	{r4, r5, r7, lr}
 1140              		.cfi_def_cfa_offset 16
 1141              		.cfi_offset 4, -16
 1142              		.cfi_offset 5, -12
 1143              		.cfi_offset 7, -8
 1144              		.cfi_offset 14, -4
 1145 067e 8EB0     		sub	sp, sp, #56
 1146              		.cfi_def_cfa_offset 72
 1147 0680 06AF     		add	r7, sp, #24
 1148              		.cfi_def_cfa 7, 48
 1149 0682 F860     		str	r0, [r7, #12]
 1150 0684 B960     		str	r1, [r7, #8]
 1151 0686 7A60     		str	r2, [r7, #4]
 1152 0688 3B60     		str	r3, [r7]
 544:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    
 545:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 546:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    // retrieve the next hop from the routing table
 547:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    //forwarding_getNextHop(&(msg->l3_destinationAdd),&(msg->l2_nextORpreviousHop));
 548:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 549:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //   if (msg->isDioFake==TRUE){
 550:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //	// next hop is always direct
 551:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //	   forwarding_getNextHopWhisper(&(msg->l3_destinationAdd),&(msg->l2_nextORpreviousHop));
 552:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //
 553:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //   }else{
 554:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //	   // retrieve the next hop from the routing table
 555:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //	   forwarding_getNextHop(&(msg->l3_destinationAdd),&(msg->l2_nextORpreviousHop));
 556:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //   }
 557:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 558:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 559:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 560:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 561:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 562:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 	   if ((msg->isDioFake==TRUE) && (idmanager_getIsDAGroot()==TRUE) ){
 1153              		.loc 1 562 0
 1154 068a FB68     		ldr	r3, [r7, #12]
 1155 068c 93F84331 		ldrb	r3, [r3, #323]	@ zero_extendqisi2
 1156 0690 002B     		cmp	r3, #0
 1157 0692 40D0     		beq	.L55
 1158              		.loc 1 562 0 is_stmt 0 discriminator 1
 1159 0694 FFF7FEFF 		bl	idmanager_getIsDAGroot
 1160 0698 0346     		mov	r3, r0
 1161 069a 002B     		cmp	r3, #0
 1162 069c 3BD0     		beq	.L55
 1163              	.LBB4:
 563:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		// next hop is always direct
 564:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 565:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		   //printf("I am whisperroot node %d, Sending forwarding internal \n", idmanager_getMyID(ADDR_64
 566:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 567:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 568:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 569:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //			   uint8_t whisperroot_nexthop_to_target[] = {
 570:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //			   	0xbb, 0xbb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
 571:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //				0x14, 0x15, 0x92, 0xcc, 0x00, 0x00, 0x00, 0x02
 572:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** //			   };
 573:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 574:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 575:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			uint8_t whisperroot_nexthop_to_target[] = {
 1164              		.loc 1 575 0 is_stmt 1
 1165 069e 3A4B     		ldr	r3, .L62
 1166 06a0 07F11004 		add	r4, r7, #16
 1167 06a4 1868     		ldr	r0, [r3]	@ unaligned
 1168 06a6 5968     		ldr	r1, [r3, #4]	@ unaligned
 1169 06a8 9A68     		ldr	r2, [r3, #8]	@ unaligned
 1170 06aa DB68     		ldr	r3, [r3, #12]	@ unaligned
 1171 06ac 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 1172              	.LBB5:
 576:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 					   0xbb, 0xbb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
 577:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 					   0x00, 0x12, 0x4b, 0x00, 0x06, 0x13, 0x0f, 0x61
 578:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 				};
 579:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 580:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 581:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			if (whisper_getTargetParentOld()==0x55){
 1173              		.loc 1 581 0
 1174 06ae FFF7FEFF 		bl	whisper_getTargetParentOld
 1175 06b2 0346     		mov	r3, r0
 1176 06b4 552B     		cmp	r3, #85
 1177 06b6 02D1     		bne	.L56
 582:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 				whisperroot_nexthop_to_target[15]=0x61;
 1178              		.loc 1 582 0
 1179 06b8 6123     		movs	r3, #97
 1180 06ba FB77     		strb	r3, [r7, #31]
 1181 06bc 01E0     		b	.L57
 1182              	.L56:
 583:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			}else{
 584:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 				whisperroot_nexthop_to_target[15]=0x2b;
 1183              		.loc 1 584 0
 1184 06be 2B23     		movs	r3, #43
 1185 06c0 FB77     		strb	r3, [r7, #31]
 1186              	.L57:
 1187              	.LBE5:
 585:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			}
 586:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 587:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 588:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			//whisperroot_nexthop_to_target[15]=2;
 589:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			//printf("Setting source to %d in the FAKEDIO\n", whisperroot_target128[15]);
 590:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			// set source address of node 3
 591:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			msg->l3_sourceAdd.type=ADDR_128B;
 1188              		.loc 1 591 0
 1189 06c2 FB68     		ldr	r3, [r7, #12]
 1190 06c4 0322     		movs	r2, #3
 1191 06c6 83F82A20 		strb	r2, [r3, #42]
 592:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			memcpy(&(msg->l3_sourceAdd.addr_128b[0]),whisperroot_nexthop_to_target,16);
 1192              		.loc 1 592 0
 1193 06ca FB68     		ldr	r3, [r7, #12]
 1194 06cc 2B33     		adds	r3, r3, #43
 1195 06ce 1D46     		mov	r5, r3
 1196 06d0 07F11004 		add	r4, r7, #16
 1197 06d4 0FCC     		ldmia	r4!, {r0, r1, r2, r3}
 1198 06d6 2860     		str	r0, [r5]	@ unaligned
 1199 06d8 6960     		str	r1, [r5, #4]	@ unaligned
 1200 06da AA60     		str	r2, [r5, #8]	@ unaligned
 1201 06dc EB60     		str	r3, [r5, #12]	@ unaligned
 593:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			forwarding_getNextHopWhisper(&(msg->l3_destinationAdd),&(msg->l2_nextORpreviousHop));
 1202              		.loc 1 593 0
 1203 06de FB68     		ldr	r3, [r7, #12]
 1204 06e0 03F11902 		add	r2, r3, #25
 1205 06e4 FB68     		ldr	r3, [r7, #12]
 1206 06e6 3C33     		adds	r3, r3, #60
 1207 06e8 1946     		mov	r1, r3
 1208 06ea 1046     		mov	r0, r2
 1209 06ec FFF7FEFF 		bl	forwarding_getNextHopWhisper
 594:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 595:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			//whisperroot_nexthop_to_target[14]=0x0f;
 596:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		    //whisperroot_nexthop_to_target[15]=0x6b;
 597:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 598:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			//root
 599:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			whisperroot_nexthop_to_target[14]=0x0f;
 1210              		.loc 1 599 0
 1211 06f0 0F23     		movs	r3, #15
 1212 06f2 BB77     		strb	r3, [r7, #30]
 600:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		    whisperroot_nexthop_to_target[15]=0x6b;
 1213              		.loc 1 600 0
 1214 06f4 6B23     		movs	r3, #107
 1215 06f6 FB77     		strb	r3, [r7, #31]
 601:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 602:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		    //whisperroot_nexthop_to_target[15]=whisperroot_getTargetParentOld();
 603:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			//printf("Setting source to %d in the FAKEDIO\n", whisperroot_target128[15]);
 604:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			// set source address of node 3
 605:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			msg->l3_sourceAdd.type=ADDR_128B;
 1216              		.loc 1 605 0
 1217 06f8 FB68     		ldr	r3, [r7, #12]
 1218 06fa 0322     		movs	r2, #3
 1219 06fc 83F82A20 		strb	r2, [r3, #42]
 606:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			memcpy(&(msg->l3_sourceAdd.addr_128b[0]),whisperroot_nexthop_to_target,16);
 1220              		.loc 1 606 0
 1221 0700 FB68     		ldr	r3, [r7, #12]
 1222 0702 2B33     		adds	r3, r3, #43
 1223 0704 1D46     		mov	r5, r3
 1224 0706 07F11004 		add	r4, r7, #16
 1225 070a 0FCC     		ldmia	r4!, {r0, r1, r2, r3}
 1226 070c 2860     		str	r0, [r5]	@ unaligned
 1227 070e 6960     		str	r1, [r5, #4]	@ unaligned
 1228 0710 AA60     		str	r2, [r5, #8]	@ unaligned
 1229 0712 EB60     		str	r3, [r5, #12]	@ unaligned
 1230              	.LBE4:
 562:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		// next hop is always direct
 1231              		.loc 1 562 0
 1232 0714 08E0     		b	.L58
 1233              	.L55:
 607:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 608:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			//printf("I am WISHPER node %d, sending internal \n",idmanager_getMyID(ADDR_64B)->addr_64b[7]);
 609:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 610:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 611:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 			//printf("I am whisperroot node %d, mac addresses done, source add l3: %d ... %d \n", idmanager_
 612:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 613:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 	   }else{
 614:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 615:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 616:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		   //printf("I am NODE %d, this packet has source routing... \n", idmanager_getMyID(ADDR_64B)->ad
 617:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		   // retrieve the next hop from the routing table
 618:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		   forwarding_getNextHop(&(msg->l3_destinationAdd),&(msg->l2_nextORpreviousHop));
 1234              		.loc 1 618 0
 1235 0716 FB68     		ldr	r3, [r7, #12]
 1236 0718 03F11902 		add	r2, r3, #25
 1237 071c FB68     		ldr	r3, [r7, #12]
 1238 071e 3C33     		adds	r3, r3, #60
 1239 0720 1946     		mov	r1, r3
 1240 0722 1046     		mov	r0, r2
 1241 0724 FFF7FEFF 		bl	forwarding_getNextHop
 1242              	.L58:
 619:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		   //leds_debug_toggle();
 620:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 		   //printf("I am NODE %d, next hop is %d\n", idmanager_getMyID(ADDR_64B)->addr_64b[7],msg->l2_ne
 621:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 622:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 	   }
 623:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 624:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 	   //forwarding_getNextHop(&(msg->l3_destinationAdd),&(msg->l2_nextORpreviousHop));
 625:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 626:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    if (msg->l2_nextORpreviousHop.type==ADDR_NONE) {
 1243              		.loc 1 626 0
 1244 0728 FB68     		ldr	r3, [r7, #12]
 1245 072a 93F83C30 		ldrb	r3, [r3, #60]	@ zero_extendqisi2
 1246 072e 002B     		cmp	r3, #0
 1247 0730 07D1     		bne	.L59
 627:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       openserial_printError(
 1248              		.loc 1 627 0
 1249 0732 0023     		movs	r3, #0
 1250 0734 0022     		movs	r2, #0
 1251 0736 0D21     		movs	r1, #13
 1252 0738 1320     		movs	r0, #19
 1253 073a FFF7FEFF 		bl	openserial_printError
 628:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          COMPONENT_FORWARDING,
 629:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          ERR_NO_NEXTHOP,
 630:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          (errorparameter_t)0,
 631:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****          (errorparameter_t)0
 632:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       );
 633:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       return E_FAIL;
 1254              		.loc 1 633 0
 1255 073e 0123     		movs	r3, #1
 1256 0740 1DE0     		b	.L60
 1257              	.L59:
 634:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    }
 635:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    
 636:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    if (ipv6_outer_header->src.type != ADDR_NONE){
 1258              		.loc 1 636 0
 1259 0742 BB68     		ldr	r3, [r7, #8]
 1260 0744 93F82230 		ldrb	r3, [r3, #34]	@ zero_extendqisi2
 1261 0748 002B     		cmp	r3, #0
 1262 074a 06D0     		beq	.L61
 637:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       packetfunctions_tossHeader(msg,ipv6_outer_header->header_length);
 1263              		.loc 1 637 0
 1264 074c BB68     		ldr	r3, [r7, #8]
 1265 074e 93F84430 		ldrb	r3, [r3, #68]	@ zero_extendqisi2
 1266 0752 1946     		mov	r1, r3
 1267 0754 F868     		ldr	r0, [r7, #12]
 1268 0756 FFF7FEFF 		bl	packetfunctions_tossHeader
 1269              	.L61:
 638:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    }
 639:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    
 640:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    // send to next lower layer
 641:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    return iphc_sendFromForwarding(
 1270              		.loc 1 641 0
 1271 075a 97F83830 		ldrb	r3, [r7, #56]	@ zero_extendqisi2
 1272 075e 0493     		str	r3, [sp, #16]
 1273 0760 0023     		movs	r3, #0
 1274 0762 0393     		str	r3, [sp, #12]
 1275 0764 0023     		movs	r3, #0
 1276 0766 0293     		str	r3, [sp, #8]
 1277 0768 7B6B     		ldr	r3, [r7, #52]
 1278 076a 0193     		str	r3, [sp, #4]
 1279 076c 3B6B     		ldr	r3, [r7, #48]
 1280 076e 0093     		str	r3, [sp]
 1281 0770 3B68     		ldr	r3, [r7]
 1282 0772 7A68     		ldr	r2, [r7, #4]
 1283 0774 B968     		ldr	r1, [r7, #8]
 1284 0776 F868     		ldr	r0, [r7, #12]
 1285 0778 FFF7FEFF 		bl	iphc_sendFromForwarding
 1286 077c 0346     		mov	r3, r0
 1287              	.L60:
 642:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       msg,
 643:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       ipv6_outer_header,
 644:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       ipv6_inner_header,
 645:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       rpl_option,
 646:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 647:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       deadline_option,
 648:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif      
 649:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       flow_label,
 650:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       NULL,  // no rh3
 651:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       0,
 652:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       fw_SendOrfw_Rcv
 653:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    );
 654:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** }
 1288              		.loc 1 654 0
 1289 077e 1846     		mov	r0, r3
 1290 0780 2037     		adds	r7, r7, #32
 1291              		.cfi_def_cfa_offset 16
 1292 0782 BD46     		mov	sp, r7
 1293              		.cfi_def_cfa_register 13
 1294              		@ sp needed
 1295 0784 B0BD     		pop	{r4, r5, r7, pc}
 1296              	.L63:
 1297 0786 00BF     		.align	2
 1298              	.L62:
 1299 0788 58000000 		.word	.LC1
 1300              		.cfi_endproc
 1301              	.LFE6:
 1303              		.align	2
 1304              		.global	forwarding_send_internal_SourceRouting
 1305              		.thumb
 1306              		.thumb_func
 1308              	forwarding_send_internal_SourceRouting:
 1309              	.LFB7:
 655:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 656:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** /**
 657:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \brief Send a packet using the source rout to find the next hop.
 658:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 659:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \note This is always called for packets being forwarded.
 660:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 661:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** How to process the routing header is detailed in
 662:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** http://tools.ietf.org/html/rfc6554#page-9.
 663:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 664:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in,out] msg               The packet to send.
 665:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     ipv6_outer_header The packet's IPv6 outer header.
 666:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     ipv6_inner_header The packet's IPv6 inner header.
 667:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]     rpl_option        The hop-by-hop option to add in this packet.
 668:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** */
 669:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** owerror_t forwarding_send_internal_SourceRouting(
 670:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     OpenQueueEntry_t* msg,
 671:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ipv6_header_iht*  ipv6_outer_header,
 672:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ipv6_header_iht*  ipv6_inner_header,
 673:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 674:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     deadline_option_ht*	 	 deadline_option,
 675:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif    
 676:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     rpl_option_ht*    rpl_option
 677:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ) {
 1310              		.loc 1 677 0
 1311              		.cfi_startproc
 1312              		@ args = 4, pretend = 0, frame = 240
 1313              		@ frame_needed = 1, uses_anonymous_args = 0
 1314 078c B0B5     		push	{r4, r5, r7, lr}
 1315              		.cfi_def_cfa_offset 16
 1316              		.cfi_offset 4, -16
 1317              		.cfi_offset 5, -12
 1318              		.cfi_offset 7, -8
 1319              		.cfi_offset 14, -4
 1320 078e C2B0     		sub	sp, sp, #264
 1321              		.cfi_def_cfa_offset 280
 1322 0790 06AF     		add	r7, sp, #24
 1323              		.cfi_def_cfa 7, 256
 1324 0792 F860     		str	r0, [r7, #12]
 1325 0794 B960     		str	r1, [r7, #8]
 1326 0796 7A60     		str	r2, [r7, #4]
 1327 0798 3B60     		str	r3, [r7]
 678:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              temp_8b;
 679:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              type;
 680:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              next_type;
 681:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              size;
 682:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              next_size;
 683:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              hlen;
 684:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t          firstAddr;
 685:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t          nextAddr;
 686:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t          temp_prefix;
 687:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     open_addr_t          temp_addr64;
 688:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
 689:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              rpi_length;
 690:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              flags;
 691:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint16_t             senderRank;
 692:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
 693:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              RH_copy[127];
 694:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t              RH_length;
 695:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
 696:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t				 RH3_length;
 697:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 698:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t sizeRH=0;
 1328              		.loc 1 698 0
 1329 079a 0023     		movs	r3, #0
 1330 079c 87F8EB30 		strb	r3, [r7, #235]
 699:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 700:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     memset(&RH_copy[0],0,127);
 1331              		.loc 1 700 0
 1332 07a0 07F11403 		add	r3, r7, #20
 1333 07a4 7F22     		movs	r2, #127
 1334 07a6 0021     		movs	r1, #0
 1335 07a8 1846     		mov	r0, r3
 1336 07aa FFF7FEFF 		bl	memset
 701:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     RH3_length = 0;
 1337              		.loc 1 701 0
 1338 07ae 0023     		movs	r3, #0
 1339 07b0 87F8EA30 		strb	r3, [r7, #234]
 702:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     RH_length = 0;
 1340              		.loc 1 702 0
 1341 07b4 0023     		movs	r3, #0
 1342 07b6 87F8EC30 		strb	r3, [r7, #236]
 703:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     memcpy(&msg->l3_destinationAdd,&ipv6_inner_header->dest,sizeof(open_addr_t));
 1343              		.loc 1 703 0
 1344 07ba FB68     		ldr	r3, [r7, #12]
 1345 07bc 03F11900 		add	r0, r3, #25
 1346 07c0 7B68     		ldr	r3, [r7, #4]
 1347 07c2 3333     		adds	r3, r3, #51
 1348 07c4 1122     		movs	r2, #17
 1349 07c6 1946     		mov	r1, r3
 1350 07c8 FFF7FEFF 		bl	memcpy
 704:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     memcpy(&msg->l3_sourceAdd,&ipv6_inner_header->src,sizeof(open_addr_t));
 1351              		.loc 1 704 0
 1352 07cc FB68     		ldr	r3, [r7, #12]
 1353 07ce 03F12A00 		add	r0, r3, #42
 1354 07d2 7B68     		ldr	r3, [r7, #4]
 1355 07d4 2233     		adds	r3, r3, #34
 1356 07d6 1122     		movs	r2, #17
 1357 07d8 1946     		mov	r1, r3
 1358 07da FFF7FEFF 		bl	memcpy
 705:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
 706:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // initial first Address by compression reference
 707:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     firstAddr.type = ADDR_128B;
 1359              		.loc 1 707 0
 1360 07de 0323     		movs	r3, #3
 1361 07e0 87F8D030 		strb	r3, [r7, #208]
 708:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if (ipv6_outer_header->src.type != ADDR_NONE){
 1362              		.loc 1 708 0
 1363 07e4 BB68     		ldr	r3, [r7, #8]
 1364 07e6 93F82230 		ldrb	r3, [r3, #34]	@ zero_extendqisi2
 1365 07ea 002B     		cmp	r3, #0
 1366 07ec 0BD0     		beq	.L65
 709:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         if (rpl_option->rplInstanceID == 0){
 1367              		.loc 1 709 0
 1368 07ee D7F80031 		ldr	r3, [r7, #256]
 1369 07f2 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 1370 07f4 002B     		cmp	r3, #0
 1371 07f6 12D1     		bne	.L67
 710:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             icmpv6rpl_getRPLDODAGid(&firstAddr.addr_128b[0]);
 1372              		.loc 1 710 0
 1373 07f8 07F1D003 		add	r3, r7, #208
 1374 07fc 0133     		adds	r3, r3, #1
 1375 07fe 1846     		mov	r0, r3
 1376 0800 FFF7FEFF 		bl	icmpv6rpl_getRPLDODAGid
 1377 0804 0BE0     		b	.L67
 1378              	.L65:
 711:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         }
 712:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     } else {
 713:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         memcpy(&firstAddr,&ipv6_inner_header->src,sizeof(open_addr_t));
 1379              		.loc 1 713 0
 1380 0806 7B68     		ldr	r3, [r7, #4]
 1381 0808 2233     		adds	r3, r3, #34
 1382 080a 07F1D004 		add	r4, r7, #208
 1383 080e 1D46     		mov	r5, r3
 1384 0810 2868     		ldr	r0, [r5]	@ unaligned
 1385 0812 6968     		ldr	r1, [r5, #4]	@ unaligned
 1386 0814 AA68     		ldr	r2, [r5, #8]	@ unaligned
 1387 0816 EB68     		ldr	r3, [r5, #12]	@ unaligned
 1388 0818 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 1389 081a 2B7C     		ldrb	r3, [r5, #16]
 1390 081c 2370     		strb	r3, [r4]
 1391              	.L67:
 714:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
 715:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
 716:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     hlen = 0;
 1392              		.loc 1 716 0
 1393 081e 0023     		movs	r3, #0
 1394 0820 87F8ED30 		strb	r3, [r7, #237]
 717:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
 718:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     temp_8b = *((uint8_t*)(msg->payload)+hlen);
 1395              		.loc 1 718 0
 1396 0824 FB68     		ldr	r3, [r7, #12]
 1397 0826 5A68     		ldr	r2, [r3, #4]
 1398 0828 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1399 082c 1344     		add	r3, r3, r2
 1400 082e 1B78     		ldrb	r3, [r3]
 1401 0830 87F8EF30 		strb	r3, [r7, #239]
 719:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     type    = *((uint8_t*)(msg->payload)+hlen+1);
 1402              		.loc 1 719 0
 1403 0834 FB68     		ldr	r3, [r7, #12]
 1404 0836 5A68     		ldr	r2, [r3, #4]
 1405 0838 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1406 083c 0133     		adds	r3, r3, #1
 1407 083e 1344     		add	r3, r3, r2
 1408 0840 1B78     		ldrb	r3, [r3]
 1409 0842 87F8EE30 		strb	r3, [r7, #238]
 720:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
 721:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     //copy and toss any unknown 6LoRHE
 722:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     while((temp_8b&FORMAT_6LORH_MASK) == ELECTIVE_6LoRH){
 1410              		.loc 1 722 0
 1411 0846 34E0     		b	.L68
 1412              	.L69:
 723:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         sizeRH = temp_8b & IPINIP_LEN_6LORH_MASK;
 1413              		.loc 1 723 0
 1414 0848 97F8EF30 		ldrb	r3, [r7, #239]
 1415 084c 03F01F03 		and	r3, r3, #31
 1416 0850 87F8EB30 		strb	r3, [r7, #235]
 724:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     	memcpy(&RH_copy[RH_length], msg->payload, sizeRH+2);
 1417              		.loc 1 724 0
 1418 0854 97F8EC30 		ldrb	r3, [r7, #236]	@ zero_extendqisi2
 1419 0858 07F11402 		add	r2, r7, #20
 1420 085c D018     		adds	r0, r2, r3
 1421 085e FB68     		ldr	r3, [r7, #12]
 1422 0860 5968     		ldr	r1, [r3, #4]
 1423 0862 97F8EB30 		ldrb	r3, [r7, #235]	@ zero_extendqisi2
 1424 0866 0233     		adds	r3, r3, #2
 1425 0868 1A46     		mov	r2, r3
 1426 086a FFF7FEFF 		bl	memcpy
 725:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     	packetfunctions_tossHeader(msg, sizeRH+2);
 1427              		.loc 1 725 0
 1428 086e 97F8EB30 		ldrb	r3, [r7, #235]
 1429 0872 0233     		adds	r3, r3, #2
 1430 0874 DBB2     		uxtb	r3, r3
 1431 0876 1946     		mov	r1, r3
 1432 0878 F868     		ldr	r0, [r7, #12]
 1433 087a FFF7FEFF 		bl	packetfunctions_tossHeader
 726:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     	RH_length += 2 + sizeRH;
 1434              		.loc 1 726 0
 1435 087e 97F8EB20 		ldrb	r2, [r7, #235]
 1436 0882 97F8EC30 		ldrb	r3, [r7, #236]
 1437 0886 1344     		add	r3, r3, r2
 1438 0888 DBB2     		uxtb	r3, r3
 1439 088a 0233     		adds	r3, r3, #2
 1440 088c 87F8EC30 		strb	r3, [r7, #236]
 727:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         temp_8b = *((uint8_t*)(msg->payload)+hlen);
 1441              		.loc 1 727 0
 1442 0890 FB68     		ldr	r3, [r7, #12]
 1443 0892 5A68     		ldr	r2, [r3, #4]
 1444 0894 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1445 0898 1344     		add	r3, r3, r2
 1446 089a 1B78     		ldrb	r3, [r3]
 1447 089c 87F8EF30 		strb	r3, [r7, #239]
 728:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         type    = *((uint8_t*)(msg->payload)+hlen+1);
 1448              		.loc 1 728 0
 1449 08a0 FB68     		ldr	r3, [r7, #12]
 1450 08a2 5A68     		ldr	r2, [r3, #4]
 1451 08a4 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1452 08a8 0133     		adds	r3, r3, #1
 1453 08aa 1344     		add	r3, r3, r2
 1454 08ac 1B78     		ldrb	r3, [r3]
 1455 08ae 87F8EE30 		strb	r3, [r7, #238]
 1456              	.L68:
 722:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         sizeRH = temp_8b & IPINIP_LEN_6LORH_MASK;
 1457              		.loc 1 722 0
 1458 08b2 97F8EF30 		ldrb	r3, [r7, #239]	@ zero_extendqisi2
 1459 08b6 03F0E003 		and	r3, r3, #224
 1460 08ba A02B     		cmp	r3, #160
 1461 08bc C4D0     		beq	.L69
 729:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
 730:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 731:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     hlen += 2;
 1462              		.loc 1 731 0
 1463 08be 97F8ED30 		ldrb	r3, [r7, #237]
 1464 08c2 0233     		adds	r3, r3, #2
 1465 08c4 87F8ED30 		strb	r3, [r7, #237]
 732:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 733:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // get the first address
 734:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     switch(type){
 1466              		.loc 1 734 0
 1467 08c8 97F8EE30 		ldrb	r3, [r7, #238]	@ zero_extendqisi2
 1468 08cc 042B     		cmp	r3, #4
 1469 08ce 63D8     		bhi	.L70
 1470 08d0 01A2     		adr	r2, .L72
 1471 08d2 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 1472 08d6 00BF     		.p2align 2
 1473              	.L72:
 1474 08d8 ED080000 		.word	.L71+1
 1475 08dc 09090000 		.word	.L73+1
 1476 08e0 2D090000 		.word	.L74+1
 1477 08e4 51090000 		.word	.L75+1
 1478 08e8 75090000 		.word	.L76+1
 1479              		.p2align 1
 1480              	.L71:
 735:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     case RH3_6LOTH_TYPE_0:
 736:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         memcpy(&firstAddr.addr_128b[15],msg->payload+hlen,1);
 1481              		.loc 1 736 0
 1482 08ec FB68     		ldr	r3, [r7, #12]
 1483 08ee 5A68     		ldr	r2, [r3, #4]
 1484 08f0 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1485 08f4 1344     		add	r3, r3, r2
 1486 08f6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1487 08f8 87F8E030 		strb	r3, [r7, #224]
 737:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         hlen += 1;
 1488              		.loc 1 737 0
 1489 08fc 97F8ED30 		ldrb	r3, [r7, #237]
 1490 0900 0133     		adds	r3, r3, #1
 1491 0902 87F8ED30 		strb	r3, [r7, #237]
 738:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         break;
 1492              		.loc 1 738 0
 1493 0906 47E0     		b	.L70
 1494              	.L73:
 739:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     case RH3_6LOTH_TYPE_1:
 740:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         memcpy(&firstAddr.addr_128b[14],msg->payload+hlen,2);
 1495              		.loc 1 740 0
 1496 0908 FB68     		ldr	r3, [r7, #12]
 1497 090a 5A68     		ldr	r2, [r3, #4]
 1498 090c 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1499 0910 D118     		adds	r1, r2, r3
 1500 0912 07F1D003 		add	r3, r7, #208
 1501 0916 0F33     		adds	r3, r3, #15
 1502 0918 0222     		movs	r2, #2
 1503 091a 1846     		mov	r0, r3
 1504 091c FFF7FEFF 		bl	memcpy
 741:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         hlen += 2;
 1505              		.loc 1 741 0
 1506 0920 97F8ED30 		ldrb	r3, [r7, #237]
 1507 0924 0233     		adds	r3, r3, #2
 1508 0926 87F8ED30 		strb	r3, [r7, #237]
 742:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         break;
 1509              		.loc 1 742 0
 1510 092a 35E0     		b	.L70
 1511              	.L74:
 743:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     case RH3_6LOTH_TYPE_2:
 744:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         memcpy(&firstAddr.addr_128b[12],msg->payload+hlen,4);
 1512              		.loc 1 744 0
 1513 092c FB68     		ldr	r3, [r7, #12]
 1514 092e 5A68     		ldr	r2, [r3, #4]
 1515 0930 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1516 0934 D118     		adds	r1, r2, r3
 1517 0936 07F1D003 		add	r3, r7, #208
 1518 093a 0D33     		adds	r3, r3, #13
 1519 093c 0422     		movs	r2, #4
 1520 093e 1846     		mov	r0, r3
 1521 0940 FFF7FEFF 		bl	memcpy
 745:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         hlen += 4;
 1522              		.loc 1 745 0
 1523 0944 97F8ED30 		ldrb	r3, [r7, #237]
 1524 0948 0433     		adds	r3, r3, #4
 1525 094a 87F8ED30 		strb	r3, [r7, #237]
 746:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         break;
 1526              		.loc 1 746 0
 1527 094e 23E0     		b	.L70
 1528              	.L75:
 747:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     case RH3_6LOTH_TYPE_3:
 748:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         memcpy(&firstAddr.addr_128b[8],msg->payload+hlen,8);
 1529              		.loc 1 748 0
 1530 0950 FB68     		ldr	r3, [r7, #12]
 1531 0952 5A68     		ldr	r2, [r3, #4]
 1532 0954 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1533 0958 D118     		adds	r1, r2, r3
 1534 095a 07F1D003 		add	r3, r7, #208
 1535 095e 0933     		adds	r3, r3, #9
 1536 0960 0822     		movs	r2, #8
 1537 0962 1846     		mov	r0, r3
 1538 0964 FFF7FEFF 		bl	memcpy
 749:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         hlen += 8;
 1539              		.loc 1 749 0
 1540 0968 97F8ED30 		ldrb	r3, [r7, #237]
 1541 096c 0833     		adds	r3, r3, #8
 1542 096e 87F8ED30 		strb	r3, [r7, #237]
 750:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         break;
 1543              		.loc 1 750 0
 1544 0972 11E0     		b	.L70
 1545              	.L76:
 751:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     case RH3_6LOTH_TYPE_4:
 752:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         memcpy(&firstAddr.addr_128b[0],msg->payload+hlen,16);
 1546              		.loc 1 752 0
 1547 0974 FB68     		ldr	r3, [r7, #12]
 1548 0976 5A68     		ldr	r2, [r3, #4]
 1549 0978 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1550 097c D118     		adds	r1, r2, r3
 1551 097e 07F1D003 		add	r3, r7, #208
 1552 0982 0133     		adds	r3, r3, #1
 1553 0984 1022     		movs	r2, #16
 1554 0986 1846     		mov	r0, r3
 1555 0988 FFF7FEFF 		bl	memcpy
 753:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         hlen += 16;
 1556              		.loc 1 753 0
 1557 098c 97F8ED30 		ldrb	r3, [r7, #237]
 1558 0990 1033     		adds	r3, r3, #16
 1559 0992 87F8ED30 		strb	r3, [r7, #237]
 754:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         break;
 1560              		.loc 1 754 0
 1561 0996 00BF     		nop
 1562              	.L70:
 755:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
 756:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
 757:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     packetfunctions_ip128bToMac64b(&firstAddr,&temp_prefix,&temp_addr64);
 1563              		.loc 1 757 0
 1564 0998 07F19402 		add	r2, r7, #148
 1565 099c 07F1A801 		add	r1, r7, #168
 1566 09a0 07F1D003 		add	r3, r7, #208
 1567 09a4 1846     		mov	r0, r3
 1568 09a6 FFF7FEFF 		bl	packetfunctions_ip128bToMac64b
 758:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if (
 759:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         packetfunctions_sameAddress(&temp_prefix,idmanager_getMyID(ADDR_PREFIX)) &&
 1569              		.loc 1 759 0
 1570 09aa 0520     		movs	r0, #5
 1571 09ac FFF7FEFF 		bl	idmanager_getMyID
 1572 09b0 0246     		mov	r2, r0
 1573 09b2 07F1A803 		add	r3, r7, #168
 1574 09b6 1146     		mov	r1, r2
 1575 09b8 1846     		mov	r0, r3
 1576 09ba FFF7FEFF 		bl	packetfunctions_sameAddress
 1577 09be 0346     		mov	r3, r0
 758:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if (
 1578              		.loc 1 758 0
 1579 09c0 002B     		cmp	r3, #0
 1580 09c2 00F00B82 		beq	.L77
 760:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         packetfunctions_sameAddress(&temp_addr64,idmanager_getMyID(ADDR_64B))
 1581              		.loc 1 760 0
 1582 09c6 0220     		movs	r0, #2
 1583 09c8 FFF7FEFF 		bl	idmanager_getMyID
 1584 09cc 0246     		mov	r2, r0
 1585 09ce 07F19403 		add	r3, r7, #148
 1586 09d2 1146     		mov	r1, r2
 1587 09d4 1846     		mov	r0, r3
 1588 09d6 FFF7FEFF 		bl	packetfunctions_sameAddress
 1589 09da 0346     		mov	r3, r0
 759:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         packetfunctions_sameAddress(&temp_addr64,idmanager_getMyID(ADDR_64B))
 1590              		.loc 1 759 0
 1591 09dc 002B     		cmp	r3, #0
 1592 09de 00F0FD81 		beq	.L77
 761:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ){
 762:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         size = temp_8b & RH3_6LOTH_SIZE_MASK;
 1593              		.loc 1 762 0
 1594 09e2 97F8EF30 		ldrb	r3, [r7, #239]
 1595 09e6 03F01F03 		and	r3, r3, #31
 1596 09ea 87F8E930 		strb	r3, [r7, #233]
 763:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         if (size > 0){
 1597              		.loc 1 763 0
 1598 09ee 97F8E930 		ldrb	r3, [r7, #233]	@ zero_extendqisi2
 1599 09f2 002B     		cmp	r3, #0
 1600 09f4 74D0     		beq	.L78
 764:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // there are at least 2 entries in the header, 
 765:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // the router removes the first entry and decrements the Size (by 1) 
 766:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             size -= 1;
 1601              		.loc 1 766 0
 1602 09f6 97F8E930 		ldrb	r3, [r7, #233]
 1603 09fa 013B     		subs	r3, r3, #1
 1604 09fc 87F8E930 		strb	r3, [r7, #233]
 767:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             packetfunctions_tossHeader(msg,hlen);
 1605              		.loc 1 767 0
 1606 0a00 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1607 0a04 1946     		mov	r1, r3
 1608 0a06 F868     		ldr	r0, [r7, #12]
 1609 0a08 FFF7FEFF 		bl	packetfunctions_tossHeader
 768:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             packetfunctions_reserveHeaderSize(msg,2);
 1610              		.loc 1 768 0
 1611 0a0c 0221     		movs	r1, #2
 1612 0a0e F868     		ldr	r0, [r7, #12]
 1613 0a10 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 769:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             msg->payload[0] = CRITICAL_6LORH | size;
 1614              		.loc 1 769 0
 1615 0a14 FB68     		ldr	r3, [r7, #12]
 1616 0a16 5B68     		ldr	r3, [r3, #4]
 1617 0a18 97F8E920 		ldrb	r2, [r7, #233]
 1618 0a1c 62F07F02 		orn	r2, r2, #127
 1619 0a20 D2B2     		uxtb	r2, r2
 1620 0a22 1A70     		strb	r2, [r3]
 770:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             msg->payload[1] = type;
 1621              		.loc 1 770 0
 1622 0a24 FB68     		ldr	r3, [r7, #12]
 1623 0a26 5B68     		ldr	r3, [r3, #4]
 1624 0a28 0133     		adds	r3, r3, #1
 1625 0a2a 97F8EE20 		ldrb	r2, [r7, #238]
 1626 0a2e 1A70     		strb	r2, [r3]
 771:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // get next hop
 772:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             memcpy(&nextAddr,&firstAddr,sizeof(open_addr_t));
 1627              		.loc 1 772 0
 1628 0a30 07F1BC04 		add	r4, r7, #188
 1629 0a34 07F1D005 		add	r5, r7, #208
 1630 0a38 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
 1631 0a3a 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 1632 0a3c 2B68     		ldr	r3, [r5]
 1633 0a3e 2370     		strb	r3, [r4]
 773:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             switch(type){
 1634              		.loc 1 773 0
 1635 0a40 97F8EE30 		ldrb	r3, [r7, #238]	@ zero_extendqisi2
 1636 0a44 042B     		cmp	r3, #4
 1637 0a46 40D8     		bhi	.L79
 1638 0a48 01A2     		adr	r2, .L81
 1639 0a4a 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 1640 0a4e 00BF     		.p2align 2
 1641              	.L81:
 1642 0a50 650A0000 		.word	.L80+1
 1643 0a54 730A0000 		.word	.L82+1
 1644 0a58 890A0000 		.word	.L83+1
 1645 0a5c 9F0A0000 		.word	.L84+1
 1646 0a60 B50A0000 		.word	.L85+1
 1647              		.p2align 1
 1648              	.L80:
 774:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             case RH3_6LOTH_TYPE_0:
 775:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 memcpy(&nextAddr.addr_128b[15],msg->payload+2,1);
 1649              		.loc 1 775 0
 1650 0a64 FB68     		ldr	r3, [r7, #12]
 1651 0a66 5B68     		ldr	r3, [r3, #4]
 1652 0a68 0233     		adds	r3, r3, #2
 1653 0a6a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1654 0a6c 87F8CC30 		strb	r3, [r7, #204]
 776:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 break;
 1655              		.loc 1 776 0
 1656 0a70 2BE0     		b	.L79
 1657              	.L82:
 777:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             case RH3_6LOTH_TYPE_1:
 778:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 memcpy(&nextAddr.addr_128b[14],msg->payload+2,2);
 1658              		.loc 1 778 0
 1659 0a72 FB68     		ldr	r3, [r7, #12]
 1660 0a74 5B68     		ldr	r3, [r3, #4]
 1661 0a76 991C     		adds	r1, r3, #2
 1662 0a78 07F1BC03 		add	r3, r7, #188
 1663 0a7c 0F33     		adds	r3, r3, #15
 1664 0a7e 0222     		movs	r2, #2
 1665 0a80 1846     		mov	r0, r3
 1666 0a82 FFF7FEFF 		bl	memcpy
 779:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 break;
 1667              		.loc 1 779 0
 1668 0a86 20E0     		b	.L79
 1669              	.L83:
 780:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             case RH3_6LOTH_TYPE_2:
 781:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 memcpy(&nextAddr.addr_128b[12],msg->payload+2,4);
 1670              		.loc 1 781 0
 1671 0a88 FB68     		ldr	r3, [r7, #12]
 1672 0a8a 5B68     		ldr	r3, [r3, #4]
 1673 0a8c 991C     		adds	r1, r3, #2
 1674 0a8e 07F1BC03 		add	r3, r7, #188
 1675 0a92 0D33     		adds	r3, r3, #13
 1676 0a94 0422     		movs	r2, #4
 1677 0a96 1846     		mov	r0, r3
 1678 0a98 FFF7FEFF 		bl	memcpy
 782:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 break;
 1679              		.loc 1 782 0
 1680 0a9c 15E0     		b	.L79
 1681              	.L84:
 783:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             case RH3_6LOTH_TYPE_3:
 784:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 memcpy(&nextAddr.addr_128b[8],msg->payload+2,8);
 1682              		.loc 1 784 0
 1683 0a9e FB68     		ldr	r3, [r7, #12]
 1684 0aa0 5B68     		ldr	r3, [r3, #4]
 1685 0aa2 991C     		adds	r1, r3, #2
 1686 0aa4 07F1BC03 		add	r3, r7, #188
 1687 0aa8 0933     		adds	r3, r3, #9
 1688 0aaa 0822     		movs	r2, #8
 1689 0aac 1846     		mov	r0, r3
 1690 0aae FFF7FEFF 		bl	memcpy
 785:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 break;
 1691              		.loc 1 785 0
 1692 0ab2 0AE0     		b	.L79
 1693              	.L85:
 786:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             case RH3_6LOTH_TYPE_4:
 787:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 memcpy(&nextAddr.addr_128b[0],msg->payload+2,16);
 1694              		.loc 1 787 0
 1695 0ab4 FB68     		ldr	r3, [r7, #12]
 1696 0ab6 5B68     		ldr	r3, [r3, #4]
 1697 0ab8 991C     		adds	r1, r3, #2
 1698 0aba 07F1BC03 		add	r3, r7, #188
 1699 0abe 0133     		adds	r3, r3, #1
 1700 0ac0 1022     		movs	r2, #16
 1701 0ac2 1846     		mov	r0, r3
 1702 0ac4 FFF7FEFF 		bl	memcpy
 788:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 break;
 1703              		.loc 1 788 0
 1704 0ac8 00BF     		nop
 1705              	.L79:
 789:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             }
 790:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             packetfunctions_ip128bToMac64b(
 1706              		.loc 1 790 0
 1707 0aca FB68     		ldr	r3, [r7, #12]
 1708 0acc 03F13C02 		add	r2, r3, #60
 1709 0ad0 07F1A801 		add	r1, r7, #168
 1710 0ad4 07F1BC03 		add	r3, r7, #188
 1711 0ad8 1846     		mov	r0, r3
 1712 0ada FFF7FEFF 		bl	packetfunctions_ip128bToMac64b
 763:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // there are at least 2 entries in the header, 
 1713              		.loc 1 763 0
 1714 0ade 85E1     		b	.L111
 1715              	.L78:
 791:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 &nextAddr,
 792:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 &temp_prefix,
 793:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 &msg->l2_nextORpreviousHop
 794:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             );
 795:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         } else {
 796:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             temp_8b   = *((uint8_t*)(msg->payload)+hlen);
 1716              		.loc 1 796 0
 1717 0ae0 FB68     		ldr	r3, [r7, #12]
 1718 0ae2 5A68     		ldr	r2, [r3, #4]
 1719 0ae4 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1720 0ae8 1344     		add	r3, r3, r2
 1721 0aea 1B78     		ldrb	r3, [r3]
 1722 0aec 87F8EF30 		strb	r3, [r7, #239]
 797:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             next_type = *((uint8_t*)(msg->payload)+hlen+1);
 1723              		.loc 1 797 0
 1724 0af0 FB68     		ldr	r3, [r7, #12]
 1725 0af2 5A68     		ldr	r2, [r3, #4]
 1726 0af4 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1727 0af8 0133     		adds	r3, r3, #1
 1728 0afa 1344     		add	r3, r3, r2
 1729 0afc 1B78     		ldrb	r3, [r3]
 1730 0afe 87F8E830 		strb	r3, [r7, #232]
 798:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             if (
 799:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 (temp_8b & FORMAT_6LORH_MASK) == CRITICAL_6LORH &&
 1731              		.loc 1 799 0
 1732 0b02 97F8EF30 		ldrb	r3, [r7, #239]	@ zero_extendqisi2
 1733 0b06 03F0E003 		and	r3, r3, #224
 798:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             if (
 1734              		.loc 1 798 0
 1735 0b0a 802B     		cmp	r3, #128
 1736 0b0c 40F05381 		bne	.L87
 1737              		.loc 1 799 0
 1738 0b10 97F8E830 		ldrb	r3, [r7, #232]	@ zero_extendqisi2
 1739 0b14 042B     		cmp	r3, #4
 1740 0b16 00F24E81 		bhi	.L87
 800:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 next_type<=RH3_6LOTH_TYPE_4
 801:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             ) {
 802:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 // there is another RH3-6LoRH following, check the type
 803:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 if (next_type >= type){
 1741              		.loc 1 803 0
 1742 0b1a 97F8E820 		ldrb	r2, [r7, #232]	@ zero_extendqisi2
 1743 0b1e 97F8EE30 		ldrb	r3, [r7, #238]	@ zero_extendqisi2
 1744 0b22 9A42     		cmp	r2, r3
 1745 0b24 5CD3     		bcc	.L88
 804:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     packetfunctions_tossHeader(msg,hlen);
 1746              		.loc 1 804 0
 1747 0b26 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1748 0b2a 1946     		mov	r1, r3
 1749 0b2c F868     		ldr	r0, [r7, #12]
 1750 0b2e FFF7FEFF 		bl	packetfunctions_tossHeader
 805:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     // get next hop
 806:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     memcpy(&nextAddr,&firstAddr,sizeof(open_addr_t));
 1751              		.loc 1 806 0
 1752 0b32 07F1BC04 		add	r4, r7, #188
 1753 0b36 07F1D005 		add	r5, r7, #208
 1754 0b3a 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
 1755 0b3c 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 1756 0b3e 2B68     		ldr	r3, [r5]
 1757 0b40 2370     		strb	r3, [r4]
 807:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     switch(next_type){
 1758              		.loc 1 807 0
 1759 0b42 97F8E830 		ldrb	r3, [r7, #232]	@ zero_extendqisi2
 1760 0b46 042B     		cmp	r3, #4
 1761 0b48 3FD8     		bhi	.L89
 1762 0b4a 01A2     		adr	r2, .L91
 1763 0b4c 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 1764              		.p2align 2
 1765              	.L91:
 1766 0b50 650B0000 		.word	.L90+1
 1767 0b54 730B0000 		.word	.L92+1
 1768 0b58 890B0000 		.word	.L93+1
 1769 0b5c 9F0B0000 		.word	.L94+1
 1770 0b60 B50B0000 		.word	.L95+1
 1771              		.p2align 1
 1772              	.L90:
 808:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_0:
 809:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&nextAddr.addr_128b[15],msg->payload+2,1);
 1773              		.loc 1 809 0
 1774 0b64 FB68     		ldr	r3, [r7, #12]
 1775 0b66 5B68     		ldr	r3, [r3, #4]
 1776 0b68 0233     		adds	r3, r3, #2
 1777 0b6a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1778 0b6c 87F8CC30 		strb	r3, [r7, #204]
 810:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1779              		.loc 1 810 0
 1780 0b70 2BE0     		b	.L89
 1781              	.L92:
 811:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_1:
 812:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&nextAddr.addr_128b[14],msg->payload+2,2);
 1782              		.loc 1 812 0
 1783 0b72 FB68     		ldr	r3, [r7, #12]
 1784 0b74 5B68     		ldr	r3, [r3, #4]
 1785 0b76 991C     		adds	r1, r3, #2
 1786 0b78 07F1BC03 		add	r3, r7, #188
 1787 0b7c 0F33     		adds	r3, r3, #15
 1788 0b7e 0222     		movs	r2, #2
 1789 0b80 1846     		mov	r0, r3
 1790 0b82 FFF7FEFF 		bl	memcpy
 813:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1791              		.loc 1 813 0
 1792 0b86 20E0     		b	.L89
 1793              	.L93:
 814:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_2:
 815:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&nextAddr.addr_128b[12],msg->payload+2,4);
 1794              		.loc 1 815 0
 1795 0b88 FB68     		ldr	r3, [r7, #12]
 1796 0b8a 5B68     		ldr	r3, [r3, #4]
 1797 0b8c 991C     		adds	r1, r3, #2
 1798 0b8e 07F1BC03 		add	r3, r7, #188
 1799 0b92 0D33     		adds	r3, r3, #13
 1800 0b94 0422     		movs	r2, #4
 1801 0b96 1846     		mov	r0, r3
 1802 0b98 FFF7FEFF 		bl	memcpy
 816:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1803              		.loc 1 816 0
 1804 0b9c 15E0     		b	.L89
 1805              	.L94:
 817:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_3:
 818:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&nextAddr.addr_128b[8],msg->payload+2,8);
 1806              		.loc 1 818 0
 1807 0b9e FB68     		ldr	r3, [r7, #12]
 1808 0ba0 5B68     		ldr	r3, [r3, #4]
 1809 0ba2 991C     		adds	r1, r3, #2
 1810 0ba4 07F1BC03 		add	r3, r7, #188
 1811 0ba8 0933     		adds	r3, r3, #9
 1812 0baa 0822     		movs	r2, #8
 1813 0bac 1846     		mov	r0, r3
 1814 0bae FFF7FEFF 		bl	memcpy
 819:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1815              		.loc 1 819 0
 1816 0bb2 0AE0     		b	.L89
 1817              	.L95:
 820:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_4:
 821:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&nextAddr.addr_128b[0],msg->payload+2,16);
 1818              		.loc 1 821 0
 1819 0bb4 FB68     		ldr	r3, [r7, #12]
 1820 0bb6 5B68     		ldr	r3, [r3, #4]
 1821 0bb8 991C     		adds	r1, r3, #2
 1822 0bba 07F1BC03 		add	r3, r7, #188
 1823 0bbe 0133     		adds	r3, r3, #1
 1824 0bc0 1022     		movs	r2, #16
 1825 0bc2 1846     		mov	r0, r3
 1826 0bc4 FFF7FEFF 		bl	memcpy
 822:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1827              		.loc 1 822 0
 1828 0bc8 00BF     		nop
 1829              	.L89:
 823:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     }
 824:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     packetfunctions_ip128bToMac64b(
 1830              		.loc 1 824 0
 1831 0bca FB68     		ldr	r3, [r7, #12]
 1832 0bcc 03F13C02 		add	r2, r3, #60
 1833 0bd0 07F1A801 		add	r1, r7, #168
 1834 0bd4 07F1BC03 		add	r3, r7, #188
 1835 0bd8 1846     		mov	r0, r3
 1836 0bda FFF7FEFF 		bl	packetfunctions_ip128bToMac64b
 803:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     packetfunctions_tossHeader(msg,hlen);
 1837              		.loc 1 803 0
 1838 0bde FCE0     		b	.L86
 1839              	.L88:
 825:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         &nextAddr,
 826:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         &temp_prefix,
 827:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         &msg->l2_nextORpreviousHop
 828:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     );
 829:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 } else {
 830:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     hlen += 2;
 1840              		.loc 1 830 0
 1841 0be0 97F8ED30 		ldrb	r3, [r7, #237]
 1842 0be4 0233     		adds	r3, r3, #2
 1843 0be6 87F8ED30 		strb	r3, [r7, #237]
 831:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     switch(next_type){
 1844              		.loc 1 831 0
 1845 0bea 97F8E830 		ldrb	r3, [r7, #232]	@ zero_extendqisi2
 1846 0bee 032B     		cmp	r3, #3
 1847 0bf0 4ED8     		bhi	.L97
 1848 0bf2 01A2     		adr	r2, .L99
 1849 0bf4 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 1850              		.p2align 2
 1851              	.L99:
 1852 0bf8 090C0000 		.word	.L98+1
 1853 0bfc 250C0000 		.word	.L100+1
 1854 0c00 490C0000 		.word	.L101+1
 1855 0c04 6D0C0000 		.word	.L102+1
 1856              		.p2align 1
 1857              	.L98:
 832:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_0:
 833:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&firstAddr.addr_128b[15],msg->payload+hlen,1);
 1858              		.loc 1 833 0
 1859 0c08 FB68     		ldr	r3, [r7, #12]
 1860 0c0a 5A68     		ldr	r2, [r3, #4]
 1861 0c0c 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1862 0c10 1344     		add	r3, r3, r2
 1863 0c12 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1864 0c14 87F8E030 		strb	r3, [r7, #224]
 834:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         hlen += 1;
 1865              		.loc 1 834 0
 1866 0c18 97F8ED30 		ldrb	r3, [r7, #237]
 1867 0c1c 0133     		adds	r3, r3, #1
 1868 0c1e 87F8ED30 		strb	r3, [r7, #237]
 835:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1869              		.loc 1 835 0
 1870 0c22 35E0     		b	.L97
 1871              	.L100:
 836:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_1:
 837:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&firstAddr.addr_128b[14],msg->payload+hlen,2);
 1872              		.loc 1 837 0
 1873 0c24 FB68     		ldr	r3, [r7, #12]
 1874 0c26 5A68     		ldr	r2, [r3, #4]
 1875 0c28 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1876 0c2c D118     		adds	r1, r2, r3
 1877 0c2e 07F1D003 		add	r3, r7, #208
 1878 0c32 0F33     		adds	r3, r3, #15
 1879 0c34 0222     		movs	r2, #2
 1880 0c36 1846     		mov	r0, r3
 1881 0c38 FFF7FEFF 		bl	memcpy
 838:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         hlen += 2;
 1882              		.loc 1 838 0
 1883 0c3c 97F8ED30 		ldrb	r3, [r7, #237]
 1884 0c40 0233     		adds	r3, r3, #2
 1885 0c42 87F8ED30 		strb	r3, [r7, #237]
 839:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1886              		.loc 1 839 0
 1887 0c46 23E0     		b	.L97
 1888              	.L101:
 840:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_2:
 841:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&firstAddr.addr_128b[12],msg->payload+hlen,4);
 1889              		.loc 1 841 0
 1890 0c48 FB68     		ldr	r3, [r7, #12]
 1891 0c4a 5A68     		ldr	r2, [r3, #4]
 1892 0c4c 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1893 0c50 D118     		adds	r1, r2, r3
 1894 0c52 07F1D003 		add	r3, r7, #208
 1895 0c56 0D33     		adds	r3, r3, #13
 1896 0c58 0422     		movs	r2, #4
 1897 0c5a 1846     		mov	r0, r3
 1898 0c5c FFF7FEFF 		bl	memcpy
 842:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         hlen += 4;
 1899              		.loc 1 842 0
 1900 0c60 97F8ED30 		ldrb	r3, [r7, #237]
 1901 0c64 0433     		adds	r3, r3, #4
 1902 0c66 87F8ED30 		strb	r3, [r7, #237]
 843:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1903              		.loc 1 843 0
 1904 0c6a 11E0     		b	.L97
 1905              	.L102:
 844:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_3:
 845:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&firstAddr.addr_128b[8],msg->payload+hlen,8);
 1906              		.loc 1 845 0
 1907 0c6c FB68     		ldr	r3, [r7, #12]
 1908 0c6e 5A68     		ldr	r2, [r3, #4]
 1909 0c70 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1910 0c74 D118     		adds	r1, r2, r3
 1911 0c76 07F1D003 		add	r3, r7, #208
 1912 0c7a 0933     		adds	r3, r3, #9
 1913 0c7c 0822     		movs	r2, #8
 1914 0c7e 1846     		mov	r0, r3
 1915 0c80 FFF7FEFF 		bl	memcpy
 846:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         hlen += 8;
 1916              		.loc 1 846 0
 1917 0c84 97F8ED30 		ldrb	r3, [r7, #237]
 1918 0c88 0833     		adds	r3, r3, #8
 1919 0c8a 87F8ED30 		strb	r3, [r7, #237]
 847:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1920              		.loc 1 847 0
 1921 0c8e 00BF     		nop
 1922              	.L97:
 848:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     }
 849:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     next_size = temp_8b & RH3_6LOTH_SIZE_MASK;
 1923              		.loc 1 849 0
 1924 0c90 97F8EF30 		ldrb	r3, [r7, #239]
 1925 0c94 03F01F03 		and	r3, r3, #31
 1926 0c98 87F8E730 		strb	r3, [r7, #231]
 850:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     packetfunctions_tossHeader(msg,hlen);
 1927              		.loc 1 850 0
 1928 0c9c 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 1929 0ca0 1946     		mov	r1, r3
 1930 0ca2 F868     		ldr	r0, [r7, #12]
 1931 0ca4 FFF7FEFF 		bl	packetfunctions_tossHeader
 851:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     if (next_size>0){
 1932              		.loc 1 851 0
 1933 0ca8 97F8E730 		ldrb	r3, [r7, #231]	@ zero_extendqisi2
 1934 0cac 002B     		cmp	r3, #0
 1935 0cae 16D0     		beq	.L103
 852:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         next_size -= 1;
 1936              		.loc 1 852 0
 1937 0cb0 97F8E730 		ldrb	r3, [r7, #231]
 1938 0cb4 013B     		subs	r3, r3, #1
 1939 0cb6 87F8E730 		strb	r3, [r7, #231]
 853:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         packetfunctions_reserveHeaderSize(msg,2);
 1940              		.loc 1 853 0
 1941 0cba 0221     		movs	r1, #2
 1942 0cbc F868     		ldr	r0, [r7, #12]
 1943 0cbe FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 854:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         msg->payload[0] = CRITICAL_6LORH | next_size;
 1944              		.loc 1 854 0
 1945 0cc2 FB68     		ldr	r3, [r7, #12]
 1946 0cc4 5B68     		ldr	r3, [r3, #4]
 1947 0cc6 97F8E720 		ldrb	r2, [r7, #231]
 1948 0cca 62F07F02 		orn	r2, r2, #127
 1949 0cce D2B2     		uxtb	r2, r2
 1950 0cd0 1A70     		strb	r2, [r3]
 855:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         msg->payload[1] = next_type;
 1951              		.loc 1 855 0
 1952 0cd2 FB68     		ldr	r3, [r7, #12]
 1953 0cd4 5B68     		ldr	r3, [r3, #4]
 1954 0cd6 0133     		adds	r3, r3, #1
 1955 0cd8 97F8E820 		ldrb	r2, [r7, #232]
 1956 0cdc 1A70     		strb	r2, [r3]
 1957              	.L103:
 856:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     }
 857:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     // add first address
 858:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     switch(type){
 1958              		.loc 1 858 0
 1959 0cde 97F8EE30 		ldrb	r3, [r7, #238]	@ zero_extendqisi2
 1960 0ce2 042B     		cmp	r3, #4
 1961 0ce4 4ED8     		bhi	.L104
 1962 0ce6 01A2     		adr	r2, .L106
 1963 0ce8 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 1964              		.p2align 2
 1965              	.L106:
 1966 0cec 010D0000 		.word	.L105+1
 1967 0cf0 150D0000 		.word	.L107+1
 1968 0cf4 310D0000 		.word	.L108+1
 1969 0cf8 4D0D0000 		.word	.L109+1
 1970 0cfc 690D0000 		.word	.L110+1
 1971              		.p2align 1
 1972              	.L105:
 859:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_0:
 860:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         packetfunctions_reserveHeaderSize(msg,1);
 1973              		.loc 1 860 0
 1974 0d00 0121     		movs	r1, #1
 1975 0d02 F868     		ldr	r0, [r7, #12]
 1976 0d04 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 861:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         msg->payload[0] = firstAddr.addr_128b[15];
 1977              		.loc 1 861 0
 1978 0d08 FB68     		ldr	r3, [r7, #12]
 1979 0d0a 5B68     		ldr	r3, [r3, #4]
 1980 0d0c 97F8E020 		ldrb	r2, [r7, #224]	@ zero_extendqisi2
 1981 0d10 1A70     		strb	r2, [r3]
 862:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1982              		.loc 1 862 0
 1983 0d12 37E0     		b	.L104
 1984              	.L107:
 863:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_1:
 864:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         packetfunctions_reserveHeaderSize(msg,2);
 1985              		.loc 1 864 0
 1986 0d14 0221     		movs	r1, #2
 1987 0d16 F868     		ldr	r0, [r7, #12]
 1988 0d18 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 865:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&msg->payload[0],&firstAddr.addr_128b[14],2);
 1989              		.loc 1 865 0
 1990 0d1c FB68     		ldr	r3, [r7, #12]
 1991 0d1e 5868     		ldr	r0, [r3, #4]
 1992 0d20 07F1D003 		add	r3, r7, #208
 1993 0d24 0F33     		adds	r3, r3, #15
 1994 0d26 0222     		movs	r2, #2
 1995 0d28 1946     		mov	r1, r3
 1996 0d2a FFF7FEFF 		bl	memcpy
 866:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 1997              		.loc 1 866 0
 1998 0d2e 29E0     		b	.L104
 1999              	.L108:
 867:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_2:
 868:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         packetfunctions_reserveHeaderSize(msg,4);
 2000              		.loc 1 868 0
 2001 0d30 0421     		movs	r1, #4
 2002 0d32 F868     		ldr	r0, [r7, #12]
 2003 0d34 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 869:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&msg->payload[0],&firstAddr.addr_128b[12],4);
 2004              		.loc 1 869 0
 2005 0d38 FB68     		ldr	r3, [r7, #12]
 2006 0d3a 5868     		ldr	r0, [r3, #4]
 2007 0d3c 07F1D003 		add	r3, r7, #208
 2008 0d40 0D33     		adds	r3, r3, #13
 2009 0d42 0422     		movs	r2, #4
 2010 0d44 1946     		mov	r1, r3
 2011 0d46 FFF7FEFF 		bl	memcpy
 870:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 2012              		.loc 1 870 0
 2013 0d4a 1BE0     		b	.L104
 2014              	.L109:
 871:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_3:
 872:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         packetfunctions_reserveHeaderSize(msg,8);
 2015              		.loc 1 872 0
 2016 0d4c 0821     		movs	r1, #8
 2017 0d4e F868     		ldr	r0, [r7, #12]
 2018 0d50 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 873:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&msg->payload[0],&firstAddr.addr_128b[8],8);
 2019              		.loc 1 873 0
 2020 0d54 FB68     		ldr	r3, [r7, #12]
 2021 0d56 5868     		ldr	r0, [r3, #4]
 2022 0d58 07F1D003 		add	r3, r7, #208
 2023 0d5c 0933     		adds	r3, r3, #9
 2024 0d5e 0822     		movs	r2, #8
 2025 0d60 1946     		mov	r1, r3
 2026 0d62 FFF7FEFF 		bl	memcpy
 874:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 2027              		.loc 1 874 0
 2028 0d66 0DE0     		b	.L104
 2029              	.L110:
 875:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     case RH3_6LOTH_TYPE_4:
 876:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         packetfunctions_reserveHeaderSize(msg,16);
 2030              		.loc 1 876 0
 2031 0d68 1021     		movs	r1, #16
 2032 0d6a F868     		ldr	r0, [r7, #12]
 2033 0d6c FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 877:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         memcpy(&msg->payload[0],&firstAddr.addr_128b[0],16);
 2034              		.loc 1 877 0
 2035 0d70 FB68     		ldr	r3, [r7, #12]
 2036 0d72 5868     		ldr	r0, [r3, #4]
 2037 0d74 07F1D003 		add	r3, r7, #208
 2038 0d78 0133     		adds	r3, r3, #1
 2039 0d7a 1022     		movs	r2, #16
 2040 0d7c 1946     		mov	r1, r3
 2041 0d7e FFF7FEFF 		bl	memcpy
 878:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         break;
 2042              		.loc 1 878 0
 2043 0d82 00BF     		nop
 2044              	.L104:
 879:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     }
 880:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     packetfunctions_reserveHeaderSize(msg,2);
 2045              		.loc 1 880 0
 2046 0d84 0221     		movs	r1, #2
 2047 0d86 F868     		ldr	r0, [r7, #12]
 2048 0d88 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 881:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     msg->payload[0] = CRITICAL_6LORH | 0;
 2049              		.loc 1 881 0
 2050 0d8c FB68     		ldr	r3, [r7, #12]
 2051 0d8e 5B68     		ldr	r3, [r3, #4]
 2052 0d90 8022     		movs	r2, #128
 2053 0d92 1A70     		strb	r2, [r3]
 882:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     msg->payload[1] = type;
 2054              		.loc 1 882 0
 2055 0d94 FB68     		ldr	r3, [r7, #12]
 2056 0d96 5B68     		ldr	r3, [r3, #4]
 2057 0d98 0133     		adds	r3, r3, #1
 2058 0d9a 97F8EE20 		ldrb	r2, [r7, #238]
 2059 0d9e 1A70     		strb	r2, [r3]
 883:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     packetfunctions_ip128bToMac64b(
 2060              		.loc 1 883 0
 2061 0da0 FB68     		ldr	r3, [r7, #12]
 2062 0da2 03F13C02 		add	r2, r3, #60
 2063 0da6 07F1A801 		add	r1, r7, #168
 2064 0daa 07F1D003 		add	r3, r7, #208
 2065 0dae 1846     		mov	r0, r3
 2066 0db0 FFF7FEFF 		bl	packetfunctions_ip128bToMac64b
 803:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     packetfunctions_tossHeader(msg,hlen);
 2067              		.loc 1 803 0
 2068 0db4 11E0     		b	.L86
 2069              	.L87:
 884:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         &firstAddr,
 885:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         &temp_prefix,
 886:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                         &msg->l2_nextORpreviousHop
 887:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     );
 888:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 }
 889:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             } else {
 890:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 // there is no next RH3-6loRH, remove current one
 891:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 packetfunctions_tossHeader(msg,hlen);
 2070              		.loc 1 891 0
 2071 0db6 97F8ED30 		ldrb	r3, [r7, #237]	@ zero_extendqisi2
 2072 0dba 1946     		mov	r1, r3
 2073 0dbc F868     		ldr	r0, [r7, #12]
 2074 0dbe FFF7FEFF 		bl	packetfunctions_tossHeader
 892:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 packetfunctions_ip128bToMac64b(
 2075              		.loc 1 892 0
 2076 0dc2 FB68     		ldr	r3, [r7, #12]
 2077 0dc4 03F11900 		add	r0, r3, #25
 2078 0dc8 FB68     		ldr	r3, [r7, #12]
 2079 0dca 03F13C02 		add	r2, r3, #60
 2080 0dce 07F1A803 		add	r3, r7, #168
 2081 0dd2 1946     		mov	r1, r3
 2082 0dd4 FFF7FEFF 		bl	packetfunctions_ip128bToMac64b
 763:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // there are at least 2 entries in the header, 
 2083              		.loc 1 763 0
 2084 0dd8 08E0     		b	.L111
 2085              	.L86:
 763:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // there are at least 2 entries in the header, 
 2086              		.loc 1 763 0 is_stmt 0 discriminator 1
 2087 0dda 07E0     		b	.L111
 2088              	.L77:
 893:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     &msg->l3_destinationAdd,
 894:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     &temp_prefix,
 895:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                     &msg->l2_nextORpreviousHop
 896:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 );
 897:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             }
 898:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         }
 899:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     } else {
 900:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         // log error
 901:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         openserial_printError(
 902:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             COMPONENT_IPHC,
 903:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             ERR_6LOWPAN_UNSUPPORTED,
 904:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             (errorparameter_t)16,
 905:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             (errorparameter_t)(temp_addr64.addr_64b[7])
 2089              		.loc 1 905 0 is_stmt 1
 2090 0ddc 97F89C30 		ldrb	r3, [r7, #156]	@ zero_extendqisi2
 901:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             COMPONENT_IPHC,
 2091              		.loc 1 901 0
 2092 0de0 9BB2     		uxth	r3, r3
 2093 0de2 1022     		movs	r2, #16
 2094 0de4 0C21     		movs	r1, #12
 2095 0de6 1220     		movs	r0, #18
 2096 0de8 FFF7FEFF 		bl	openserial_printError
 2097              	.L111:
 906:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         );
 907:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
 908:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // copy RH3s before toss them
 909:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if (
 910:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         ipv6_outer_header->src.type != ADDR_NONE &&
 2098              		.loc 1 910 0
 2099 0dec BB68     		ldr	r3, [r7, #8]
 2100 0dee 93F82230 		ldrb	r3, [r3, #34]	@ zero_extendqisi2
 909:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         ipv6_outer_header->src.type != ADDR_NONE &&
 2101              		.loc 1 909 0
 2102 0df2 002B     		cmp	r3, #0
 2103 0df4 00F08380 		beq	.L112
 911:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         ipv6_outer_header->hopByhop_option != NULL
 2104              		.loc 1 911 0
 2105 0df8 BB68     		ldr	r3, [r7, #8]
 2106 0dfa 9B69     		ldr	r3, [r3, #24]
 910:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         ipv6_outer_header->hopByhop_option != NULL
 2107              		.loc 1 910 0
 2108 0dfc 002B     		cmp	r3, #0
 2109 0dfe 7ED0     		beq	.L112
 912:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     ){
 913:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         // check the length of RH3s
 914:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         RH3_length += ipv6_outer_header->hopByhop_option-msg->payload;
 2110              		.loc 1 914 0
 2111 0e00 BB68     		ldr	r3, [r7, #8]
 2112 0e02 9B69     		ldr	r3, [r3, #24]
 2113 0e04 1A46     		mov	r2, r3
 2114 0e06 FB68     		ldr	r3, [r7, #12]
 2115 0e08 5B68     		ldr	r3, [r3, #4]
 2116 0e0a D31A     		subs	r3, r2, r3
 2117 0e0c DAB2     		uxtb	r2, r3
 2118 0e0e 97F8EA30 		ldrb	r3, [r7, #234]
 2119 0e12 1344     		add	r3, r3, r2
 2120 0e14 87F8EA30 		strb	r3, [r7, #234]
 915:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         memcpy(&RH_copy[RH_length],msg->payload,RH3_length);
 2121              		.loc 1 915 0
 2122 0e18 97F8EC30 		ldrb	r3, [r7, #236]	@ zero_extendqisi2
 2123 0e1c 07F11402 		add	r2, r7, #20
 2124 0e20 D018     		adds	r0, r2, r3
 2125 0e22 FB68     		ldr	r3, [r7, #12]
 2126 0e24 5B68     		ldr	r3, [r3, #4]
 2127 0e26 97F8EA20 		ldrb	r2, [r7, #234]	@ zero_extendqisi2
 2128 0e2a 1946     		mov	r1, r3
 2129 0e2c FFF7FEFF 		bl	memcpy
 916:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         packetfunctions_tossHeader(msg,RH3_length);
 2130              		.loc 1 916 0
 2131 0e30 97F8EA30 		ldrb	r3, [r7, #234]	@ zero_extendqisi2
 2132 0e34 1946     		mov	r1, r3
 2133 0e36 F868     		ldr	r0, [r7, #12]
 2134 0e38 FFF7FEFF 		bl	packetfunctions_tossHeader
 917:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         RH_length += RH3_length;
 2135              		.loc 1 917 0
 2136 0e3c 97F8EC20 		ldrb	r2, [r7, #236]
 2137 0e40 97F8EA30 		ldrb	r3, [r7, #234]
 2138 0e44 1344     		add	r3, r3, r2
 2139 0e46 87F8EC30 		strb	r3, [r7, #236]
 918:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         
 919:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         // retrieve hop-by-hop header (includes RPL option)
 920:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         rpi_length = iphc_retrieveIPv6HopByHopHeader(
 2140              		.loc 1 920 0
 2141 0e4a D7F80011 		ldr	r1, [r7, #256]
 2142 0e4e F868     		ldr	r0, [r7, #12]
 2143 0e50 FFF7FEFF 		bl	iphc_retrieveIPv6HopByHopHeader
 2144 0e54 0346     		mov	r3, r0
 2145 0e56 87F8E630 		strb	r3, [r7, #230]
 921:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                           msg,
 922:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                           rpl_option
 923:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                      );
 924:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****      
 925:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         // toss the headers
 926:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         packetfunctions_tossHeader(
 2146              		.loc 1 926 0
 2147 0e5a 97F8E630 		ldrb	r3, [r7, #230]	@ zero_extendqisi2
 2148 0e5e 1946     		mov	r1, r3
 2149 0e60 F868     		ldr	r0, [r7, #12]
 2150 0e62 FFF7FEFF 		bl	packetfunctions_tossHeader
 927:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             msg,
 928:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             rpi_length
 929:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         );
 930:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****       
 931:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         flags = rpl_option->flags;
 2151              		.loc 1 931 0
 2152 0e66 D7F80031 		ldr	r3, [r7, #256]
 2153 0e6a 5B78     		ldrb	r3, [r3, #1]
 2154 0e6c 87F8E530 		strb	r3, [r7, #229]
 932:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         senderRank = rpl_option->senderRank;
 2155              		.loc 1 932 0
 2156 0e70 D7F80031 		ldr	r3, [r7, #256]
 2157 0e74 DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 2158 0e76 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 2159 0e78 1B02     		lsls	r3, r3, #8
 2160 0e7a 1343     		orrs	r3, r3, r2
 2161 0e7c A7F8E230 		strh	r3, [r7, #226]	@ movhi
 933:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         if ((flags & O_FLAG)!=O_FLAG){
 2162              		.loc 1 933 0
 2163 0e80 97F8E530 		ldrb	r3, [r7, #229]	@ zero_extendqisi2
 2164 0e84 03F01003 		and	r3, r3, #16
 2165 0e88 002B     		cmp	r3, #0
 2166 0e8a 08D1     		bne	.L113
 934:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // wrong direction
 935:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // log error
 936:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             openserial_printError(
 2167              		.loc 1 936 0
 2168 0e8c 97F8E530 		ldrb	r3, [r7, #229]	@ zero_extendqisi2
 2169 0e90 9AB2     		uxth	r2, r3
 2170 0e92 B7F8E230 		ldrh	r3, [r7, #226]
 2171 0e96 1321     		movs	r1, #19
 2172 0e98 1320     		movs	r0, #19
 2173 0e9a FFF7FEFF 		bl	openserial_printError
 2174              	.L113:
 937:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 COMPONENT_FORWARDING,
 938:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 ERR_WRONG_DIRECTION,
 939:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 (errorparameter_t)flags,
 940:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 (errorparameter_t)senderRank
 941:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             );
 942:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         }
 943:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         if (senderRank > icmpv6rpl_getMyDAGrank()){
 2175              		.loc 1 943 0
 2176 0e9e FFF7FEFF 		bl	icmpv6rpl_getMyDAGrank
 2177 0ea2 0346     		mov	r3, r0
 2178 0ea4 1A46     		mov	r2, r3
 2179 0ea6 B7F8E230 		ldrh	r3, [r7, #226]
 2180 0eaa 9342     		cmp	r3, r2
 2181 0eac 11D9     		bls	.L114
 944:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // loop detected
 945:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // set flag
 946:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             rpl_option->flags |= R_FLAG;
 2182              		.loc 1 946 0
 2183 0eae D7F80031 		ldr	r3, [r7, #256]
 2184 0eb2 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 2185 0eb4 43F00803 		orr	r3, r3, #8
 2186 0eb8 DAB2     		uxtb	r2, r3
 2187 0eba D7F80031 		ldr	r3, [r7, #256]
 2188 0ebe 5A70     		strb	r2, [r3, #1]
 947:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             // log error
 948:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             openserial_printError(
 949:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 COMPONENT_FORWARDING,
 950:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 ERR_LOOP_DETECTED,
 951:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 (errorparameter_t) senderRank,
 952:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 (errorparameter_t) icmpv6rpl_getMyDAGrank()
 2189              		.loc 1 952 0
 2190 0ec0 FFF7FEFF 		bl	icmpv6rpl_getMyDAGrank
 2191 0ec4 0346     		mov	r3, r0
 948:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****                 COMPONENT_FORWARDING,
 2192              		.loc 1 948 0
 2193 0ec6 B7F8E220 		ldrh	r2, [r7, #226]
 2194 0eca 1221     		movs	r1, #18
 2195 0ecc 1320     		movs	r0, #19
 2196 0ece FFF7FEFF 		bl	openserial_printError
 2197              	.L114:
 953:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             );
 954:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         }
 955:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         forwarding_createRplOption(rpl_option, rpl_option->flags);
 2198              		.loc 1 955 0
 2199 0ed2 D7F80031 		ldr	r3, [r7, #256]
 2200 0ed6 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 2201 0ed8 1946     		mov	r1, r3
 2202 0eda D7F80001 		ldr	r0, [r7, #256]
 2203 0ede FFF7FEFF 		bl	forwarding_createRplOption
 956:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         
 957:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 958:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         if (deadline_option != NULL)
 2204              		.loc 1 958 0
 2205 0ee2 3B68     		ldr	r3, [r7]
 2206 0ee4 002B     		cmp	r3, #0
 2207 0ee6 02D0     		beq	.L115
 959:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****             forwarding_createDeadlineOption(deadline_option);
 2208              		.loc 1 959 0
 2209 0ee8 3868     		ldr	r0, [r7]
 2210 0eea FFF7FEFF 		bl	forwarding_createDeadlineOption
 2211              	.L115:
 960:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif
 961:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         
 962:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         // toss the IP in IP 6LoRH
 963:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         packetfunctions_tossHeader(msg, ipv6_outer_header->header_length);
 2212              		.loc 1 963 0
 2213 0eee BB68     		ldr	r3, [r7, #8]
 2214 0ef0 93F84430 		ldrb	r3, [r3, #68]	@ zero_extendqisi2
 2215 0ef4 1946     		mov	r1, r3
 2216 0ef6 F868     		ldr	r0, [r7, #12]
 2217 0ef8 FFF7FEFF 		bl	packetfunctions_tossHeader
 2218 0efc 02E0     		b	.L116
 2219              	.L112:
 964:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     } else {
 965:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         RH3_length = 0;
 2220              		.loc 1 965 0
 2221 0efe 0023     		movs	r3, #0
 2222 0f00 87F8EA30 		strb	r3, [r7, #234]
 2223              	.L116:
 966:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
 967:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
 968:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     // send to next lower layer
 969:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     return iphc_sendFromForwarding(
 2224              		.loc 1 969 0
 2225 0f04 BB68     		ldr	r3, [r7, #8]
 2226 0f06 0433     		adds	r3, r3, #4
 2227 0f08 0122     		movs	r2, #1
 2228 0f0a 0492     		str	r2, [sp, #16]
 2229 0f0c 97F8EC20 		ldrb	r2, [r7, #236]	@ zero_extendqisi2
 2230 0f10 0392     		str	r2, [sp, #12]
 2231 0f12 07F11402 		add	r2, r7, #20
 2232 0f16 0292     		str	r2, [sp, #8]
 2233 0f18 0193     		str	r3, [sp, #4]
 2234 0f1a 3B68     		ldr	r3, [r7]
 2235 0f1c 0093     		str	r3, [sp]
 2236 0f1e D7F80031 		ldr	r3, [r7, #256]
 2237 0f22 7A68     		ldr	r2, [r7, #4]
 2238 0f24 B968     		ldr	r1, [r7, #8]
 2239 0f26 F868     		ldr	r0, [r7, #12]
 2240 0f28 FFF7FEFF 		bl	iphc_sendFromForwarding
 2241 0f2c 0346     		mov	r3, r0
 970:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         msg,
 971:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         ipv6_outer_header,
 972:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         ipv6_inner_header,
 973:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         rpl_option,
 974:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
 975:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         deadline_option,
 976:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #endif        
 977:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         &ipv6_outer_header->flow_label,
 978:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         &RH_copy[0],
 979:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         RH_length,
 980:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         PCKTFORWARD
 981:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     );
 982:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** }
 2242              		.loc 1 982 0
 2243 0f2e 1846     		mov	r0, r3
 2244 0f30 F037     		adds	r7, r7, #240
 2245              		.cfi_def_cfa_offset 16
 2246 0f32 BD46     		mov	sp, r7
 2247              		.cfi_def_cfa_register 13
 2248              		@ sp needed
 2249 0f34 B0BD     		pop	{r4, r5, r7, pc}
 2250              		.cfi_endproc
 2251              	.LFE7:
 2253 0f36 00BF     		.align	2
 2254              		.global	forwarding_createRplOption
 2255              		.thumb
 2256              		.thumb_func
 2258              	forwarding_createRplOption:
 2259              	.LFB8:
 983:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 984:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 985:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** /**
 986:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \brief Create a RPL option.
 987:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
 988:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[out] rpl_option A pointer to the structure to fill in.
 989:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[in]  flags      The flags to indicate in the RPL option.
 990:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** */
 991:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** void forwarding_createRplOption(rpl_option_ht* rpl_option, uint8_t flags) {
 2260              		.loc 1 991 0
 2261              		.cfi_startproc
 2262              		@ args = 0, pretend = 0, frame = 16
 2263              		@ frame_needed = 1, uses_anonymous_args = 0
 2264 0f38 80B5     		push	{r7, lr}
 2265              		.cfi_def_cfa_offset 8
 2266              		.cfi_offset 7, -8
 2267              		.cfi_offset 14, -4
 2268 0f3a 84B0     		sub	sp, sp, #16
 2269              		.cfi_def_cfa_offset 24
 2270 0f3c 00AF     		add	r7, sp, #0
 2271              		.cfi_def_cfa_register 7
 2272 0f3e 7860     		str	r0, [r7, #4]
 2273 0f40 0B46     		mov	r3, r1
 2274 0f42 FB70     		strb	r3, [r7, #3]
 992:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     uint8_t I,K;
 993:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     rpl_option->optionType         = RPL_HOPBYHOP_HEADER_OPTION_TYPE;
 2275              		.loc 1 993 0
 2276 0f44 7B68     		ldr	r3, [r7, #4]
 2277 0f46 6322     		movs	r2, #99
 2278 0f48 1A70     		strb	r2, [r3]
 994:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     rpl_option->rplInstanceID      = icmpv6rpl_getRPLIntanceID();
 2279              		.loc 1 994 0
 2280 0f4a FFF7FEFF 		bl	icmpv6rpl_getRPLIntanceID
 2281 0f4e 0346     		mov	r3, r0
 2282 0f50 1A46     		mov	r2, r3
 2283 0f52 7B68     		ldr	r3, [r7, #4]
 2284 0f54 9A70     		strb	r2, [r3, #2]
 995:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     rpl_option->senderRank         = icmpv6rpl_getMyDAGrank();
 2285              		.loc 1 995 0
 2286 0f56 FFF7FEFF 		bl	icmpv6rpl_getMyDAGrank
 2287 0f5a 0346     		mov	r3, r0
 2288 0f5c 1A46     		mov	r2, r3
 2289 0f5e 7B68     		ldr	r3, [r7, #4]
 2290 0f60 A3F80320 		strh	r2, [r3, #3]	@ unaligned
 996:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****    
 997:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if (rpl_option->rplInstanceID == 0){
 2291              		.loc 1 997 0
 2292 0f64 7B68     		ldr	r3, [r7, #4]
 2293 0f66 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 2294 0f68 002B     		cmp	r3, #0
 2295 0f6a 02D1     		bne	.L119
 998:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****        I = 1;
 2296              		.loc 1 998 0
 2297 0f6c 0123     		movs	r3, #1
 2298 0f6e FB73     		strb	r3, [r7, #15]
 2299 0f70 01E0     		b	.L120
 2300              	.L119:
 999:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     } else {
1000:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****        I = 0;
 2301              		.loc 1 1000 0
 2302 0f72 0023     		movs	r3, #0
 2303 0f74 FB73     		strb	r3, [r7, #15]
 2304              	.L120:
1001:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
1002:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
1003:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     if ((rpl_option->senderRank & 0x00FF) == 0){
 2305              		.loc 1 1003 0
 2306 0f76 7B68     		ldr	r3, [r7, #4]
 2307 0f78 B3F80330 		ldrh	r3, [r3, #3]	@ unaligned
 2308 0f7c 9BB2     		uxth	r3, r3
 2309 0f7e DBB2     		uxtb	r3, r3
 2310 0f80 002B     		cmp	r3, #0
 2311 0f82 02D1     		bne	.L121
1004:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         K = 1;
 2312              		.loc 1 1004 0
 2313 0f84 0123     		movs	r3, #1
 2314 0f86 BB73     		strb	r3, [r7, #14]
 2315 0f88 01E0     		b	.L122
 2316              	.L121:
1005:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     } else {
1006:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****         K = 0;
 2317              		.loc 1 1006 0
 2318 0f8a 0023     		movs	r3, #0
 2319 0f8c BB73     		strb	r3, [r7, #14]
 2320              	.L122:
1007:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     }
1008:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     
1009:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     rpl_option->flags = (flags & ~I_FLAG & ~K_FLAG) | (I<<1) | K;
 2321              		.loc 1 1009 0
 2322 0f8e 97F90330 		ldrsb	r3, [r7, #3]
 2323 0f92 23F00303 		bic	r3, r3, #3
 2324 0f96 5AB2     		sxtb	r2, r3
 2325 0f98 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 2326 0f9a 5B00     		lsls	r3, r3, #1
 2327 0f9c 5BB2     		sxtb	r3, r3
 2328 0f9e 1343     		orrs	r3, r3, r2
 2329 0fa0 5AB2     		sxtb	r2, r3
 2330 0fa2 97F90E30 		ldrsb	r3, [r7, #14]
 2331 0fa6 1343     		orrs	r3, r3, r2
 2332 0fa8 5BB2     		sxtb	r3, r3
 2333 0faa DAB2     		uxtb	r2, r3
 2334 0fac 7B68     		ldr	r3, [r7, #4]
 2335 0fae 5A70     		strb	r2, [r3, #1]
1010:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** }
 2336              		.loc 1 1010 0
 2337 0fb0 00BF     		nop
 2338 0fb2 1037     		adds	r7, r7, #16
 2339              		.cfi_def_cfa_offset 8
 2340 0fb4 BD46     		mov	sp, r7
 2341              		.cfi_def_cfa_register 13
 2342              		@ sp needed
 2343 0fb6 80BD     		pop	{r7, pc}
 2344              		.cfi_endproc
 2345              	.LFE8:
 2347              		.align	2
 2348              		.global	forwarding_createDeadlineOption
 2349              		.thumb
 2350              		.thumb_func
 2352              	forwarding_createDeadlineOption:
 2353              	.LFB9:
1011:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
1012:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** #ifdef DEADLINE_OPTION_ENABLED
1013:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** /**
1014:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \brief Create a Deadline-6LoRH .
1015:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
1016:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** \param[out] delay_option A pointer to the structure to fill in.
1017:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** 
1018:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** */
1019:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** void forwarding_createDeadlineOption(deadline_option_ht* deadline_option) {
 2354              		.loc 1 1019 0
 2355              		.cfi_startproc
 2356              		@ args = 0, pretend = 0, frame = 8
 2357              		@ frame_needed = 1, uses_anonymous_args = 0
 2358              		@ link register save eliminated.
 2359 0fb8 80B4     		push	{r7}
 2360              		.cfi_def_cfa_offset 4
 2361              		.cfi_offset 7, -4
 2362 0fba 83B0     		sub	sp, sp, #12
 2363              		.cfi_def_cfa_offset 16
 2364 0fbc 00AF     		add	r7, sp, #0
 2365              		.cfi_def_cfa_register 7
 2366 0fbe 7860     		str	r0, [r7, #4]
1020:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c ****     deadline_option->optionType = DEADLINE_HOPBYHOP_HEADER_OPTION_TYPE;
 2367              		.loc 1 1020 0
 2368 0fc0 7B68     		ldr	r3, [r7, #4]
 2369 0fc2 AB22     		movs	r2, #171
 2370 0fc4 1A70     		strb	r2, [r3]
1021:build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.c **** }
 2371              		.loc 1 1021 0
 2372 0fc6 00BF     		nop
 2373 0fc8 0C37     		adds	r7, r7, #12
 2374              		.cfi_def_cfa_offset 4
 2375 0fca BD46     		mov	sp, r7
 2376              		.cfi_def_cfa_register 13
 2377              		@ sp needed
 2378 0fcc 80BC     		pop	{r7}
 2379              		.cfi_restore 7
 2380              		.cfi_def_cfa_offset 0
 2381 0fce 7047     		bx	lr
 2382              		.cfi_endproc
 2383              	.LFE9:
 2385              	.Letext0:
 2386              		.file 2 "/usr/include/newlib/machine/_default_types.h"
 2387              		.file 3 "/usr/include/newlib/sys/_stdint.h"
 2388              		.file 4 "inc/opendefs.h"
 2389              		.file 5 "openstack/03a-IPHC/iphc.h"
 2390              		.file 6 "build/openmote-cc2538_armgcc/openstack/03b-IPv6/forwarding.h"
 2391              		.file 7 "bsp/boards/openmote-cc2538/board_info.h"
 2392              		.file 8 "openstack/cross-layers/idmanager.h"
 2393              		.file 9 "openstack/03b-IPv6/icmpv6rpl.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 forwarding.c
     /tmp/ccIcq51u.s:20     .rodata:0000000000000000 $d
     /tmp/ccIcq51u.s:23     .rodata:0000000000000000 rreg_uriquery
     /tmp/ccIcq51u.s:28     .rodata:0000000000000008 infoBoardname
     /tmp/ccIcq51u.s:33     .rodata:0000000000000010 infouCName
     /tmp/ccIcq51u.s:38     .rodata:0000000000000018 infoRadioName
     /tmp/ccIcq51u.s:43     .rodata:0000000000000024 infoStackName
     /tmp/ccIcq51u.s:48     .rodata:0000000000000030 linklocalprefix
     /tmp/ccIcq51u.s:60     .rodata:0000000000000038 all_routers_multicast
     /tmp/ccIcq51u.s:78     .text:0000000000000000 $t
     /tmp/ccIcq51u.s:83     .text:0000000000000000 forwarding_init
     /tmp/ccIcq51u.s:133    .text:000000000000000c forwarding_send
     /tmp/ccIcq51u.s:2258   .text:0000000000000f38 forwarding_createRplOption
     /tmp/ccIcq51u.s:2352   .text:0000000000000fb8 forwarding_createDeadlineOption
     /tmp/ccIcq51u.s:1133   .text:000000000000067c forwarding_send_internal_RoutingTable
     /tmp/ccIcq51u.s:578    .text:0000000000000380 $d
     /tmp/ccIcq51u.s:582    .text:0000000000000384 $t
     /tmp/ccIcq51u.s:587    .text:0000000000000384 forwarding_sendDone
     /tmp/ccIcq51u.s:678    .text:00000000000003f4 forwarding_receive
     /tmp/ccIcq51u.s:1308   .text:000000000000078c forwarding_send_internal_SourceRouting
     /tmp/ccIcq51u.s:991    .text:00000000000005f8 forwarding_getNextHopWhisper
     /tmp/ccIcq51u.s:1029   .text:0000000000000618 forwarding_getNextHop
     /tmp/ccIcq51u.s:1299   .text:0000000000000788 $d
     /tmp/ccIcq51u.s:1303   .text:000000000000078c $t
     /tmp/ccIcq51u.s:1474   .text:00000000000008d8 $d
     /tmp/ccIcq51u.s:1479   .text:00000000000008ec $t
     /tmp/ccIcq51u.s:1642   .text:0000000000000a50 $d
     /tmp/ccIcq51u.s:1647   .text:0000000000000a64 $t
     /tmp/ccIcq51u.s:1766   .text:0000000000000b50 $d
     /tmp/ccIcq51u.s:1771   .text:0000000000000b64 $t
     /tmp/ccIcq51u.s:1852   .text:0000000000000bf8 $d
     /tmp/ccIcq51u.s:1856   .text:0000000000000c08 $t
     /tmp/ccIcq51u.s:1966   .text:0000000000000cec $d
     /tmp/ccIcq51u.s:1971   .text:0000000000000d00 $t
                     .debug_frame:0000000000000010 $d
                           .group:0000000000000000 wm4.0.8e445c0106ab795ab4704214cba6f089
                           .group:0000000000000000 wm4._newlib_version.h.4.ad342815780c8db09778091a421b5b5b
                           .group:0000000000000000 wm4.features.h.33.d97f2d646536517df901beeb5b9993f5
                           .group:0000000000000000 wm4._default_types.h.15.933e8edd27a65e0b69af4a865eb623d2
                           .group:0000000000000000 wm4._intsup.h.10.b82bf99f69d6a5c085fc866de0d3eb9b
                           .group:0000000000000000 wm4._stdint.h.10.7a5f60e6741af4a5594a3867d347e1f9
                           .group:0000000000000000 wm4.stdint.h.23.373a9d32a9e4c2e88fd347156532d281
                           .group:0000000000000000 wm4.toolchain_defs.h.2.e5fd326231d01413e5361944b26cde07
                           .group:0000000000000000 wm4.newlib.h.8.36dd0417407b0a085bc04c49cc2ed13a
                           .group:0000000000000000 wm4.config.h.219.65a553ab5bef5482f0d7880b0d33015e
                           .group:0000000000000000 wm4._ansi.h.23.9f8fcfa20193763fcf364fb91705c94b
                           .group:0000000000000000 wm4.stddef.h.39.a38874c8f8a57e66301090908ec2a69f
                           .group:0000000000000000 wm4.lock.h.2.9bc98482741e5e2a9450b12934a684ea
                           .group:0000000000000000 wm4._types.h.125.5cf8a495f1f7ef36777ad868a1e32068
                           .group:0000000000000000 wm4.stddef.h.161.5349cb105733e8777bfb0cf53c4e3f34
                           .group:0000000000000000 wm4._types.h.183.c226d164ceca1f2ecb9ae9360c54a098
                           .group:0000000000000000 wm4.reent.h.17.850ac0a908956e5fb788be1b80de2f32
                           .group:0000000000000000 wm4.cdefs.h.47.ba62642086d429b4f95c2381cae1c0aa
                           .group:0000000000000000 wm4.string.h.15.dab3980bf35408a4c507182805e2de3a
                           .group:0000000000000000 wm4.stddef.h.161.19e15733342b50ead2919490b095303e
                           .group:0000000000000000 wm4.stdbool.h.29.07dce69c3b78884144b7f7bd19483461
                           .group:0000000000000000 wm4.hw_types.h.67.b10589a0806dcc2d274d6fab6b736519
                           .group:0000000000000000 wm4.interrupt.h.41.272fc4ec0e276feb439e7974d0f77eaf
                           .group:0000000000000000 wm4.board_info.h.22.1291259c351bc018e4d4402148b3c6db
                           .group:0000000000000000 wm4.opendefs.h.23.47191652995b7fa35f12da40c3552cda
                           .group:0000000000000000 wm4.iphc.h.2.9e7d9d56ac728a3c0b3014283a59854e
                           .group:0000000000000000 wm4.forwarding.h.15.45cb0af1f91ed153925f6c7828496d3e
                           .group:0000000000000000 wm4.IEEE802154.h.2.38fb510ed33a23a9a0660164e6dfab69
                           .group:0000000000000000 wm4.openserial.h.9.e4d628a9d51214e15d3007d4c3811df6
                           .group:0000000000000000 wm4.idmanager.h.2.8c0e2159b32ef3125cbb1e984805cbfe
                           .group:0000000000000000 wm4.opentimers.h.8.4ddb88466c5d61beaa6758270059ffcf
                           .group:0000000000000000 wm4.icmpv6rpl.h.15.57469026c474290b48bb1d35bcd035a2
                           .group:0000000000000000 wm4.neighbors.h.15.fcaa645de5cf4f9d77d36838589f9838
                           .group:0000000000000000 wm4.scheduler.h.2.d8d85f436d0d4b3991926a15b8490cf4

UNDEFINED SYMBOLS
idmanager_getMyID
packetfunctions_isLinkLocal
packetfunctions_isAllRoutersMulticast
packetfunctions_isAllHostsMulticast
memset
idmanager_getIsDAGroot
whisper_getTargetParentOld
memcpy
packetfunctions_ip128bToMac64b
packetfunctions_sameAddress
packetfunctions_isBroadcastMulticast
iphc_prependIPv6Header
openqueue_freePacketBuffer
openudp_sendDone
icmpv6_sendDone
openserial_printCritical
idmanager_isMyAddress
packetfunctions_tossHeader
openudp_receive
icmpv6_receive
openserial_printError
openqueue_isHighPriorityEntryEnough
icmpv6rpl_getMyDAGrank
neighbors_isStableNeighbor
icmpv6rpl_getPreferredParentEui64
iphc_sendFromForwarding
icmpv6rpl_getRPLDODAGid
packetfunctions_reserveHeaderSize
iphc_retrieveIPv6HopByHopHeader
icmpv6rpl_getRPLIntanceID
